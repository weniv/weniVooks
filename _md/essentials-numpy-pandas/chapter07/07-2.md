---
chapter: 다양한 데이터 분석 라이브러리
title: scikit-learn
date: 2024-09-25
---

# 1. scikit-learn이란?

사이킷런(scikit-learn)은 파이썬용 오픈소스 `머신러닝 라이브러리`입니다. `데이터 분석`을 위한 다양한 도구를 제공하며, `분류`, `회귀`, `클러스터링` 등의 알고리즘을 포함합니다. `모델 선택`, `평가`, `데이터 전처리` 기능도 제공하여, 데이터 분석 작업을 쉽고 효율적으로 수행할 수 있게 해줍니다.

`sklearn.preprocessing` 모듈은 데이터 전처리를 위한 도구들을 제공합니다. 머신러닝 알고리즘은 대부분 숫자 데이터를 다루기 때문에, 범주형 데이터를 숫자로 변환하거나 숫자 데이터의 스케일을 조정하는 작업이 필요합니다. 예를 들어, StandardScaler는 데이터를 평균 0, 표준편차 1로 변환하여 모든 특성의 스케일을 동일하게 만듭니다. OneHotEncoder는 범주형 변수를 이진 벡터로 변환하여 머신러닝 모델이 이해할 수 있는 형태로 바꿔줍니다.

`sklearn.model_selection` 모듈은 모델 선택과 평가를 위한 기능을 제공합니다. 모델의 성능을 정확히 평가하기 위해서는 훈련 데이터와 테스트 데이터를 분리하는 것이 중요합니다. train_test_split 함수를 사용하면 데이터를 쉽게 훈련셋과 테스트셋으로 나눌 수 있습니다. 또한, cross_val_score 함수를 통해 교차 검증을 수행할 수 있어, 모델의 일반화 성능을 더 정확하게 평가할 수 있습니다.

`sklearn.linear_model` 모듈은 선형 모델과 관련된 알고리즘을 제공합니다. 선형 모델은 간단하면서도 강력한 도구로, 많은 실제 문제에 적용할 수 있습니다. LinearRegression 클래스를 사용하면 연속적인 타겟 변수를 예측하는 회귀 모델을 만들 수 있고, LogisticRegression 클래스를 통해 범주형 타겟 변수를 예측하는 분류 모델을 생성할 수 있습니다.

`sklearn.ensemble` 모듈은 여러 개의 모델을 결합하여 더 강력한 모델을 만드는 앙상블 학습 방법을 제공합니다. RandomForestClassifier는 여러 개의 결정 트리를 생성하고 그 결과를 종합하여 예측하는 방식으로, 높은 정확도와 과적합에 대한 저항성을 가집니다. GradientBoostingRegressor는 이전 모델의 오차를 보완하는 방식으로 순차적으로 모델을 생성하여 높은 성능을 달성합니다.

마지막으로, sklearn.metrics 모듈은 모델의 성능을 평가하기 위한 다양한 지표를 제공합니다. 분류 문제에서는 accuracy_score 함수로 정확도를, 회귀 문제에서는 mean_squared_error 함수로 평균 제곱 오차를 계산할 수 있습니다. 이러한 평가 지표들을 통해 모델의 성능을 객관적으로 측정하고 개선할 점을 파악할 수 있습니다.

## 1.1 scikit-learn 실습

```python
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import fetch_openml
from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPClassifier
from sklearn.metrics import accuracy_score

# MNIST 데이터셋 불러오기
print("데이터를 불러오는 중...")
mnist = fetch_openml('mnist_784', version=1, as_frame=False)
# 픽셀 값을 0-1 사이로 정규화하고, 레이블을 정수형으로 변환
X, y = mnist.data / 255.0, mnist.target.astype(int)

# 데이터를 학습용과 테스트용으로 분할 (80% 학습, 20% 테스트)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 모델 학습
print("모델을 학습하는 중...")
# 50개의 뉴런을 가진 은닉층 1개를 가진 신경망 모델 생성
model = MLPClassifier(hidden_layer_sizes=(50,), max_iter=10, random_state=42)
# 모델 학습 실행
model.fit(X_train, y_train)

# 테스트 데이터에 대한 예측 수행
y_pred = model.predict(X_test)
# 모델의 정확도 계산
accuracy = accuracy_score(y_test, y_pred)
print(f"모델 정확도: {accuracy:.2f}")

# 예측 결과 시각화
fig, axes = plt.subplots(2, 5, figsize=(12, 5))
for i, ax in enumerate(axes.flat):
    # 테스트 이미지를 28x28 크기로 재구성하여 표시
    []
    ax.imshow(X_test[i].reshape(28, 28), cmap='gray')
    # 예측값과 실제값을 제목으로 표시
    ax.set_title(f"예측: {y_pred[i]}, 실제: {y_test[i]}")
    ax.axis('off')  # 축 눈금 제거

# 그래프 레이아웃 조정 및 출력
plt.tight_layout()
plt.show()

print("분류 결과가 시각화되었습니다. 예측된 숫자와 실제 숫자를 비교해보세요!")
```

## 1.2 scikit-learn 결과

![colab](/images/basecamp-numpy-pandas/chapter03/미니스트.png '글씨체 분석 결과')

이 이미지는 MNIST 데이터셋을 사용한 숫자 분류 모델의 결과를 보여줍니다. 각 이미지는 손글씨로 쓴 숫자를 나타내며, 이미지 위의 텍스트는 모델의 예측값(Pred)과 실제 정답(True)을 표시합니다. 모든 예측이 정확하게 이루어졌음을 볼 수 있으며, 이는 모델이 다양한 필기체 숫자를 성공적으로 인식할 수 있음을 보여줍니다. 이 시각화는 머신러닝 모델의 성능을 직관적으로 이해하는 데 도움을 줍니다.