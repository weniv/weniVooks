---
chapter: Hook
title: 함수형 컴포넌트 - Hook Flow
date: 2024-08-05
---

# 함수형 컴포넌트 - Hook Flow

함수형 컴포넌트에서의 생명주기에 대해 알아보겠습니다. 함수형 컴포넌트는 클래스 컴포넌트와 달리 생명주기 메서드를 직접적으로 사용하지 않습니다. React 16.8 버전 이전에는 함수형 컴포넌트에서 state와 생명주기 기능을 사용하기 어려웠습니다. 그러나 React 16.8 버전부터 Hook이 도입되어 클래스를 작성하지 않고도 함수형 컴포넌트에서 state와 생명주기와 유사한 기능을 사용할 수 있게 되었습니다.

함수형 컴포넌트의 생명주기를 이해하기 위해서는 Hook의 동작과 실행 순서를 이해하는 것이 중요합니다. 이를 통해 컴포넌트의 렌더링 과정과 부수 효과(side effects)의 관리를 더 효과적으로 할 수 있습니다.

# 1. Hook Flow

아래에서 설명할 함수형 컴포넌트의 흐름도를 React Hook Flow라고 부르겠습니다. 이는 Hook을 기반으로 렌더링되는 과정을 나타냅니다. 단, 이는 공식 명칭이 아니라 이해를 돕기 위한 용어임을 유의해주세요.

![함수형 컴포넌트 흐름 - Hook Flow](/images/basecamp-react/chapter04-6/chapter04-6-1.png)

## 1.1 컴포넌트 생애주기

컴포넌트의 생명주기는 크게 세 단계로 나눌 수 있습니다. 마운트(mount), 업데이트(update), 언마운트(unmount)입니다. 마운트는 컴포넌트가 처음 DOM에 렌더링될 때를 의미합니다. 업데이트는 마운트 완료 이후 state나 props의 변화가 생겼을 때 React가 이를 감지하고 컴포넌트를 재렌더링하는 과정을 의미합니다. 언마운트는 DOM에서 컴포넌트가 제거되는 시점을 의미합니다. 

각 생명주기 단계에 따른 동작은 다음과 같습니다.

### 1.1.1 마운트 (Mount)

1. `Run lazy initializers`
2. `render`
3. `React updates DOM`
4. `Run LayoutEffects`
5. `Browser paints screen`
6. `Run Effects`

### 1.1.2 업데이트(Update)

1. `render`
2. `React updates DOM`
3. `Cleanup LayoutEffects`
4. `Run LayoutEffects`
5. `Browser paints screen`
6. `Cleanup Effects`
7. `Run Effects`

### 1.1.3 언마운트(Unmount)

1. `Cleanup LayoutEffects`
2. `Cleanup Effects`

## 1.3 동작 상세 설명

흐름별 상세 동작을 살펴보겠습니다. 

1. **Run lazy initializers**

최초 마운트 시에 단 1번 실행되는 동작으로, 컴포넌트가 만들어질 때 props와 state 등의 값을 초기화합니다.

2. **Render**

엘리먼트를 생성하고 가상 DOM을 구성합니다. 이 과정에서 컴포넌트 함수가 호출되고, 반환된 JSX가 React 엘리먼트로 변환됩니다. 이는 렌더 단계의 일부로, 순수하고 부수 효과가 없어야 합니다.

3. **React updates DOM**

이 단계는 커밋 단계의 일부입니다. 가상 DOM과 실제 DOM을 비교하여 필요한 부분만 실제 DOM에 업데이트합니다. 이 과정은 효율적인 DOM 조작을 위해 최적화되어 있습니다.

4. **Cleanup LayoutEffects**

업데이트와 언마운트 과정에서 실행됩니다. 업데이트 시에는 새로운 LayoutEffect 실행 전에, 언마운트 시에는 컴포넌트 제거 전에 진행됩니다. 이전 렌더의 LayoutEffect 정리 함수가 이 시점에 실행됩니다.

5. **Run LayoutEffects**

마운트와 업데이트 과정에서 DOM 변경 직후, 그러나 브라우저가 화면을 그리기 전에 동기적으로 실행됩니다. `useLayoutEffect` Hook이 이 시점에 실행됩니다. DOM 측정이 필요한 경우나 DOM 변경이 화면에 반영되기 전에 수행해야 하는 작업에 사용됩니다.

6. **Browser paints screen**

브라우저가 실제 DOM을 화면에 그립니다. 이 단계에서 사용자는 변경된 UI를 볼 수 있게 됩니다.

7. **Cleanup Effects**

업데이트와 언마운트 과정에서 실행됩니다. 새로운 Effect 실행 전이나 컴포넌트 제거 전에 이전 Effect의 정리(cleanup) 함수를 실행합니다. 이를 통해 이전 효과로 인한 부수 효과를 정리할 수 있습니다.

8. **Run Effects**

마운트와 업데이트 과정에서 컴포넌트가 브라우저에 그려진 후에 비동기적으로 실행됩니다. `useEffect` Hook이 이 시점에 실행됩니다.

Hook Flow를 이해하면 함수형 컴포넌트에서 부수 효과를 더 효과적으로 관리하고, 성능 최적화를 할 수 있습니다.

# 2. useEffect와 useLayoutEffect의 차이

앞서 살펴본 Hook Flow를 보면 LayoutEffects와 Effects 동작이 페인트를 기준으로 실행 시점의 차이가 있다는 것을 알 수 있습니다.