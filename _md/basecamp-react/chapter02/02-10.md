---
chapter: React
title: Project (2) - 이미지 검색 애플리케이션 구현
date: 2024-07-19
---

이번 장에서는 오픈 API를 이용하여 이미지 검색 기반의 애플리케이션을 만들어 보는 시간을 갖겠습니다.

우선, 컴포넌트를 `검색바`, `이미지 리스트`, `이미지` 이렇게 세 가지로 분리하여 만들고, Ajax 통신으로 데이터를 주고받는 방식으로 진행하겠습니다.

# 1. Setting

1. 아래 코드를 실행하여 프로젝트를 생성합니다.

```shell
npx create-react-app imgsearch
```

그런 다음, 자동으로 생성된 src 폴더의 속해 있는 파일을 모두 삭제합니다.

2. 새로운 components 폴더를 만들고, App.js, index.js를 포함하여 아래 코드를 복사 및 붙여넣기해서 ListImg.js, ItemImg.js, SearchBar.js 에 해당하는 파일을 생성합니다.

`App.js`

```javascript
function App() {
  return <div>App</div>;
}

export default App;
```

`index.js`

```javascript
import React from 'react';
import ReactDom from 'react-dom/client';
import App from './App';

const el = document.getElementById('root');
const root = ReactDom.createRoot(el);

root.render(<App />);
```

`ListImg.js`

```javascript
function ListImg() {
  return <div>ListImg</div>;
}

export default ListImg;
```

`ItemImg.js`

```javascript
function ItemImg() {
  return <div>ItemImg</div>;
}

export default ItemImg;
```

`SearchBar.js`

```javascript
function SearchBar() {
  return <div>SearchBar</div>;
}

export default SearchBar;
```

# 2. API

::img{width="500" alt="Unsplash Home" src="/images/basecamp-react/chapter02-10/chapter02-10-1.png"}

이번 프로젝트에서의 이미지 활용은 `Unsplash` API(Application Programming Interface)를 통해 진행하도록 하겠습니다. Unsplash는 실제 사진 작가들이 촬영한 수백만개의 사진을 무료로 제공하는 사이트입니다. 아래 링크에 접속하셔서 다음 단계를 따라주세요.

::a[Unsplash Developers]{class='btn-link' href="https://unsplash.com/developers" target="\_blank"}

1. 회원가입

::img{width="600" alt="Unsplash Developers Home" src="/images/basecamp-react/chapter02-10/chapter02-10-2.png"}

::img{width="500" alt="SignUp" src="/images/basecamp-react/chapter02-10/chapter02-10-3.png"}

2. Application 생성
   메뉴 상단의 제일 왼쪽에 있는 `귀하의 앱`을 클릭하세요.

::img{width="500" alt="yourApp" src="/images/basecamp-react/chapter02-10/chapter02-10-4.png"}

그러면 아래와 같은 화면이 나타납니다.

::img{width="500" alt="Applications" src="/images/basecamp-react/chapter02-10/chapter02-10-5.png"}

중앙의 `New Application`을 눌러 새로운 Application을 생성해 주세요.

::img{width="400" alt="API Creating" src="/images/basecamp-react/chapter02-10/chapter02-10-6.png"}

::img{width="400" alt="Applying" src="/images/basecamp-react/chapter02-10/chapter02-10-7.png"}

가이드라인을 잘 살펴보시고 약관 동의를 하시면 애플리케이션이 생성됩니다. 이름과 설명은 추후에도 수정하실 수 있으니, 임의로 작성하셔도 무방합니다.

::img{width="400" alt="API Creating Completion" src="/images/basecamp-react/chapter02-10/chapter02-10-8.png"}

위와 같은 화면이 뜬다면 Application 생성 성공!

3. `Key`

생성된 애플리케이션 페이지의 스크롤을 내리면 여러가지 정보를 확인하실 수 있습니다. 그 중, Unsplash에 요청을 보낼 때 사용하는 나만의 Access Key를 파악해 주세요.

::img{width="500" alt="Key" src="/images/basecamp-react/chapter02-10/chapter02-10-9.png"}

4. `Documentation`

::img{width="500" alt="Documentation Button" src="/images/basecamp-react/chapter02-10/chapter02-10-10.png"}

::img{width="600" alt="Documentation Main" src="/images/basecamp-react/chapter02-10/chapter02-10-11.png"}

상단 메뉴에서 `문서`를 클릭하면 위와 같은 화면이 나오게 됩니다. 기억해야 할 주요 섹션을 설명 드리겠습니다.

::img{width="200" alt="Schema List" src="/images/basecamp-react/chapter02-10/chapter02-10-12.png"}

::img{width="500" alt="Schema_Location" src="/images/basecamp-react/chapter02-10/chapter02-10-13.png"}

`Schema의 Location`에서는 루트 api 주소를 확인할 수 있습니다.

::img{width="300" alt="Authorization List" src="/images/basecamp-react/chapter02-10/chapter02-10-14.png"}

::img{width="600" alt="Authorization_Public Authentication" src="/images/basecamp-react/chapter02-10/chapter02-10-15.png"}

`Authorization의 public authentication`에서는 요청할 헤더에 담아야 할 정보를 확인할 수 있습니다.

::img{width="200" alt="Search List" src="/images/basecamp-react/chapter02-10/chapter02-10-16.png"}

::img{width="300" alt="Search_Search Phothos" src="/images/basecamp-react/chapter02-10/chapter02-10-17.png"}

`Search의 Search phothos`에서는 사진을 요청하는 데 사용할 쿼리를 확인할 수 있습니다.

:::div{.callout}
앞으로의 학습 과정에서 다음과 같은 내용을 다룰 예정이오니, 가볍게 읽어주시길 바랍니다.

1. 대규모 프로젝트에서는 `Redux`와 같은 상태 관리 도구를 사용하여 props 전달의 복잡성을 해결합니다.
2. `라우팅`을 통해, SPA(Single Page Application)에서 페이지 전환을 매끄럽게 처리할 수 있습니다.
3. props로 전달되는 핸들러에는 'on' 접두사를 사용하고, 이벤트 핸들러 함수명에는 'handle' 접수사를 사용하는 `이벤트 핸들링`을 사용하여 React를 보다 효율적이고 체계적으로 개발합니다.

React에서 '컴포넌트'가 자주 언급되는 것은 그 중요성을 반영합니다. 하지만 모든 컴포넌트를 직접 만들 필요는 없습니다. 많은 개발자들이 자신의 컴포넌트 디자인을 공개하고 있어, 이를 활용하면 개발 효율을 높일 수 있습니다. 유용한 컴포넌트 리소스를 아래 링크에서 확인해 보세요.

::a[class101의 컴포넌트 디자인]{class='btn-link' href="https://www.figma.com/community/file/995265899930701059" target="\_blank"}

::a[컴포넌트 백과사전]{class='btn-link' href="https://storybook.js.org/showcase" target="\_blank"}

:::

# 3. 통신

서버와 클라이언트 사이의 통신을 원활하게 하기 위해 `Axios`를 설치하고 적용해 보겠습니다. `npm i axios` 하신 다음, 아래 코드를 복사 및 붙여넣기 하여 파일을 생성해 주세요.

:::div{.callout}
**http 통신 메소드**

1. GET : 서버에 데이터를 요청합니다.
2. POST : 서버에 새로운 데이터를 생성할 것을 요청합니다.
3. PUT : 기존의 데이터를 전부 업데이트 합니다.
4. PATCH : 기존의 데이터를 부분적으로 업데이트 합니다.
5. DEL : 데이터를 삭제합니다.

:::

6. 파일 생성

`imgApi.js`

```javascript
import axios from 'axios';

const searchImg = async () => {
  const response = await axios.get('https://api.unsplash.com/search/photos', {
    headers: {
      Authorization: 'Client-ID {사용자의 access 키}',
    },
    params: {
      query: 'flowers',
    },
  });
  console.log(response);

  return response;
};

export default searchImg;
```

`App.js`

```javascript
import searchImg from './imgApi';

searchImg();

function App() {
  return <div>App</div>;
}

export default App;
```

App.js에 searchImg를 import 시켜 데이터가 잘 들어오는지 확인합니다.

2. searchImg 함수 수정

`keyword` 매개변수를 추가하고, `response`의 결과물로 이미지의 배열만 담을 수 있도록 합니다. 아래 코드와 같이 수정해 주세요.

`imgApi.js`

```javascript
const searchImg = async (keyword) => {
  const response = await axios.get('https://api.unsplash.com/search/photos', {
    headers: {
      Authorization: 'Client-ID {사용자의 access 키}',
    },
    params: {
      query: keyword,
    },
  });

  return response.data.results;
};
```

# 4. Props 응용

1. 1단계

```javascript
import SearchBar from './components/SearchBar';

function App() {
  const handleKeyword = (keyword) => {
    // api 실행!
    console.log('keyword : ', keyword);
  };

  return (
    <div>
      App
      <SearchBar searching={handleKeyword} />
    </div>
  );
}

export default App;
```

위에서 볼 수 있듯이, App.js는 우리 애플리케이션의 최상위 컴포넌트입니다. 여기서는 SearchBar라는 자식 컴포넌트를 사용하고 있습니다.

먼저, SearchBar 컴포넌트를 import 합니다. 이 SearchBar는 사용자가 검색어를 입력할 수 있는 입력 필드를 제공할 것입니다.

그런 다음, App 컴포넌트 내부에 handleKeyword라는 함수를 정의합니다. 이 함수는 사용자가 입력한 검색어를 처리하는 역할을 합니다. 현재는 단순히 콘솔에 검색어를 출력하고 있지만, 실제로는 이 함수에서 검색 API를 호출하거나 다른 로직을 실행할 수 있습니다.

render 부분에서는 App이라는 텍스트와 함께 SearchBar 컴포넌트를 렌더링합니다. SearchBar에 searching이라는 prop으로 handleKeyword 함수를 전달합니다. 이렇게 하면 SearchBar 컴포넌트에서 사용자가 검색어를 입력했을 때 이 함수를 호출할 수 있게 됩니다.

이러한 구조를 통해 부모 컴포넌트(App)에서 정의한 함수를 자식 컴포넌트(SearchBar)에 전달하여, 자식 컴포넌트에서 발생한 이벤트(검색어 입력)를 부모 컴포넌트에서 처리할 수 있게 됩니다. 이는 React의 단방향 데이터 흐름을 잘 보여줍니다.

2. 2단계

```javascript
function SearchBar({ searching }) {
  const handleSubmit = () => {
    searching();
  };

  return (
    <nav>
      <label htmlFor="keyword">검색어를 입력하세요 : </label>
      <input type="text" id="keyword" />
      <button onClick={handleSubmit}>검색</button>
    </nav>
  );
}

export default SearchBar;
```

SearchBar 컴포넌트는 사용자가 검색어를 입력하고 검색을 실행할 수 있는 인터페이스를 제공합니다. 이 컴포넌트는 부모 컴포넌트로부터 'searching'이라는 props를 전달받습니다. 이는 App.js에서 전달한 handleKeyword 함수입니다.

그런 다음, 컴포넌트 내부에 handleSubmit 함수를 정의합니다. 이 함수는 사용자가 검색 버튼을 클릭했을 때 실행됩니다. 현재는 단순히 전달받은 searching 함수를 호출하고 있습니다.

렌더링 부분을 보면, 검색창을 구성하는 세 가지 요소가 있습니다. 첫번재, 사용자에게 안내를 제공하는 label, 두번째, 사용자가 검색어를 입력할 수 있는 input 필드, 마지막으로, 검색을 실행하는 button이 존재합니다. 이러한
버튼에는 onClick 이벤트 핸들러로 handleSubmit 함수를 연결했습니다. 따라서 사용자가 버튼을 클릭하면 handleSubmit 함수가 실행되고, 이는 다시 부모 컴포넌트에서 전달받은 searching 함수를 호출하게 됩니다.

만약 코드를 더 개선할 수 있다면, input 필드의 값을 가져와서 searching 함수에 전달하는 로직을 추가할 수 있습니다. 또한, 사용자가 Enter 키를 눌렀을 때도 검색이 실행되도록 할 수 있습니다. 이러한 기능들을 추가하면 사용자 경험을 더욱 향상시킬 수 있을 것입니다.

3. 3단계

```javascript
function SearchBar({ searching }) {
  const [keyword, setKeyword] = useState('');

  const handleSubmit = (event) => {
    event.preventDefault();
    searching(keyword);
  };

  return (
    <nav>
      <form onSubmit={handleSubmit}>
        <label htmlFor="keyword">검색어를 입력하세요 : </label>
        <input type="text" id="keyword" value={keyword} onChange={handleInp} />
        <button>검색</button>
      </form>
    </nav>
  );
}

export default SearchBar;
```

SearchBar 컴포넌트를 개선한 내용을 설명드리겠습니다. 먼저, React의 useState 훅을 사용하여 'keyword'라는 상태를 관리합니다. 이를 통해 입력 필드의 값을 동적으로 관리할 수 있게 됩니다.

handleSubmit 함수는 이제 이벤트 객체를 매개변수로 받습니다. 함수 내에서 event.preventDefault()를 호출하여 폼 제출 시 페이지가 새로고침되는 기본 동작을 방지합니다. 그리고 현재 keyword 상태를 searching 함수에 전달합니다.

렌더링 부분에서 몇가지 차이가 두드러지는데, 전체 검색 인터페이스를 form 태그로 감쌌습니다. 이렇게 하면 사용자가 엔터 키를 눌렀을 때도 폼이 제출되어 검색이 실행됩니다. 그리고, form 태그에 onSubmit 이벤트 핸들러로 handleSubmit 함수를 연결했습니다. 또한, input 필드의 value 속성을 keyword 상태와 연결하고, onChange 이벤트 핸들러로 handleInp 함수를 지정했습니다. 이 handleInp 함수는 코드에 나와있지 않지만, 입력 필드의 값이 변경될 때마다 keyword 상태를 업데이트하는 역할을 할 것입니다.

이러한 변경사항들로 인해, 사용자는 이제 검색어를 입력하고 엔터 키를 누르거나 검색 버튼을 클릭하여 검색을 실행할 수 있게 되었습니다. 또한, 입력된 검색어가 상태로 관리되어 부모 컴포넌트의 searching 함수에 정확하게 전달됩니다.

4. 4단계

```javascript
import SearchBar from './components/SearchBar';
import searchImg from './imgApi';

function App() {
  const handleKeyword = (keyword) => {
    // api 실행!
    console.log('keyword : ', keyword);

    const result = searchImg(keyword);
    console.log(result);
  };

  return (
    <div>
      App
      <SearchBar searching={handleKeyword} />
    </div>
  );
}

export default App;
```

이제 SearchBar 컴포넌트를 사용하는 것 외에도, 이미지 검색 기능을 추가해 보겠습니다. 먼저, 'searchImg'라는 함수를 import하여 외부 API를 호출하여 이미지를 검색하는 역할을 하게 합니다.

handleKeyword 함수가 이제 실제로 검색 기능을 수행하는데, 우선, 함수는 'keyword' 파라미터를 받아, 이를 콘솔에 출력합니다. 이는 디버깅 목적으로 유용할 수 있습니다. 그 다음, searchImg 함수를 호출하여 keyword를 전달합니다. 이는 실제 API 호출을 수행하는 부분입니다. searchImg 함수의 결과를 'result' 변수에 저장하고, 이를 다시 콘솔에 출력합니다. 이렇게 함으로써, 사용자가 검색어를 입력하고 검색을 실행하면, 그 검색어를 이용해 실제로 이미지 검색 API를 호출하게 됩니다.

5. 5단계

마지막으로, API 호출이 의도한 대로 작동하는지 확인하는 과정입니다. 브라우저의 개발자 도구에서 네트워크 탭을 열고 검색을 실행하면, API 호출이 실제로 이루어지는 것을 확인할 수 있습니다. 여기서 요청 URL, 요청 메소드, 상태 코드, 응답 데이터 등을 확인할 수 있습니다.

# 5. 데이터 확인

1. 브라우저 상에서 개발자 도구를 킨 다음, 네트워크 탭을 열어서 Fetch/XHR 탭을 선택하세요. Preview 탭에서 아래 사진과 같이 데이터가 들어오고 있는지 확인해 주세요.

::img{width="600" alt="Preview Tab" src="/images/basecamp-react/chapter02-10/chapter02-10-18.png"}

preview 탭에서는 데이터가 잘 들어오고 있지만, console.log(result);를 실행하면 아래와 같은 결과가 발생합니다.

::img{width="500" alt="Promise" src="/images/basecamp-react/chapter02-10/chapter02-10-19.png"}

:::div{.callout}
`pending`은 통신이 아직 시작되지 않은 상태를 의미합니다. 자세한 정보는 아래 링크를 참고해 주세요.

::a[Promise]{class='btn-link' href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Promise#%EC%84%A4%EB%AA%85" target="\_blank"}

:::

이 상태에서 searchImg 함수가 완전히 끝날때까지 기다려준다면 정상적인 값이 출력될 것입니다. 그 역할을 async, await 문법을 통해 수행합니다. 아래 코드를 삽입해 주세요.

```javascript
...
const handleKeyword = async (keyword) => {
    // api 실행!
    console.log('keyword : ', keyword);

    const result = await searchImg(keyword);
    console.log(result);
}
...
```

# 6. State 확인

이제 API를 통해 전달받은 값을 ListImg.js에 적용하고 또다른 이미지를 검색했을 때 새로운 이미지들로 화면을 업데이트하기 위해 `state` 시스템을 이용하려고 합니다. state는 업데이트 시, 해당 값을 이용하는 컴포넌트가 업데이트 할 수 있게 해줍니다.

```javascript
function App() {
  const [images, setImages] = useState([]);

  const handleKeyword = async (keyword) => {
    const result = await searchImg(keyword);

    setImages(result);
  };

  return (
    <div>
      App
      <SearchBar searching={handleKeyword} />
      <ListImg images={images} />
    </div>
  );
}
```

# 7. map 메소드 사용

아래와 같이 ListImg.js 파일을 수정하여 App.js로부터 전달받은 배열을 map 메소드를 사용해 새로운 배열로 변환하겠습니다.

```javascript
import ItemImg from './ItemImg';

function ListImg({ images }) {
  const renderImages = images.map((image) => {
    return <ItemImg image={image} />;
  });

  return <ul>{renderImages}</ul>;
}

export default ListImg;
```
