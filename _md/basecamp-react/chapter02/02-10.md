---
chapter: React
title: 이미지 검색 애플리케이션 구현
date: 2024-08-02
---

# 1. 프로젝트 설정

React와 오픈 API를 사용하여 이미지 검색 애플리케이션을 만들어보겠습니다. 이 프로젝트는 `검색바`, `이미지 리스트`, `개별 이미지 컴포넌트`로 구성됩니다.

## 1.1. 프로젝트 생성

```shell
npx create-react-app imgsearch
cd imgsearch
```

`npx create-react-app imgsearch` 명령어는 React 애플리케이션의 기본 구조를 자동으로 생성해줍니다. 이 명령어를 실행하면 React 개발에 필요한 모든 의존성과 기본 파일들이 설치됩니다. `cd imgsearch`는 생성된 프로젝트 폴더로 이동하는 명령어입니다.

## 1.2. 파일 정리

src 폴더 내 기존 파일을 삭제하신 후, 다음 파일들을 생성해 주세요. src 폴더 내 기존 파일을 삭제하고 새로운 파일들을 생성하는 이유는 불필요한 코드를 제거하고 프로젝트를 깔끔하게 시작하기 위함입니다. 각 컴포넌트 파일(App.js, SearchBar.js 등)은 React 컴포넌트의 기본 구조를 가지고 있으며, 이는 추후 개발 과정에서 채워질 것입니다.

1. App.js
2. index.js
3. components/SearchBar.js
4. components/ListImg.js
5. components/ItemImg.js

각 파일의 기본 구조는 다음과 같습니다.

```javascript
// App.js, SearchBar.js, ListImg.js, ItemImg.js
function ComponentName() {
  return <div>ComponentName</div>;
}

export default ComponentName;

// index.js
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
```

# 2. Unsplash API 설정

Unsplash는 고품질 무료 이미지를 제공하는 플랫폼입니다. API를 사용하기 위해 개발자 계정을 만들고 애플리케이션을 등록하는 과정이 필요합니다. 이 과정을 통해 얻은 API 키는 Unsplash 서버에 요청을 보낼 때 인증 용도로 사용됩니다.

::img{width="500" alt="Unsplash Home" src="/images/basecamp-react/chapter02-10/chapter02-10-1.png"}

Unsplash API를 사용하여 이미지를 검색합니다. API 키를 얻기 위한 절차는 다음과 같습니다.

:::div{.callout}
아래 링크에 접속하셔서 다음 단계를 따라주세요.

::a[Unsplash Developers]{class='btn-link' href="https://unsplash.com/developers" target="\_blank"}

:::

1. Unsplash Developers 사이트에 회원가입

::img{width="600" alt="Unsplash Developers Home" src="/images/basecamp-react/chapter02-10/chapter02-10-2.png"}

::img{width="500" alt="SignUp" src="/images/basecamp-react/chapter02-10/chapter02-10-3.png"}

2. 새 애플리케이션 생성

::img{width="500" alt="yourApp" src="/images/basecamp-react/chapter02-10/chapter02-10-4.png"}

메뉴 상단의 제일 왼쪽에 있는 `귀하의 앱`을 클릭하세요.

그러면 아래와 같은 화면이 나타납니다.

::img{width="500" alt="Applications" src="/images/basecamp-react/chapter02-10/chapter02-10-5.png"}

중앙의 `New Application`을 눌러 새로운 Application을 생성해 주세요.

::img{width="400" alt="API Creating" src="/images/basecamp-react/chapter02-10/chapter02-10-6.png"}

::img{width="400" alt="Applying" src="/images/basecamp-react/chapter02-10/chapter02-10-7.png"}

가이드라인을 잘 살펴보시고 약관 동의를 하시면 애플리케이션이 생성됩니다. 이름과 설명은 추후에도 수정하실 수 있으니, 임의로 작성하셔도 무방합니다.

::img{width="400" alt="API Creating Completion" src="/images/basecamp-react/chapter02-10/chapter02-10-8.png"}

위와 같은 화면이 뜬다면 Application 생성 성공!

3. 생성된 Access Key 확인

::img{width="500" alt="Key" src="/images/basecamp-react/chapter02-10/chapter02-10-9.png"}

:::div{.callout}
보안을 위해 API 키는 .env 파일에 저장하고, .gitignore에 추가하여 공개 저장소에 업로드되지 않도록 합니다.

```shell
# .env
REACT_APP_UNSPLASH_ACCESS_KEY = your_access_key_here
```

이 파일은 깃허브 등 공개 저장소에 업로드되지 않도록 .gitignore에 추가되어야 합니다. React에서는 'REACT*APP*' 접두사로 시작하는 환경 변수를 자동으로 인식합니다.

:::

# 3. API 통신 설정

axios를 사용하여 API 통신을 구현합니다.

1. axios 설치

```shell
npm install axios
```

2. imgApi.js 파일 생성

imgApi.js 파일에서 axios를 사용해 Unsplash API에 요청을 보내고 결과를 받아옵니다.

```javascript
import axios from 'axios';

const searchImg = async (keyword) => {
  const response = await axios.get('https://api.unsplash.com/search/photos', {
    headers: {
      Authorization: `Client-ID ${process.env.REACT_APP_UNSPLASH_ACCESS_KEY}`,
    },
    params: {
      query: keyword,
    },
  });

  return response.data.results;
};

export default searchImg;
```

imgApi.js 파일은 Unsplash API와 통신하는 역할을 합니다. axios를 사용해 API 요청을 보내고, 검색 결과를 반환합니다.

# 4. 컴포넌트 구현

## 4.1. App 컴포넌트

App 컴포넌트는 전체 애플리케이션의 상태를 관리합니다. useState Hook을 사용해 images와 error 상태를 관리하고, handleSearch 함수를 통해 이미지 검색을 수행합니다.

```javascript
import React, { useState } from 'react';
import SearchBar from './components/SearchBar';
import ListImg from './components/ListImg';
import searchImg from './imgApi';

function App() {
  const [images, setImages] = useState([]);
  const [error, setError] = useState(null);

  const handleSearch = async (keyword) => {
    try {
      setError(null);
      const result = await searchImg(keyword);
      setImages(result);
    } catch (err) {
      console.error('이미지 검색 중 오류 발생:', err);
      setError('이미지를 불러오는 데 실패했습니다. 다시 시도해 주세요.');
      setImages([]);
    }
  };

  return (
    <div>
      <SearchBar onSearch={handleSearch} />
      {error && <p style={{ color: 'red' }}>{error}</p>}
      <ListImg images={images} />
    </div>
  );
}

export default App;
```

## 4.2. SearchBar 컴포넌트

SearchBar.js는 사용자 입력을 받아 검색을 수행하는 컴포넌트입니다. 입력값을 상태로 관리하고, 폼 제출 시 검색 함수를 호출합니다.

```javascript
import React, { useState } from 'react';

function SearchBar({ onSearch }) {
  const [keyword, setKeyword] = useState('');

  const handleSubmit = (event) => {
    event.preventDefault();
    onSearch(keyword);
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        value={keyword}
        onChange={(e) => setKeyword(e.target.value)}
        placeholder="검색어를 입력하세요"
      />
      <button type="submit">검색</button>
    </form>
  );
}

export default SearchBar;
```

## 4.3. ListImg 컴포넌트

ListImg.js는 검색 결과 이미지 목록을 표시합니다. 각 이미지에 대해 ItemImg 컴포넌트를 렌더링합니다.

```javascript
import React from 'react';
import ItemImg from './ItemImg';

function ListImg({ images }) {
  return (
    <div className="image-list">
      {images.map((image) => (
        <ItemImg key={image.id} image={image} />
      ))}
    </div>
  );
}

export default ListImg;
```

## 4.4. ItemImg 컴포넌트

ItemImg.js는 개별 이미지 아이템을 표시하는 컴포넌트입니다. React.memo를 사용해 성능을 최적화합니다.

```javascript
import React from 'react';

const ItemImg = React.memo(({ image }) => {
  return (
    <div className="image-item">
      <img src={image.urls.small} alt={image.alt_description} />
      <p>{image.description || '설명 없음'}</p>
    </div>
  );
});

export default ItemImg;
```

:::div{.callout}
`React.memo란?` ItemImg 컴포넌트에서 사용된 React.memo는 컴포넌트의 props가 변경되지 않았다면 리렌더링을 방지하는 성능 최적화 기법입니다.

:::

# 5. 성능 최적화

1. React.memo를 사용하여 불필요한 리렌더링을 방지합니다.
2. 크롬 개발자 도구의 React DevTools를 사용하여 컴포넌트 렌더링을 모니터링합니다.

# 6. 에러 처리

try-catch 구문을 사용하여 API 호출 중 발생할 수 있는 오류를 처리하고, 사용자에게 적절한 피드백을 제공합니다.

우리가 사용한 App 컴포넌트의 handleSearch 함수에서 try-catch 구문을 사용해 API 호출 중 발생할 수 있는 오류를 처리합니다. 오류 발생 시 사용자에게 오류 메시지를 표시합니다.

# 7. 추가 개선 사항

페이지네이션, 로딩 상태 표시, 반응형 디자인, 테스트 등은 애플리케이션의 사용성과 안정성을 높이기 위한 추가적인 기능들입니다. 이들은 기본 기능 구현 후 단계적으로 추가될 수 있습니다.

1. `페이지네이션`: 대량의 검색 결과를 효율적으로 처리하기 위해 페이지네이션을 구현합니다.
2. `로딩 상태`: API 요청 중 로딩 인디케이터를 표시하여 사용자 경험을 개선합니다.
3. `반응형 디자인`: 다양한 디바이스에서 최적의 레이아웃을 제공합니다.
4. `테스트`: 단위 테스트와 통합 테스트를 작성하여 애플리케이션의 안정성을 높입니다.
