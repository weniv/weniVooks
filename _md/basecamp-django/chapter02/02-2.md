---
chapter: URL 처리와 템플릿 태그
title: Django의 URL과 View 이해하기
date: 2024-07-10
---
# 1. URL 패턴 및 라우팅

Django에서는 주소(URL)를 어떻게 구성하고 처리할지 정하는 것이 매우 중요합니다. 이는 마치 우리 집 주소를 정하는 것과 비슷합니다. 주소를 보고 우리는 어디로 가야할지 알 수 있죠.

## 1.1 URL 설계 원칙

실습에서 우리는 다음과 같은 URL 구조를 설계했습니다.

```
www.hojun.com/admin
www.hojun.com/   
www.hojun.com/blog   
www.hojun.com/blog/1 
www.hojun.com/blog/2 
www.hojun.com/blog/3 
www.hojun.com/accounts/hojun 
www.hojun.com/accounts/junho
```

## 1.2 urls.py 파일의 역할

Django 프로젝트에서 `urls.py` 파일은 URL 패턴과 view 함수를 연결하는 핵심 역할을 합니다. 실습에서 사용한 `urls.py` 파일을 봅시다.

```python
from django.contrib import admin
from django.urls import path
from main.views import index, blog_list, blog_details, accounts_details

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', index),
    path('blog/', blog_list),
    path('blog/<int:pk>/', blog_details),
    path('accounts/<str:username>/', accounts_details),
]
```
중요 요소를 살펴보면 두가지로 나타낼 수 있습니다.

1. urlpatterns: Django는 이 리스트를 순서대로 검사하여 요청된 URL과 매칭되는 패턴을 찾습니다.

2. path() 함수: URL 패턴과 view 함수를 연결합니다. 기본 구조는 `path("원하는 URL/", 함수명)`입니다.
   - route: URL 패턴을 문자열로 지정합니다.
   - view: 매칭된 URL에 대해 호출될 view 함수를 지정합니다.

## 1.3 URL 패턴의 동적 부분

URL의 일부를 동적으로 처리하는 것은 웹 애플리케이션의 유연성을 크게 향상시킵니다.
Django는 이를 위해 URL 컨버터(converter)를 제공합니다.

```python
path('blog/<int:pk>/', blog_details),
path('accounts/<str:username>/', accounts_details),
```

1. `<int:pk>`: 
   이 부분에는 정수만 올 수 있습니다. pk는 이 숫자를 부르는 이름(변수)이에요. 'blog/1/'이라고 입력하면, blog_details(request, pk=1)이라는 함수가 실행됩니다.

2. `<str:username>`: 
   이 부분에는 문자가 올 수 있습니다. 'accounts/hojun/' 링크에 들어가면, `accounts_details(request, username='hojun')`이라는 함수가 실행됩니다.

이러한 동적 URL 패턴을 사용하면 하나의 view 함수로 여러 URL을 처리할 수 있어, 코드의 재사용성과 효율성이 높아집니다.
URL 패턴 및 라우팅 시스템을 잘 이해하고 활용하면, 확장 가능하고 유지보수가 쉬운 웹 애플리케이션을 구축할 수 있습니다.

# 2. View 함수

View 함수는 Django 웹사이트의 '두뇌' 역할을 합니다. 사용자가 무엇인가를 요청하면, 이 함수가 그 요청을 이해하고 적절한 대답을 해줍니다.

## 2.1 View 함수의 기본 구조

Django에서 모든 View 함수는 기본적으로 다음과 같은 구조를 가집니다.

```python
def view_name(request, other_parameters...):
    # 여기서 필요한 일을 처리합니다.
    return response
```

실습에서 우리가 사용한 View 함수들을 자세히 살펴보겠습니다.

```python
def index(request):
    return HttpResponse("index")

def blog_list(request):
    context = {"blog_list": blog_list_db, "hello": [10, 20, 30]}
    return render(request, "main/blog_list.html", context)

def blog_details(request, pk):
    blog = blog_list_db[pk - 1]
    context = {"blog": blog}
    return render(request, "main/blog_details.html", context)
```

1. `request` 매개변수
   - 모든 View 함수는 첫 번째로 request라는 정보를 받습니다.
   - Django가 제공하는 `HttpRequest` 객체로, 사용자가 보낸 모든 정보(예: 입력한 데이터, 쿠키 등)가 들어있습니다.

2. 추가 매개변수
   - 주소에서 받아온 정보를 함수에서 사용할 수 있습니다. 예를 들어서, 
   - `blog_details` 함수의 `pk`는 URL에서 `<int:pk>` 부분에 해당합니다.
   - 만약 주소가 blog/3이라면 <int:pk>에는 3이 들어갑니다.

3. 응답 반환
View 함수는 항상 무언가를 '응답'으로 돌려줘야 합니다. HttpResponse("index")처럼 직접 응답을 보내주거나, render() 함수를 사용해 HTML 페이지를 보낼 수 있습니다.