---
chapter: URL처리와 템플릿 태그
title: 템플릿 태그
date: 2024-07-11
---

Django의 템플릿 시스템은 동적 웹 페이지를 생성하는 강력한 도구입니다. 이 시스템을 사용하면 Python 코드와 HTML을 분리하여 관리할 수 있으며, 재사용 가능한 페이지 구조를 만들 수 있습니다.

## 템플릿의 기본 개념

템플릿은 HTML 파일에 Django 템플릿 언어(DTL)를 사용하여 동적 콘텐츠를 삽입할 수 있게 해줍니다. 기본적인 템플릿 구조는 다음과 같습니다

```html
<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}My Site{% endblock %}</title>
</head>
<body>
    <h1>Welcome to My Site</h1>
    {% block content %}
    {% endblock %}
</body>
</html>
```

이 기본 구조에서 `{% block %}` 태그는 자식 템플릿에서 오버라이드할 수 있는 영역을 정의합니다.

## 템플릿 렌더링 과정

1. **뷰에서 컨텍스트 데이터 준비**
   ```python
   def my_view(request):
       context = {'name': 'John', 'age': 30}
       return render(request, 'my_template.html', context)
   ```

2. **템플릿 파일 작성**
   ```html
   <p>Hello, {{ name }}! You are {{ age }} years old.</p>
   ```

3. **render() 함수 사용**
   `render()` 함수는 요청 객체, 템플릿 이름, 그리고 컨텍스트 데이터를 받아 HTTP 응답을 생성합니다.

## 템플릿 언어의 주요 기능

1. **변수**
   - 중괄호 두 개로 변수를 감싸서 사용합니다. `{{ variable }}`
   - 점 표기법을 사용하여 객체의 속성에 접근할 수 있습니다. `{{ user.username }}`

2. **태그**
   - `{% %}` 구문을 사용하여 로직을 수행합니다.
   - 예: `{% if %}`, `{% for %}`, `{% block %}`

3. **필터**
   - 변수의 값을 변형하는 데 사용됩니다.
   - 파이프(|) 문자를 사용하여 적용합니다.
   - 예: `{{ name|lower }}`, `{{ text|truncatewords:30 }}`

4. **주석**
   - `{# #}` 를 사용하여 주석을 작성합니다.

5. **템플릿 상속**
   - `{% extends 'base.html' %}` 를 사용하여 기본 템플릿을 상속받습니다.

## 템플릿 태그 예시

1. **조건문**
   ```html
   {% if user.is_authenticated %}
       <p>Welcome, {{ user.username }}!</p>
   {% else %}
       <p>Please log in.</p>
   {% endif %}
   ```

2. **반복문**
   ```html
   <ul>
   {% for item in items %}
       <li>{{ item.name }}</li>
   {% empty %}
       <li>No items found.</li>
   {% endfor %}
   </ul>
   ```

3. **템플릿 포함**
   ```html
   {% include 'header.html' %}
   ```

## 템플릿 필터 예시

1. **문자열 조작**
   ```html
   {{ name|lower }}
   {{ name|upper }}
   {{ text|truncatewords:20 }}
   ```

2. **날짜 포맷**
   ```html
   {{ date|date:"Y-m-d" }}
   ```

3. **숫자 포맷**
   ```html
   {{ number|floatformat:2 }}
   ```

## 커스텀 템플릿 태그와 필터

Django는 사용자 정의 템플릿 태그와 필터를 만들 수 있는 기능을 제공합니다.

1. **커스텀 필터 예시**
   ```python
   from django import template

   register = template.Library()

   @register.filter
   def multiply(value, arg):
       return value * arg
   ```

   [사용]
   ```html
   {{ 5|multiply:3 }}
   ```

2. **커스텀 태그 예시**
   ```python
   @register.simple_tag
   def current_time(format_string):
       return datetime.datetime.now().strftime(format_string)
   ```

   [사용]
   ```html
   {% current_time "%Y-%m-%d %I:%M %p" %}
   ```

## 템플릿 렌더링 시 주의사항

1. **보안**
   - 사용자 입력을 그대로 출력할 때는 `{{ user_input|escape }}` 필터를 사용하여 XSS 공격을 방지해야 합니다.

2. **성능**
   - 복잡한 로직은 가능한 뷰에서 처리하고, 템플릿은 단순 출력에 집중하는 것이 좋습니다.

3. **유지보수성**
   - 템플릿 코드가 복잡해지면 가독성이 떨어집니다. 필요한 경우 여러 작은 템플릿으로 분리하세요.

4. **재사용성**
   - 공통 요소는 별도의 템플릿 파일로 분리하여 `{% include %}` 태그로 포함시키세요.

## 템플릿 캐싱

대규모 애플리케이션에서는 템플릿 렌더링에 많은 시간이 소요될 수 있습니다. Django는 템플릿 캐싱 기능을 제공하여 성능을 향상시킬 수 있습니다.

```python
from django.views.decorators.cache import cache_page

@cache_page(60 * 15)  # 15분 동안 캐시
def my_view(request):
    # 뷰 로직
```

## 결론

Django의 템플릿 시스템은 강력하면서도 유연합니다. 이를 효과적으로 사용하면 동적이고 유지보수가 쉬운 웹 페이지를 만들 수 있습니다. 템플릿의 기본 개념을 이해하고, 태그와 필터를 적절히 활용하며, 보안과 성능을 고려하는 것이 중요합니다. 또한, 템플릿 상속과 포함 기능을 활용하여 코드 재사용성을 높이고, 필요한 경우 커스텀 태그와 필터를 만들어 템플릿의 기능을 확장할 수 있습니다.