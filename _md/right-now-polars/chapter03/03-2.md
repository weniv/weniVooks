---
chapter: ë°ì´í„° êµ¬ì¡°
title: DataFrame(ë°ì´í„°í”„ë ˆì„)
date: 2024-07-23
---

# 1. DataFrame (ë°ì´í„°í”„ë ˆì„) ì´ë€?

`ë°ì´í„°í”„ë ˆì„(DataFrame)`ì€ ì‹œë¦¬ì¦ˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì—¬ëŸ¬ ê°œì˜ í–‰(Row)ê³¼ ì—´(Column)ë¡œ ì´ë£¨ì–´ì§„ 2ì°¨ì› ë°ì´í„° ë°°ì—´ êµ¬ì¡°ì…ë‹ˆë‹¤. ì—‘ì…€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì™€ ìœ ì‚¬í•œ í…Œì´ë¸”(í‘œ) í˜•íƒœë¡œ ì´ë£¨ì–´ì ¸ ìˆì–´ ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸°ì— ì í•©í•œ ìë£Œêµ¬ì¡°ì…ë‹ˆë‹¤.

DataFrameì€ ì—¬ëŸ¬ ê°œì˜ í–‰(Row)ê³¼ ì—´(Column)ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

- ë‹¨ì¼ ì—´ì€ í•˜ë‚˜ì˜ ë°ì´í„° íƒ€ì…ë§Œ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©°, ì‹œë¦¬ì¦ˆë¡œ ë°˜í™˜ë©ë‹ˆë‹¤.
- ê° í–‰ì—ëŠ” ë¦¬ìŠ¤íŠ¸ì™€ ê°™ì´ ë‹¤ì–‘í•œ ë°ì´í„° ìœ í˜•ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

# 2. DataFrame ìƒì„±

`pl.DataFrame(ë°ì´í„°)` ë¥¼ ì‚¬ìš©í•˜ì—¬ DataFrameì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°ì´í„°ì—ëŠ” ë”•ì…”ë„ˆë¦¬, numpy ë°°ì—´, ì‹œë¦¬ì¦ˆ ë°ì´í„° í˜•íƒœê°€ ë“¤ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 2.1 Dictionaryë¡œ ìƒì„±í•˜ê¸°

```python
from datetime import datetime
import polars as pl

data = {
    "integer": [1, 2, 3, 4, 5],
    "date": [
        datetime(2022, 1, 1),
        datetime(2022, 1, 2),
        datetime(2022, 1, 3),
        datetime(2022, 1, 4),
        datetime(2022, 1, 5),
    ],
    "float": [4.0, 5.0, 6.0, 7.0, 8.0],
    "string": ["a", "b", "c", "d", "e"],
}

# ë°ì´í„°í”„ë ˆì„ ìƒì„±í•˜ê¸°
df = pl.DataFrame(data)
print(df)
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2.2 Series ë¦¬ìŠ¤íŠ¸ë¡œ ìƒì„±í•˜ê¸°

```python
data = [
    pl.Series("col1", [1, 2], dtype=pl.Float32),
    pl.Series("col2", [3, 4], dtype=pl.Int64),
]
df2 = pl.DataFrame(data)
print(df2)
```

```
shape: (2, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ col1 â”† col2 â”‚
â”‚ ---  â”† ---  â”‚
â”‚ f32  â”† i64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 1.0  â”† 3    â”‚
â”‚ 2.0  â”† 4    â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

## 2.3 ì¤‘ì²© ë¦¬ìŠ¤íŠ¸ë¡œ ìƒì„±í•˜ê¸°

ì¤‘ì²©ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê³  schema ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—´ ì´ë¦„ ì§€ì •í•©ë‹ˆë‹¤.

```python
data = [[1, 2, 3], [4, 5, 6]]
df3 = pl.DataFrame(data, schema=["a", "b", "c"])
print(df3)
```

```
shape: (2, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† i64 â”† i64 â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† 2   â”† 3   â”‚
â”‚ 4   â”† 5   â”† 6   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

ì¤‘ì²© ë¦¬ìŠ¤íŠ¸ë¡œ ë°ì´í„° í”„ë ˆì„ì„ ìƒì„±í•  ê²½ìš° í–‰ì„ ë¨¼ì € ì±„ìš°ê³  ì—´ì„ ì±„ìš°ê²Œ ë©ë‹ˆë‹¤. ë§Œì•½, ì—´ì„ ê¸°ì¤€ìœ¼ë¡œ ë¨¼ì € ì±„ìš°ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ `orient="col"` ì†ì„±ì„ ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.

```python
import numpy as np

data = np.array([(1, 2), (3, 4)], dtype=np.int64)
df6 = pl.DataFrame(data, schema=["a", "b"], orient="col")
print(df6)
```

- orient
  - col : ì—´ì„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë„£ìŠµë‹ˆë‹¤.
  - row(ê¸°ë³¸ê°’) : í–‰ì„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë„£ìŠµë‹ˆë‹¤.

```
shape: (2, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”‚
â”‚ --- â”† --- â”‚
â”‚ i64 â”† i64 â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† 3   â”‚
â”‚ 2   â”† 4   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

# 3. ë°ì´í„° íƒ€ì…

## 3.1 dtypes

ë°ì´í„° íƒ€ì…ì€ ë°ì´í„°í”„ë ˆì„ì„ ì¶œë ¥í•  ë•Œ í—¤ë”ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. dtypesìœ¼ë¡œ ë°ì´í„°í”„ë ˆì„ ì•ˆì— ìˆëŠ” ì—´ì˜ ë°ì´í„° íƒ€ì…(ìë£Œí˜•)ì„ ì°¨ë¡€ëŒ€ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.dtypes)
```

```
[Int64, Datetime(time_unit='us', time_zone=None), Float64, String]
```

## 3.2 schema

schemaëŠ” ì»¬ëŸ¼ëª…ê³¼ ë°ì´í„° íƒ€ì…ì„ ê°™ì´ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, (ì»¬ëŸ¼ëª…, ë°ì´í„° íƒ€ì…) ìˆœì„œëŒ€ë¡œ íŠœí”Œ í˜•íƒœë¡œ ì¶œë ¥ë©ë‹ˆë‹¤.

```python
print(df.schema)
```

```
OrderedDict([('integer', Int64), ('date', Datetime(time_unit='us', time_zone=None)), ('float', Float64), ('string', String)])
```

ë°ì´í„°í”„ë ˆì„ ìƒì„± ì‹œì— schema ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—´ì˜ íƒ€ì…ì„ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

1. **{name:type}ì˜ ë”•ì…”ë„ˆë¦¬ í˜•íƒœ**

   ```python
   data = {"col1": [0, 2], "col2": [3, 7]}
   df4 = pl.DataFrame(data, schema={"col1": pl.Float32, "col2": pl.Int64})
   print(df4)
   ```

   ```
   shape: (2, 2)
   â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
   â”‚ col1 â”† col2 â”‚
   â”‚ ---  â”† ---  â”‚
   â”‚ f32  â”† i64  â”‚
   â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
   â”‚ 0.0  â”† 3    â”‚
   â”‚ 2.0  â”† 7    â”‚
   â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
   ```

2. **(name:type) ë¦¬ìŠ¤íŠ¸ í˜•íƒœ**

   ```python
   df5 = pl.DataFrame(data, schema=[("col1", pl.Float32), ("col2", pl.Int64)])
   print(df5)
   ```

   ```
   shape: (2, 2)
   â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
   â”‚ col1 â”† col2 â”‚
   â”‚ ---  â”† ---  â”‚
   â”‚ f32  â”† i64  â”‚
   â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
   â”‚ 0.0  â”† 3    â”‚
   â”‚ 2.0  â”† 7    â”‚
   â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
   ```

schemaë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•˜ì‹¤ ë•Œ,

- ìŠ¤í‚¤ë§ˆì— ì œê³µëœ ì»¬ëŸ¼ëª… ìˆ˜ëŠ” ë°ì´í„° ì°¨ì› ìˆ˜ì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
- ë°ì´í„° íƒ€ì…ì„ ë”°ë¡œ ì§€ì •í•˜ì§€ ì•Šê±°ë‚˜ ê¸°ë³¸ê°’ì¸ Noneìœ¼ë¡œ ì„¤ì •í•œ ì»¬ëŸ¼ë“¤ì€ ìë™ìœ¼ë¡œ íƒ€ì…ì„ ì„¤ì •í•©ë‹ˆë‹¤.
- ê¸°ë³¸ ë°ì´í„°ì˜ ì»¬ëŸ¼ëª…ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ì—´ ì´ë¦„ ëª©ë¡ì„ ì œê³µí•˜ë©´ ì œê³µëœ ì»¬ëŸ¼ëª…ì´ í•´ë‹¹ ëª©ë¡ì„ ë®ì–´ì”ë‹ˆë‹¤.

## 3.3 cast

ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ {ì»¬ëŸ¼ëª… : ë°ì´í„° íƒ€ì…} ì£¼ì–´ ì—´ì„ ì§€ì •ëœ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ í˜•ë³€í™˜í•©ë‹ˆë‹¤.

```python
# df.cast({"ì»¬ëŸ¼ëª…": ë°ì´í„°íƒ€ì…})
print(df.cast({"integer": pl.Float32, "float": pl.UInt8}))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ f32     â”† datetime[Î¼s]        â”† u8    â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1.0     â”† 2022-01-01 00:00:00 â”† 4     â”† a      â”‚
â”‚ 2.0     â”† 2022-01-02 00:00:00 â”† 5     â”† b      â”‚
â”‚ 3.0     â”† 2022-01-03 00:00:00 â”† 6     â”† c      â”‚
â”‚ 4.0     â”† 2022-01-04 00:00:00 â”† 7     â”† d      â”‚
â”‚ 5.0     â”† 2022-01-05 00:00:00 â”† 8     â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

selectorsë¡œ ëª¨ë“  ì—´ì„ í•œ ë²ˆì— ê°™ì€ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
import polars.selectors as cs
print(df.cast({cs.numeric(): pl.UInt32, cs.temporal(): pl.String}))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                       â”† float â”† string â”‚
â”‚ ---     â”† ---                        â”† ---   â”† ---    â”‚
â”‚ u32     â”† str                        â”† u32   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00.000000 â”† 4     â”† a      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00.000000 â”† 5     â”† b      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00.000000 â”† 6     â”† c      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00.000000 â”† 7     â”† d      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00.000000 â”† 8     â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ëª¨ë“  ì—´ì„ ë‹¨ì¼ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.cast(pl.String))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                       â”† float â”† string â”‚
â”‚ ---     â”† ---                        â”† ---   â”† ---    â”‚
â”‚ str     â”† str                        â”† str   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00.000000 â”† 4.0   â”† a      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00.000000 â”† 5.0   â”† b      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00.000000 â”† 6.0   â”† c      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00.000000 â”† 7.0   â”† d      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00.000000 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ë°ì´í„° íƒ€ì…ê³¼ ì¼ì¹˜í•˜ëŠ” ëª¨ë“  ì—´ì„ ë‹¤ë¥¸ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
print(df.cast({pl.Datetime: pl.Date}))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date       â”† float â”† string â”‚
â”‚ ---     â”† ---        â”† ---   â”† ---    â”‚
â”‚ i64     â”† date       â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 â”† 4.0   â”† a      â”‚
â”‚ 2       â”† 2022-01-02 â”† 5.0   â”† b      â”‚
â”‚ 3       â”† 2022-01-03 â”† 6.0   â”† c      â”‚
â”‚ 4       â”† 2022-01-04 â”† 7.0   â”† d      â”‚
â”‚ 5       â”† 2022-01-05 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

strict ë§¤ê°œë³€ìˆ˜ë¥¼ True(ê¸°ë³¸ê°’)ë¡œ ì„¤ì •í•˜ë©´, í˜•ë³€í™˜ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ëŠ” ê²½ìš° ì˜¤ë¥˜ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.

```python
print(df.cast({pl.String: pl.Datetime}, strict=True))
```

```
ComputeError: conversion from `str` to `datetime[Î¼s]` failed in column 'string' for 5 out of 5 values: ["a", "b", â€¦ "e"]

You might want to try:
- setting `strict=False` to set values that cannot be converted to `null`
- using `str.strptime`, `str.to_date`, or `str.to_datetime` and providing a format string
```

ë§Œì•½, Falseë¡œ ì„¤ì •í•  ê²½ìš°, ì˜¤ë¥˜ê°€ ë‚˜ëŠ” ì—´ì˜ ê°’ì€ nullë¡œ ë°˜í™˜ë©ë‹ˆë‹¤.

```python
print(df.cast({pl.String: pl.Datetime}, strict=False))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string       â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---          â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† datetime[Î¼s] â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† null         â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† null         â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† null         â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† null         â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† null         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

# 4. ë°ì´í„° ì‚¬ì „ ë¶„ì„

ë°ì´í„°í”„ë ˆì„ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ê°„ë‹¨íˆ ì‚´í´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## 4.1 ì‚¬ì „ ë¶„ì„ì— ì‚¬ìš©í•  í•¨ìˆ˜

- **glimpse()**: DataFrameì„ êµ¬ì„±í•˜ëŠ” í–‰ê³¼ ì—´ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‚˜íƒ€ë‚´ ì£¼ëŠ” í•¨ìˆ˜
- **head(n), limit(n)** : DataFrameì˜ ì²˜ìŒë¶€í„° nê°œì˜ í–‰ì„ ì¶œë ¥
- **tail(n)**: DataFrameì˜ ë§ˆì§€ë§‰ nê°œì˜ í–‰ì„ ì¶œë ¥
- **describe()**: Series, DataFrameì˜ ê° ì—´ì— ëŒ€í•œ ìš”ì•½ í†µê³„
- **shape**: DataFrameì˜ í¬ê¸°(í–‰/ì—´ ê°œìˆ˜) í™•ì¸
- **height**: DataFrameì˜ í–‰ ê°œìˆ˜ í™•ì¸
- **width**: DataFrameì˜ ì—´ ê°œìˆ˜ í™•ì¸

## 4.2 ë°ì´í„° í™•ì¸

### 4.2.1 ë°ì´í„° ê¸°ë³¸ ì •ë³´ í™•ì¸

glimpse() í•¨ìˆ˜ëŠ” DataFrameì„ êµ¬ì„±í•˜ëŠ” í–‰ê³¼ ì—´ì— ëŒ€í•œ ì •ë³´, ì»¬ëŸ¼ëª…, ë°ì´í„° ìœ í˜•, ê·¸ë¦¬ê³  ê° ì»¬ëŸ¼ì˜ ëª‡ ê°œì˜ ë°ì´í„°ë¥¼ ë³´ì—¬ì£¼ì–´ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ë¹ ë¥´ê²Œ íŒŒì•…í•˜ê³  ì–´ë–¤ ì •ë³´ê°€ ìˆëŠ”ì§€ ë¯¸ë¦¬ë³¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤.

```python
print(df.glimpse())
```

```
Rows: 5
Columns: 4
$ integer          <i64> 1, 2, 3, 4, 5
$ date    <datetime[Î¼s]> 2022-01-01 00:00:00, 2022-01-02 00:00:00, 2022-01-03 00:00:00, 2022-01-04 00:00:00, 2022-01-05 00:00:00
$ float            <f64> 4.0, 5.0, 6.0, 7.0, 8.0
$ string           <str> 'a', 'b', 'c', 'd', 'e'

None
```

max_items_per_column ë§¤ê°œë³€ìˆ˜ëŠ” ì—´ë‹¹ í‘œì‹œí•  ìµœëŒ€ í•­ëª© ìˆ˜ë¥¼ ë§í•˜ë©°, ê¸°ë³¸ê°’ì€ 10ê°œ ì…ë‹ˆë‹¤.

```python
print(df.glimpse(max_items_per_column=2))
```

```
Rows: 5
Columns: 4
$ integer          <i64> 1, 2
$ date    <datetime[Î¼s]> 2022-01-01 00:00:00, 2022-01-02 00:00:00
$ float            <f64> 4.0, 5.0
$ string           <str> 'a', 'b'

None
```

max_colname_lengthëŠ” ì»¬ëŸ¼ëª…ì„ í‘œì‹œí•  ë•Œ ì‚¬ìš©ë˜ëŠ” ìµœëŒ€ ê¸¸ì´ë¥¼ ì§€ì •í•˜ëŠ” ë§¤ê°œë³€ìˆ˜ì…ë‹ˆë‹¤. ë§Œì•½, ë¬¸ìì—´ ê¸¸ì´ê°€ ìµœëŒ€ ê¸¸ì´ë¥¼ ì´ˆê³¼í•˜ê²Œ ë˜ë©´ ë’· ë¶€ë¶„ì€ ìƒëµë˜ì–´ í‘œì‹œë©ë‹ˆë‹¤.

```python
print(df.glimpse(max_colname_length=4))
```

```
Rows: 5
Columns: 4
$ intâ€¦          <i64> 1, 2, 3, 4, 5
$ date <datetime[Î¼s]> 2022-01-01 00:00:00, 2022-01-02 00:00:00, 2022-01-03 00:00:00, 2022-01-04 00:00:00, 2022-01-05 00:00:00
$ floâ€¦          <f64> 4.0, 5.0, 6.0, 7.0, 8.0
$ strâ€¦          <str> 'a', 'b', 'c', 'd', 'e'

None
```

ìœ„ì˜ ì¶œë ¥ê²°ê³¼ë¥¼ ë³´ë©´ ë§ˆì§€ë§‰ ì¶œë ¥ì— Noneì´ë¼ê³  ì¶œë ¥ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. return_as_string ë§¤ê°œë³€ìˆ˜ê°€ Trueë©´ stdoutìœ¼ë¡œ ì¶œë ¥í•˜ëŠ” ëŒ€ì‹  ë¬¸ìì—´ë¡œ ì¶œë ¥í•˜ê²Œ ë©ë‹ˆë‹¤.

```python
print(df.glimpse(return_as_string=True))
```

```
Rows: 5
Columns: 4
$ integer          <i64> 1, 2, 3, 4, 5
$ date    <datetime[Î¼s]> 2022-01-01 00:00:00, 2022-01-02 00:00:00, 2022-01-03 00:00:00, 2022-01-04 00:00:00, 2022-01-05 00:00:00
$ float            <f64> 4.0, 5.0, 6.0, 7.0, 8.0
$ string           <str> 'a', 'b', 'c', 'd', 'e'
```

### 4.2.2 ìƒë‹¨ ê°’ ë°ì´í„° í™•ì¸

- **head(n), limit(n)**: DataFrameì˜ ì²˜ìŒë¶€í„° nê°œì˜ í–‰ì„ í™•ì¸í•©ë‹ˆë‹¤.
- ê¸°ë³¸ì ìœ¼ë¡œ ë°ì´í„°í”„ë ˆì„ì˜ ì²˜ìŒ 5í–‰ì„ ê°€ì ¸ì˜¤ê³  ì¶œë ¥í•˜ê³  ì‹¶ì€ í–‰ì˜ ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìŒìˆ˜ ê°’ì´ ì „ë‹¬ë˜ë©´ ë§ˆì§€ë§‰ ì ˆëŒ“ê°’ ní–‰ì„ ì œì™¸í•œ ëª¨ë“  í–‰ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
print(df.head())
# print(df.head(3))
# print(df.head(-3))
# print(df.limit())
# print(df.limit(3))
# print(df.limit(-3))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2.3 í•˜ë‹¨ ê°’ ë°ì´í„° í™•ì¸

- **tail(n)**: DataFrameì˜ ë§ˆì§€ë§‰ nê°œì˜ í–‰ì„ ì¶œë ¥í•©ë‹ˆë‹¤.
- ê¸°ë³¸ì ìœ¼ë¡œ ë°ì´í„°í”„ë ˆì„ì˜ ë§ˆì§€ë§‰ 5í–‰ì„ ê°€ì ¸ì˜¤ê³  headì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì¶œë ¥í•˜ê³  ì‹¶ì€ í–‰ì˜ ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìŒìˆ˜ ê°’ì´ ì „ë‹¬ë˜ë©´ ì²« ë²ˆì§¸ ì ˆëŒ“ê°’ ní–‰ì„ ì œì™¸í•œ ëª¨ë“  í–‰ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
print(df.tail())
# print(df.tail(3))
# print(df.tail(-3))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4.3 ë°ì´í„° í˜•íƒœ

shape, height, width í•¨ìˆ˜ë¡œ DataFrameì˜ í¬ê¸°(í–‰/ì—´ ê°œìˆ˜) í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.shape) # ë°ì´í„°í”„ë ˆì„ ëª¨ì–‘
```

```
(5, 4)
```

```python
print(df.height) # í–‰ ê°œìˆ˜
```

```
5
```

```python
print(df.width) # ì—´ ê°œìˆ˜
```

```
4
```

## 4.4 ê³ ìœ ê°’ í™•ì¸í•˜ê¸°

approx_n_unique í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°í”„ë ˆì„ì— ìˆëŠ” ê°ê°ì˜ ì»¬ëŸ¼ì— ê³ ìœ í•œ ê°’ì˜ ëŒ€ëµì ì¸ ê°œìˆ˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” HyperLogLog++ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ë¹ ë¥´ê²Œ ê³ ìœ ê°’ì˜ ê°œìˆ˜ë¥¼ ì¶”ì •í•©ë‹ˆë‹¤.

```python
print(df.select(pl.all().approx_n_unique()))
```

```
shape: (1, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date â”† float â”† string â”‚
â”‚ ---     â”† ---  â”† ---   â”† ---    â”‚
â”‚ u32     â”† u32  â”† u32   â”† u32    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 5       â”† 5    â”† 5     â”† 5      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4.5 ê¸°ìˆ í†µê³„ëŸ‰(ìš”ì•½ í†µê³„)

`Describe` í•¨ìˆ˜ëŠ” ì‹œë¦¬ì¦ˆ ë˜ëŠ” ë°ì´í„°í”„ë ˆì„ì˜ ê° ì—´ì— ëŒ€í•œ ê¸°ìˆ í†µê³„ëŸ‰(ìš”ì•½ í†µê³„)ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
print(df.describe())
```

```
shape: (9, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ statistic  â”† integer  â”† date                â”† float    â”† string â”‚
â”‚ ---        â”† ---      â”† ---                 â”† ---      â”† ---    â”‚
â”‚ str        â”† f64      â”† str                 â”† f64      â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ count      â”† 5.0      â”† 5                   â”† 5.0      â”† 5      â”‚
â”‚ null_count â”† 0.0      â”† 0                   â”† 0.0      â”† 0      â”‚
â”‚ mean       â”† 3.0      â”† 2022-01-03 00:00:00 â”† 6.0      â”† null   â”‚
â”‚ std        â”† 1.581139 â”† null                â”† 1.581139 â”† null   â”‚
â”‚ min        â”† 1.0      â”† 2022-01-01 00:00:00 â”† 4.0      â”† a      â”‚
â”‚ 25%        â”† 2.0      â”† 2022-01-02 00:00:00 â”† 5.0      â”† null   â”‚
â”‚ 50%        â”† 3.0      â”† 2022-01-03 00:00:00 â”† 6.0      â”† null   â”‚
â”‚ 75%        â”† 4.0      â”† 2022-01-04 00:00:00 â”† 7.0      â”† null   â”‚
â”‚ max        â”† 5.0      â”† 2022-01-05 00:00:00 â”† 8.0      â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<aside>
ğŸ‘‰ ì¤‘ì•™ê°’ì€ 50% ë°±ë¶„ìœ„ ìˆ˜ ê°’ì…ë‹ˆë‹¤.

</aside>

## 4.6 ìƒ˜í”Œ(Sample)

sampleì„ ì‚¬ìš©í•˜ë©´ ë°ì´í„°í”„ë ˆì„ì—ì„œ ì„ì˜ì˜ nê°œì˜ í–‰ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
# df.sample(n)
# df.sample(fraction)
print(df.sample(3))
# print(df.sample(1.5))
```

- n : ë°˜í™˜ ê°œìˆ˜, fractionì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- fraction : ë°˜í™˜í•  í•­ëª©ì˜ ë¶„ìˆ˜ê°’ì…ë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ 1ì´ë©°, nê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

```
shape: (3, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

with_replacementëŠ” ì¤‘ë³µ ì¶”ì¶œ í—ˆìš©í• ì§€ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ Falseì´ë©°, Trueë¡œ ì„¤ì •í•˜ë©´ ê°’ì´ ë‘ ë²ˆì´ìƒ ìƒ˜í”Œë§ ë˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.sample(3, with_replacement=True))
```

```
shape: (3, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

shuffleì€ ì¶”ì¶œëœ ìƒ˜í”Œì˜ ìˆœì„œë¥¼ ì„ì„ì§€ ì—¬ë¶€ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. shuffleë¥¼ Trueë¡œ ì„¤ì •í•˜ë©´ ìƒ˜í”Œë§ëœ í–‰ì˜ ìˆœì„œì™€ ìƒê´€ì—†ì´ ì¶œë ¥ë˜ê³ , False(ê¸°ë³¸ê°’)ë¡œ ì„¤ì •í•˜ë©´ ë°˜í™˜ë˜ëŠ” ìˆœì„œê°€ ì•ˆì •ì ì´ì§€ë„ ì•Šê³  ì™„ì „íˆ ë¬´ì‘ìœ„ì ì´ì§€ë„ ì•ŠìŠµë‹ˆë‹¤.

```python
print(df.sample(3, shuffle=True))
```

```
shape: (3, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

seedëŠ” ë‚œìˆ˜ ìƒì„±ê¸°ì…ë‹ˆë‹¤. ì—†ìŒ(ê¸°ë³¸ê°’)ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ê° ìƒ˜í”Œ ì‘ì—…ì— ëŒ€í•´ ë¬´ì‘ìœ„ seedê°€ ìƒì„±ë©ë‹ˆë‹¤.

```python
print(df.sample(3, seed=2))
```

```
shape: (3, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

# 5. DataFrame ë°ì´í„° ì¡°ì‘

DataFrameì˜ ê° ì…€ì—ëŠ” ìˆ«ì, ë¬¸ìì—´ ë“±ê³¼ ê°™ì€ ë‹¤ì–‘í•œ í˜•íƒœì˜ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìœ¼ë©°, í–‰ì˜ ì¸ë±ìŠ¤ ê°’ì´ë‚˜ ì—´ì— ì§€ì •ëœ ë ˆì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì‰½ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ë°ì´í„°ë“¤ì„ ì¡°ì‘í•˜ê³  ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 5.1 DataFrameì˜ Index(ì¸ë±ìŠ¤)

ì¸ë±ìŠ¤ëŠ” ë°ì´í„°í”„ë ˆì„ì—ì„œ ê° `í–‰ì˜ ìœ„ì¹˜`ë¥¼ ì‹ë³„í•˜ëŠ” ë ˆì´ë¸”ë¡œ, ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¹ ë¥´ê³  ì‰½ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
Polars ë°ì´í„°í”„ë ˆì„ì€ ë¬µì‹œì  ì¸ë±ìŠ¤ë¥¼ ì œê³µí•˜ëŠ”ë°, ì´ëŠ” ë°ì´í„°í”„ë ˆì„ ìƒì„± ì‹œ ìë™ìœ¼ë¡œ ë¶€ì—¬ë˜ëŠ” `RangeIndex`ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.

### 5.1.1 ì¸ë±ìŠ¤(í–‰)ë¡œ ì¡°íšŒ

ë°ì´í„°í”„ë ˆì„ì—ì„œ íŠ¹ì • í–‰ì˜ ë°ì´í„°ë¥¼ ì¶”ì¶œí•  ë•ŒëŠ” `ì •ìˆ˜í˜• ì¸ë±ìŠ¤`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. `df[ì •ìˆ˜í˜• ì¸ë±ìŠ¤]` í˜•ì‹ìœ¼ë¡œ ì›í•˜ëŠ” í–‰ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df[0]) # ì²« ë²ˆì§¸ í–‰ ì¡°íšŒ
print(df[1:4]) # 2~4ë²ˆì§¸ í–‰ ì¡°íšŒ
```

```
shape: (1, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
shape: (3, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

`df[0]`ëŠ” row(í–‰) ë°ì´í„°ì˜ ì¸ë±ìŠ¤ë§Œ ë‚˜ì™€ìˆìœ¼ë¯€ë¡œ dfì˜ 0ë²ˆì§¸ í–‰ì˜ ê°’ì„ ê°€ì ¸ì˜¤ê²Œ ë©ë‹ˆë‹¤. `df[1:4]`ëŠ” row ë°ì´í„°ì˜ ì¸ë±ìŠ¤ ì¤‘ 1 ë²ˆì§¸ ~ 3 ë²ˆì§¸ ì¸ë±ìŠ¤ ê°’ì„ ê°€ì§€ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê²Œ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ë°˜í™˜ë˜ëŠ” ë°ì´í„° íƒ€ì…ì€ dataframe(ë°ì´í„°í”„ë ˆì„) íƒ€ì…ì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.

ìŒìˆ˜ ì¸ë±ìŠ¤ë¡œë„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df[-3:])
print(df[::-1])
```

```
shape: (3, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.1.2 slice

ë°ì´í„°í”„ë ˆì„ ì¤‘ ì¼ë¶€ë¥¼ ê°€ì§€ê³  ì˜¬ ë•Œ `ì¸ë±ìŠ¤ ì´ë¦„`ì„ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. `slice[row index, column index]`ë¥¼ ì´ìš©í•´ì„œ ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
# df.slice("ì‹œì‘ ì¸ë±ìŠ¤", "ê¸¸ì´")
print(df.slice(0,1))
print(df.slice(3)) # ê¸¸ì´ë¥¼ ì„¤ì •í•˜ì§€ ì•ŠëŠ” ê²½ìš°, ì˜¤í”„ì…‹ì—ì„œ ì‹œì‘í•˜ëŠ” ëª¨ë“  í–‰ì´ ì„ íƒ
print(df.slice(-1,3))
```

```
shape: (1, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
shape: (2, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
shape: (1, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.1.3 gather_every

ë°ì´í„°í”„ë ˆì„ì˜ në²ˆì§¸ í–‰ì„ ëª¨ë‘ ê°€ì ¸ì™€ ìƒˆ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
# df.gather_every(n)
print(df.gather_every(2))
```

```
shape: (3, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

offset ë§¤ê°œë³€ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì‹œì‘ ì¸ë±ìŠ¤ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.gather_every(2, offset=1))
```

```
shape: (2, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† d      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.1.4 row

ì§€ì •ëœ ì¸ë±ìŠ¤ë‚˜ ì¡°ê±´ì„ ê¸°ì¤€ìœ¼ë¡œ ë‹¨ì¼ í–‰ì˜ íŠœí”Œ ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
# df.row("í–‰ ì¸ë±ìŠ¤ ê°’")
print(df.row(2))
```

```
(3, datetime.datetime(2022, 1, 3, 0, 0), 6.0, 'c')
```

ì»¬ëŸ¼ëª…ì„ í–‰ ê°’ì— ë§¤í•‘í•˜ì—¬ ë”•ì…”ë„ˆë¦¬ë¡œ ë°˜í™˜í•˜ë ¤ë©´ named=Trueë¥¼ ì§€ì •í•©ë‹ˆë‹¤. Falseë¡œ ì§€ì •í•  ê²½ìš° íŠœí”Œ(ê¸°ë³¸ê°’)ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
print(df.row(2, named=True))
```

```
{'integer': 3, 'date': datetime.datetime(2022, 1, 3, 0, 0), 'float': 6.0, 'string': 'c'}
```

ì¼ë°˜ íŠœí”Œì„ ë°˜í™˜í•˜ëŠ” ê²ƒë³´ë‹¤ ë¹„ìš©ì´ ë§ì´ ë“¤ì§€ë§Œ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ê°’ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì£¼ì–´ì§„ ì¡°ê±´ê³¼ ì¼ì¹˜í•˜ëŠ” í–‰ì„ ë°˜í™˜í•˜ë ¤ë©´ by_predicateë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```python
print(df.row(by_predicate=(pl.col("string") == "b")))
```

```
(2, datetime.datetime(2022, 1, 2, 0, 0), 5.0, 'b')
```

by_predicateë¥¼ ì‚¬ìš©í•  ë•Œ í‚¤ì›Œë“œë¡œ ì œê³µí•´ì•¼ í•˜ë©°, í•˜ë‚˜ì˜ í–‰ì´ ì•„ë‹Œ ë‹¤ë¥¸ í–‰ì´ ë°˜í™˜ë˜ë©´ ì˜¤ë¥˜ ì¡°ê±´ì´ ë©ë‹ˆë‹¤. í–‰ì´ ë‘ ê°œ ì´ìƒì´ë©´ TooManyRowsReturnedErrorê°€ ë°œìƒí•˜ê³ , í–‰ì´ 0ì´ë©´ NoRowsReturnedErrorê°€ ë°œìƒí•©ë‹ˆë‹¤. (ë‘˜ ë‹¤ RowsErrorì—ì„œ ìƒì†ë©ë‹ˆë‹¤)

```python
df[3,'string']='b'
print(df)
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ integer â”† date                â”† float â”† string â”‚
â”‚ ---     â”† ---                 â”† ---   â”† ---    â”‚
â”‚ i64     â”† datetime[Î¼s]        â”† f64   â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1       â”† 2022-01-01 00:00:00 â”† 4.0   â”† a      â”‚
â”‚ 2       â”† 2022-01-02 00:00:00 â”† 5.0   â”† b      â”‚
â”‚ 3       â”† 2022-01-03 00:00:00 â”† 6.0   â”† c      â”‚
â”‚ 4       â”† 2022-01-04 00:00:00 â”† 7.0   â”† b      â”‚
â”‚ 5       â”† 2022-01-05 00:00:00 â”† 8.0   â”† e      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df.row(by_predicate=(pl.col("string") == "b")))
```

```
TooManyRowsReturnedError: predicate <[(col("string")) == (String(b))]> returned 2 rows
```

```python
print(df.row(by_predicate=(pl.col("string") == "d")))
```

```
NoRowsReturnedError: predicate <[(col("string")) == (String(d))]> returned no rows
```

ë°ì´í„° í”„ë ˆì„ì„ ë°˜ë³µí•  ë•ŒëŠ” ì´ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆ ë˜ë©° í–‰ ë°˜ë³µì´ í•„ìš”í•œ ê²½ìš° iter_rows()ë¥¼ ì‚¬ìš©í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.

### 5.1.5 rows

ë°ì´í„°í”„ë ˆì„ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ í–‰ ëª©ë¡ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ê° í–‰ì€ í”„ë ˆì„ ì—´ê³¼ ë™ì¼í•œ ìˆœì„œë¡œ ì£¼ì–´ì§„ ê°’ì˜ íŠœí”Œë¡œ ë°˜í™˜ë©ë‹ˆë‹¤.

```python
print(df.rows())
```

```
[(1, datetime.datetime(2022, 1, 1, 0, 0), 4.0, 'a'), (2, datetime.datetime(2022, 1, 2, 0, 0), 5.0, 'b'), (3, datetime.datetime(2022, 1, 3, 0, 0), 6.0, 'c'), (4, datetime.datetime(2022, 1, 4, 0, 0), 7.0, 'b'), (5, datetime.datetime(2022, 1, 5, 0, 0), 8.0, 'e')]
```

named=Trueë¡œ ì„¤ì •í•˜ë©´ íŠœí”Œ ëŒ€ì‹  ë”•ì…”ë„ˆë¦¬ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. ë”•ì…”ë„ˆë¦¬ëŠ” ì—´ ì´ë¦„ê³¼ í–‰ ê°’ì„ ë§¤í•‘í•œ ê²ƒì…ë‹ˆë‹¤.

```python
print(df.rows(named=True))
```

```
[{'integer': 1, 'date': datetime.datetime(2022, 1, 1, 0, 0), 'float': 4.0, 'string': 'a'}, {'integer': 2, 'date': datetime.datetime(2022, 1, 2, 0, 0), 'float': 5.0, 'string': 'b'}, {'integer': 3, 'date': datetime.datetime(2022, 1, 3, 0, 0), 'float': 6.0, 'string': 'c'}, {'integer': 4, 'date': datetime.datetime(2022, 1, 4, 0, 0), 'float': 7.0, 'string': 'b'}, {'integer': 5, 'date': datetime.datetime(2022, 1, 5, 0, 0), 'float': 8.0, 'string': 'e'}]
```

ì¼ë°˜ íŠœí”Œì„ ë°˜í™˜í•˜ëŠ” ê²ƒë³´ë‹¤ ë¹„ìš©ì´ ë§ì´ ë“¤ì§€ë§Œ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ê°’ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

:::div{.callout}
ë°ì´í„°ê°€ ì—´ í˜•íƒœë¡œ ì €ì¥ë˜ë¯€ë¡œ í–‰ ë°˜ë³µì€ ìµœì ì´ ì•„ë‹ˆë©°, ì ì¬ì ìœ¼ë¡œ ë¹„ìš©ì´ ë§ì´ ë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°€ëŠ¥í•˜ë©´ ì—´ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” export/output ë©”ì„œë“œ ì¤‘ í•˜ë‚˜ë¥¼ í†µí•´ ë‚´ë³´ë‚´ëŠ” ê²ƒì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. ë˜í•œ, ëª¨ë“  ë°ì´í„°ë¥¼ í•œ ë²ˆì— êµ¬ì²´í™”í•˜ì§€ ì•Šìœ¼ë ¤ë©´ iter_rowsë¥¼ ëŒ€ì‹  rowsë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤. ë‘ ë©”ì„œë“œëŠ” ì„±ëŠ¥ ì°¨ì´ê°€ ê±°ì˜ ì—†ì§€ë§Œ í–‰ì„ ì¼ê´„ ì²˜ë¦¬í•˜ë©´ ë©”ëª¨ë¦¬ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

:::

### 5.1.6 rows_by_key

íŠ¹ì • ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ í–‰ ê·¸ë£¹í™”í•˜ì—¬ ë”•ì…”ë„ˆë¦¬ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
print(df.rows_by_key(key=["integer"]))
```

- key : ë”•ì…”ë„ˆë¦¬ì˜ keyë¡œ ì‚¬ìš©í•  ì»¬ëŸ¼ëª…ì…ë‹ˆë‹¤.

```
defaultdict(<class 'list'>, {1: [(datetime.datetime(2022, 1, 1, 0, 0), 4.0, 'a')], 2: [(datetime.datetime(2022, 1, 2, 0, 0), 5.0, 'b')], 3: [(datetime.datetime(2022, 1, 3, 0, 0), 6.0, 'c')], 4: [(datetime.datetime(2022, 1, 4, 0, 0), 7.0, 'b')], 5: [(datetime.datetime(2022, 1, 5, 0, 0), 8.0, 'e')]})
```

ì—¬ëŸ¬ ì—´ì´ ì§€ì •ë˜ë©´ í‚¤ëŠ” í•´ë‹¹ ê°’ì˜ íŠœí”Œì´ ë˜ê³ , ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë¬¸ìì—´ì´ ë©ë‹ˆë‹¤.

```python
print(df.rows_by_key(key=["string",'integer']))
```

```
defaultdict(<class 'list'>, {(1, 'a'): [(datetime.datetime(2022, 1, 1, 0, 0), 4.0)], (2, 'b'): [(datetime.datetime(2022, 1, 2, 0, 0), 5.0)], (3, 'c'): [(datetime.datetime(2022, 1, 3, 0, 0), 6.0)], (4, 'b'): [(datetime.datetime(2022, 1, 4, 0, 0), 7.0)], (5, 'e'): [(datetime.datetime(2022, 1, 5, 0, 0), 8.0)]})
```

```python
print(df.rows_by_key(key=["string"], named=True))
```

- named : ì»¬ëŸ¼ëª…ì„ í–‰ ê°’ì— ë§¤í•‘í•˜ì—¬ íŠœí”Œ ëŒ€ì‹  ë”•ì…”ë„ˆë¦¬ í–‰ ê·¸ë£¹ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```
defaultdict(<class 'list'>, {'a': [{'integer': 1, 'date': datetime.datetime(2022, 1, 1, 0, 0), 'float': 4.0}], 'b': [{'integer': 2, 'date': datetime.datetime(2022, 1, 2, 0, 0), 'float': 5.0}, {'integer': 4, 'date': datetime.datetime(2022, 1, 4, 0, 0), 'float': 7.0}], 'c': [{'integer': 3, 'date': datetime.datetime(2022, 1, 3, 0, 0), 'float': 6.0}], 'e': [{'integer': 5, 'date': datetime.datetime(2022, 1, 5, 0, 0), 'float': 8.0}]})
```

í‚¤ê°€ ê³ ìœ í•˜ë‹¤ê³  ê°€ì •í•˜ì—¬ í–‰ ê·¸ë£¹ì„ ì‚¬ì „ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
print(df.rows_by_key(key=["integer"], unique=True))
```

- unique : í‚¤ê°€ ê³ ìœ í•¨ì„ ë‚˜íƒ€ë‚´ë©°, í‚¤ì—ì„œ ì—°ê²°ëœ ë‹¨ì¼ í–‰ìœ¼ë¡œ 1:1 ë§¤í•‘ì´ ì´ë£¨ì–´ì§€ê²Œ ë©ë‹ˆë‹¤.

```
{1: (datetime.datetime(2022, 1, 1, 0, 0), 4.0, 'a'), 2: (datetime.datetime(2022, 1, 2, 0, 0), 5.0, 'b'), 3: (datetime.datetime(2022, 1, 3, 0, 0), 6.0, 'c'), 4: (datetime.datetime(2022, 1, 4, 0, 0), 7.0, 'b'), 5: (datetime.datetime(2022, 1, 5, 0, 0), 8.0, 'e')}
```

```python
print(df.rows_by_key(key=["integer"], named=True, unique=True))
```

```
{1: {'date': datetime.datetime(2022, 1, 1, 0, 0), 'float': 4.0, 'string': 'a'}, 2: {'date': datetime.datetime(2022, 1, 2, 0, 0), 'float': 5.0, 'string': 'b'}, 3: {'date': datetime.datetime(2022, 1, 3, 0, 0), 'float': 6.0, 'string': 'c'}, 4: {'date': datetime.datetime(2022, 1, 4, 0, 0), 'float': 7.0, 'string': 'b'}, 5: {'date': datetime.datetime(2022, 1, 5, 0, 0), 'float': 8.0, 'string': 'e'}}
```

í‚¤ê°€ ì‹¤ì œë¡œ ê³ ìœ í•˜ì§€ ì•Šìœ¼ë©´ ì£¼ì–´ì§„ í‚¤ê°€ ìˆëŠ” ë§ˆì§€ë§‰ í–‰ì´ ë°˜í™˜ëœë‹¤ëŠ” ì ì— ìœ ì˜í•˜ì„¸ìš”.

```python
print(df.rows_by_key(key=["string"], unique=True))
```

```
{'a': (1, datetime.datetime(2022, 1, 1, 0, 0), 4.0), 'b': (4, datetime.datetime(2022, 1, 4, 0, 0), 7.0), 'c': (3, datetime.datetime(2022, 1, 3, 0, 0), 6.0), 'e': (5, datetime.datetime(2022, 1, 5, 0, 0), 8.0)}
```

```python
print(df.rows_by_key(key=["string",'integer'], named=True, include_key=True))
```

- include_key : ì—°ê²°ëœ ë°ì´í„°ì— í‚¤ ê°’ì„ ì¸ë¼ì¸ìœ¼ë¡œ í¬í•¨í•˜ì—¬ ë³µí•© í‚¤ë¡œ ê·¸ë£¹í™”ëœ ì‚¬ì „ í–‰ì„ ë°˜í™˜í•©ë‹ˆë‹¤(ê¸°ë³¸ì ìœ¼ë¡œ ë©”ëª¨ë¦¬/ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ í‚¤ ê°’ì€ í‚¤ì—ì„œ ì¬êµ¬ì„±í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìƒëµë¨).

```
defaultdict(<class 'list'>, {('a', 1): [{'integer': 1, 'date': datetime.datetime(2022, 1, 1, 0, 0), 'float': 4.0, 'string': 'a'}], ('b', 2): [{'integer': 2, 'date': datetime.datetime(2022, 1, 2, 0, 0), 'float': 5.0, 'string': 'b'}], ('c', 3): [{'integer': 3, 'date': datetime.datetime(2022, 1, 3, 0, 0), 'float': 6.0, 'string': 'c'}], ('b', 4): [{'integer': 4, 'date': datetime.datetime(2022, 1, 4, 0, 0), 'float': 7.0, 'string': 'b'}], ('e', 5): [{'integer': 5, 'date': datetime.datetime(2022, 1, 5, 0, 0), 'float': 8.0, 'string': 'e'}]})
```

:::div{.callout}
rows ë©”ì„œë“œì™€ ë¹„ìŠ·í•˜ì§€ë§Œ í–‰ì„ í‰ë©´ ëª©ë¡ìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” ëŒ€ì‹  í‚¤ ì—´ì˜ ê°’ìœ¼ë¡œ ê·¸ë£¹í™”í•˜ì—¬ ë”•ì…”ë„ˆë¦¬ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. ëª¨ë“  í”„ë ˆì„ ë°ì´í„°ë¥¼ ì‚¬ì „ìœ¼ë¡œ êµ¬ì²´í™”í•˜ëŠ” ë° ë§ì€ ë¹„ìš©ì´ ë“¤ê¸° ë•Œë¬¸ì— ê¸°ë³¸ ì—°ì‚° ëŒ€ì‹  ì‚¬ìš©í•´ì„œëŠ” ì•ˆ ë˜ë©°, ê°’ì„ Python ë°ì´í„° êµ¬ì¡°ë‚˜ Polars/Arrowë¡œ ì§ì ‘ ì—°ì‚°í•  ìˆ˜ ì—†ëŠ” ë‹¤ë¥¸ ê°ì²´ë¡œ ì˜®ê²¨ì•¼ í•˜ëŠ” ê²½ìš°ì—ë§Œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

:::

### 5.1.7 iter_rows

ë°ì´í„°í”„ë ˆì„ì˜ í–‰ ê°’ìœ¼ë¡œ êµ¬ì„±ëœ ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ëª¨ë“  í–‰ì„ êµ¬ì²´í™”í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.

```python
print([row[0] for row in df.iter_rows()])
```

```
[1, 2, 3, 4, 5]
```

`named=True` ë¡œ ì£¼ì‹œë©´ íŠœí”Œ(ê¸°ë³¸ê°’) ëŒ€ì‹  ë”•ì…”ë„ˆë¦¬(ëª…ëª…ëœ ê²½ìš°)ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. ë”•ì…”ë„ˆë¦¬ëŠ” ì»¬ëŸ¼ëª…ê³¼ í–‰ ê°’ì„ ë§¤í•‘í•œ ê²ƒì…ë‹ˆë‹¤. íŠœí”Œì„ ë°˜í™˜í•˜ëŠ” ê²ƒë³´ë‹¤ ë¹„ìš©ì´ ë§ì´ ë“¤ì§€ë§Œ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ê°’ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print([row["float"] for row in df.iter_rows(named=True)])
```

```
[4.0, 5.0, 6.0, 7.0, 8.0]
```

ê¸°ë³¸ê°’ì´ ì•¡ì„¸ìŠ¤ íŒ¨í„´ì— ì í•©í•˜ì§€ ì•Šë‹¤ê³  íŒë‹¨ë˜ëŠ” ë§¤ìš° íŠ¹ì •í•œ ê²½ìš°ì—ë§Œ buffer_size ë§¤ê°œë³€ìˆ˜ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ë°˜ë³µí•˜ëŠ” ë™ì•ˆ ë‚´ë¶€ì ìœ¼ë¡œ ë²„í¼ë§ë˜ëŠ” í–‰ ìˆ˜ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. ë²„í¼ë¥¼ ì‚¬ìš©í•˜ë©´ ì†ë„ê°€ í¬ê²Œ(~2~4ë°°) í–¥ìƒë˜ë¯€ë¡œ ì´ ê°’ì„ 0ìœ¼ë¡œ ì„¤ì •í•˜ë©´ í–‰ ë²„í¼ë§ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.(ê¶Œì¥í•˜ì§€ ì•ŠìŒ)

:::div{.callout}
ë°ì´í„°ê°€ ì—´ í˜•íƒœë¡œ ì €ì¥ë˜ë¯€ë¡œ í–‰ ë°˜ë³µì€ ìµœì ì´ ì•„ë‹™ë‹ˆë‹¤. ê°€ëŠ¥í•˜ë©´ ì—´ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” export/output ë©”ì„œë“œ ì¤‘ í•˜ë‚˜ë¥¼ í†µí•´ ë‚´ë³´ë‚´ëŠ” ê²ƒì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.

:::

:::div{.callout}
iter_rows, rows, rows_by_key ë©”ì„œë“œëŠ” ns-ì •í™•ë„ ì‹œê°„ ê°’ì´ ìˆëŠ” ê²½ìš° Pythonì€ ê¸°ë³¸ì ìœ¼ë¡œ ìµœëŒ€ Î¼s-ì •í™•ë„ê¹Œì§€ë§Œ ì§€ì›í•˜ë¯€ë¡œ ns-ì •í™•ë„ ê°’ì€ Pythonìœ¼ë¡œ ë³€í™˜í•  ë•Œ ë§ˆì´í¬ë¡œì´ˆë¡œ ì˜ë¦°ë‹¤ëŠ” ì ì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ë¬¸ì œê°€ ì‚¬ìš© ì‚¬ë¡€ì— ì¤‘ìš”í•œ ê²½ìš° ë‹¤ë¥¸ í˜•ì‹(ì˜ˆ: Arrow ë˜ëŠ” NumPy)ìœ¼ë¡œ ë‚´ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤.

:::

## 5.2 DataFrameì˜ Column(ì»¬ëŸ¼, ì—´)

ë°ì´í„°í”„ë ˆì„ì˜ ì»¬ëŸ¼ì€ ê° ë°ì´í„°ì˜ ì†ì„±ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì»¬ëŸ¼ì— ëŒ€í•œ ì •ë³´ë¥¼ ì•Œê³  ì‹¶ìœ¼ë©´ `df.glimpse()`ë¥¼ ì´ìš©í•  ìˆ˜ ìˆê³  ê° ì¹¼ëŸ¼ì„ ì„ íƒí•˜ë ¤ë©´ `df[â€™ì»¬ëŸ¼ ì´ë¦„â€™]`ì„ ì´ìš©í•˜ë©´ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 5.2.1 ë°ì´í„° ì»¬ëŸ¼ëª… ì¡°íšŒ

ì»¬ëŸ¼ëª…ì„ ì¡°íšŒí•  ë•Œì—ëŠ” columns ë©”ì„œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```python
print(df.columns)
```

```
['integer', 'date', 'float', 'string']
```

ì»¬ëŸ¼ëª…ì„ ë³€ê²½í•˜ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ” ì•„ë˜ ì½”ë“œì™€ ê°™ì´ df.columnsì— ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ê°’ì„ ì£¼ì–´ ë³€ê²½í•©ë‹ˆë‹¤.

```python
df.columns = ['id', 'date', 'score', 'grade']
print(df)
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† date                â”† score â”† grade â”‚
â”‚ --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1   â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 2   â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 3   â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 4   â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 5   â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

ë˜ëŠ”, renameë¥¼ ì´ìš©í•˜ì—¬ ë”•ì…”ë„ˆë¦¬ì— keyëŠ” ì´ì „ ì»¬ëŸ¼ëª…, valueëŠ” ìƒˆë¡œìš´ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ì…ë ¥í•˜ì—¬ íŠ¹ì • ì»¬ëŸ¼ëª…ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
# df.rename({"ê¸°ì¡´ ì»¬ëŸ¼ëª…":"ìƒˆë¡œìš´ ì»¬ëŸ¼ëª…"})
print(df.rename({"id":"ì•„ì´ë””"}))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì•„ì´ë”” â”† date                â”† score â”† grade â”‚
â”‚ ---    â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64    â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1      â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 2      â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 3      â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 4      â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 5      â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df.rename({"id":"ì•„ì´ë””","date":"ë‚ ì§œ"}))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì•„ì´ë”” â”† ë‚ ì§œ                â”† score â”† grade â”‚
â”‚ ---    â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64    â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1      â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 2      â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 3      â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 4      â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 5      â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2.2 ì»¬ëŸ¼(ì—´) ì¸ë±ìŠ¤ ì¡°íšŒ

get_column_index í•¨ìˆ˜ë¡œ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ì—´ì˜ ì¸ë±ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
# df.get_column_index("ì»¬ëŸ¼ëª…")
print(df.get_column_index("date"))
```

```
1
```

### 5.2.3 ì»¬ëŸ¼(ì—´) ì´ë¦„ìœ¼ë¡œ ì¡°íšŒ

```python
print(df['id']) # ì—´ ì¡°íšŒ
print(df['id'][0])
print(df['id'][0:3])
print(df['id'][::-1])
```

```
shape: (5,)
Series: 'id' [i64]
[
	1
	2
	3
	4
	5
]
1
shape: (3,)
Series: 'id' [i64]
[
	1
	2
	3
]
shape: (5,)
Series: 'id' [i64]
[
	5
	4
	3
	2
	1
]
```

### 5.2.4 get_column

ì»¬ëŸ¼ëª…ì„ ì…ë ¥í•˜ì—¬ í•´ë‹¹ ì—´ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

```python
# df.get_column("ì»¬ëŸ¼ëª…")
print(df.get_column("id"))
```

```
shape: (5,)
Series: 'id' [i64]
[
	1
	2
	3
	4
	5
]
```

### 5.2.5 get_columns

ë°ì´í„°í”„ë ˆì„ì˜ ê° ì—´ì„ ì‹œë¦¬ì¦ˆ ë¦¬ìŠ¤íŠ¸ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.

```python
print(df.get_columns())
```

```
[shape: (5,)
Series: 'id' [i64]
[
	1
	2
	3
	4
	5
], shape: (5,)
Series: 'date' [datetime[Î¼s]]
[
	2022-01-01 00:00:00
	2022-01-02 00:00:00
	2022-01-03 00:00:00
	2022-01-04 00:00:00
	2022-01-05 00:00:00
], shape: (5,)
Series: 'score' [f64]
[
	4.0
	5.0
	6.0
	7.0
	8.0
], shape: (5,)
Series: 'grade' [str]
[
	"a"
	"b"
	"c"
	"b"
	"e"
]]
```

### 5.2.6 select, select_seq

ë°ì´í„°í”„ë ˆì„ì—ì„œ ì—´ì„ ì„ íƒí•©ë‹ˆë‹¤. select_seq í•¨ìˆ˜ëŠ” selectì™€ ë¹„ìŠ·í•˜ê²Œ ë™ì‘í•˜ì§€ë§Œ ë³‘ë ¬ì´ ì•„ë‹Œ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì—, ì‘ì—…ëŸ‰ì´ ì ì€ ê²½ìš°ì— ì‚¬ìš©í•©ë‹ˆë‹¤.

```python
# df.select("ì»¬ëŸ¼ëª…")
print(df.select("date"))
```

```
shape: (5, 1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ date                â”‚
â”‚ ---                 â”‚
â”‚ datetime[Î¼s]        â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 2022-01-01 00:00:00 â”‚
â”‚ 2022-01-02 00:00:00 â”‚
â”‚ 2022-01-03 00:00:00 â”‚
â”‚ 2022-01-04 00:00:00 â”‚
â”‚ 2022-01-05 00:00:00 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ë¦¬ìŠ¤íŠ¸ì— ì—¬ëŸ¬ê°œì˜ ì»¬ëŸ¼ëª…ì„ ì‘ì„±í•˜ì—¬ í•œë²ˆì— ì—¬ëŸ¬ ì—´ì„ ì¶œë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.select(["date", "grade"]))
```

pl.col() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì—´ì„ ì„ íƒí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
print(df.select(pl.col("date"), pl.col("grade")))
```

```
shape: (5, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ date                â”† grade â”‚
â”‚ ---                 â”† ---   â”‚
â”‚ datetime[Î¼s]        â”† str   â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 2022-01-01 00:00:00 â”† a     â”‚
â”‚ 2022-01-02 00:00:00 â”† b     â”‚
â”‚ 2022-01-03 00:00:00 â”† c     â”‚
â”‚ 2022-01-04 00:00:00 â”† b     â”‚
â”‚ 2022-01-05 00:00:00 â”† e     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

ì›í•˜ëŠ” ì»¬ëŸ¼ëª…ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.select(index=pl.col("id")))
```

```
shape: (5, 1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ index â”‚
â”‚ ---   â”‚
â”‚ i64   â”‚
â•â•â•â•â•â•â•â•â•¡
â”‚ 1     â”‚
â”‚ 2     â”‚
â”‚ 3     â”‚
â”‚ 4     â”‚
â”‚ 5     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

ì—¬ëŸ¬ ì¶œë ¥ì´ ìˆëŠ” ê²½ìš°, onfig.set_auto_structify(True)ì„ í™œì„±í™”í•˜ì—¬ Structë¡œ ìë™ ì¸ìŠ¤í„´ìŠ¤í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
with pl.Config(auto_structify=True):
    print(df.select(is_odd=(pl.col(pl.Int64)),))
```

```
shape: (5, 1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ is_odd    â”‚
â”‚ ---       â”‚
â”‚ struct[1] â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ {1}       â”‚
â”‚ {2}       â”‚
â”‚ {3}       â”‚
â”‚ {4}       â”‚
â”‚ {5}       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2.7 iter_columns

DataFrameì˜ ì—´ì— ëŒ€í•œ ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
print([s.name for s in df.iter_columns()])
```

```
['id', 'date', 'score', 'grade']
```

ë°ì´í„°í”„ë ˆì„ì˜ ì—´ì„ ìˆ˜ì •í•˜ëŠ” ê²½ìš°

```python
print(pl.DataFrame(column * 2 for column in df[['id','score']].iter_columns()))
```

ë§Œì•½, all()ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ë©´ all()ì´ ë” íš¨ìœ¨ì ì…ë‹ˆë‹¤.

```python
print(df[['id','score']].select(pl.all() * 2))
```

```
shape: (5, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† score â”‚
â”‚ --- â”† ---   â”‚
â”‚ i64 â”† f64   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 2   â”† 8.0   â”‚
â”‚ 4   â”† 10.0  â”‚
â”‚ 6   â”† 12.0  â”‚
â”‚ 8   â”† 14.0  â”‚
â”‚ 10  â”† 16.0  â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2.8 insert_column

ì›í•˜ëŠ” ì—´ ì¸ë±ìŠ¤ ìœ„ì¹˜ì— ì‹œë¦¬ì¦ˆë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
s = pl.Series("age",[10,20,30,40,50])
# df.insert_column("ì¸ë±ìŠ¤","ì‹œë¦¬ì¦ˆ")
print(df.insert_column(1,s))
```

```
shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1   â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 2   â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 3   â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 4   â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 5   â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

ì»¬ëŸ¼ëª…ì´ ìˆëŠ” ì‹œë¦¬ì¦ˆë¥¼ ì¶”ê°€í•˜ë ¤ëŠ” ê²½ìš° ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.

```python
s = pl.Series("age",[10,20,30,40,50])
print(df.insert_column(1,s))
```

```
DuplicateError: column with name "age" is already present in the DataFrame
```

### 5.2.9 with_columns, with_columns_seq

ë°ì´í„°í”„ë ˆì„ì˜ ê¸°ì¡´ ì—´ì„ ë³€ê²½í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ì—´ì„ ì¶”ê°€í•©ë‹ˆë‹¤. í‘œí˜„ì‹ì˜ ì‘ì—…ëŸ‰ì´ ì ì€ ê²½ìš°ì—ëŠ” with_columns_seqë¥¼ ì‚¬ìš©í•˜ì—¬ ë³‘ë ¬ë¡œ ì‹¤í–‰ë˜ì§€ ì•Šê³  ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë˜ë„ë¡ í•©ë‹ˆë‹¤.

```python
print(df.with_columns((pl.col("age")**2).alias("age^2")))
```

```
shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† age â”† date                â”† score â”† grade â”† age^2 â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”† i64   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1   â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”† 100   â”‚
â”‚ 2   â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”† 400   â”‚
â”‚ 3   â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”† 900   â”‚
â”‚ 4   â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”† 1600  â”‚
â”‚ 5   â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”† 2500  â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

ê¸°ì¡´ì˜ ì—´ê³¼ ì¶”ê°€ëœ ì—´ì˜ ì´ë¦„ì´ ê°™ì€ ê²½ìš° ê¸°ì¡´ ì—´ì„ ìƒˆë¡œìš´ ì—´ì˜ ê°’ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.

```python
print(df.with_columns(pl.col("age").cast(pl.Float64)))
```

```
shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† age  â”† date                â”† score â”† grade â”‚
â”‚ --- â”† ---  â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† f64  â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1   â”† 10.0 â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 2   â”† 20.0 â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 3   â”† 30.0 â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 4   â”† 40.0 â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 5   â”† 50.0 â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

```

ì‰¼í‘œ(,)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì—´ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(
    df.with_columns(
        (pl.col("age") ** 2).alias("age^2"),
        (pl.col("age") / 2).alias("age/2"),
        (pl.col("age") // 2).alias("age//2"),
    )
)
```

ë¦¬ìŠ¤íŠ¸ë¡œ ì „ë‹¬í•˜ì—¬ ì—¬ëŸ¬ ì—´ì„ ì¶”ê°€í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
print(
    df.with_columns(
        [
            (pl.col("age") ** 2).alias("age^2"),
            (pl.col("age") / 2).alias("age/2"),
            (pl.col("age") // 2).alias("age//2"),
        ]
    )
)
```

```
shape: (5, 8)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† age â”† date                â”† score â”† grade â”† age^2 â”† age/2 â”† age//2 â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”† ---   â”† ---   â”† ---    â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”† i64   â”† f64   â”† i64    â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1   â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”† 100   â”† 5.0   â”† 5      â”‚
â”‚ 2   â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”† 400   â”† 10.0  â”† 10     â”‚
â”‚ 3   â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”† 900   â”† 15.0  â”† 15     â”‚
â”‚ 4   â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”† 1600  â”† 20.0  â”† 20     â”‚
â”‚ 5   â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”† 2500  â”† 25.0  â”† 25     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ì—´ì„ ì¶”ê°€í•  ë•Œ, í‚¤ì›Œë“œ ì¸ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‰½ê²Œ ì»¬ëŸ¼ëª…ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(
    df.with_columns(
        # ì»¬ëŸ¼ëª…=ì‹
        score_a=pl.col("age") * pl.col("score"),
        date2=pl.col("date").cast(pl.Date),
    )
)
```

```
shape: (5, 7)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† age â”† date                â”† score â”† grade â”† score_a â”† date2      â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”† ---     â”† ---        â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”† f64     â”† date       â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1   â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”† 40.0    â”† 2022-01-01 â”‚
â”‚ 2   â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”† 100.0   â”† 2022-01-02 â”‚
â”‚ 3   â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”† 180.0   â”† 2022-01-03 â”‚
â”‚ 4   â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”† 280.0   â”† 2022-01-04 â”‚
â”‚ 5   â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”† 400.0   â”† 2022-01-05 â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ì—¬ëŸ¬ ì¶œë ¥ì´ ìˆëŠ” ê²½ìš°, Config.set_auto_structify(True): ì„¤ì •ì„ í™œì„±í™”í•˜ì—¬ Structë¡œ ìë™ ì¸ìŠ¤í„´ìŠ¤í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
with pl.Config(auto_structify=True):
    print(
        df.with_columns(
            c=pl.col(["id", "age"]),
        )
    )
```

```
shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† age â”† date                â”† score â”† grade â”† c         â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”† ---       â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”† struct[2] â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1   â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”† {1,10}    â”‚
â”‚ 2   â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”† {2,20}    â”‚
â”‚ 3   â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”† {3,30}    â”‚
â”‚ 4   â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”† {4,40}    â”‚
â”‚ 5   â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”† {5,50}    â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

:::div{.callout}
with_columnsë¥¼ ì‚¬ìš©í•˜ë©´ ìƒˆë¡œìš´ ë°ì´í„° í”„ë ˆì„ì´ ë°˜í™˜ë©ë‹ˆë‹¤. ì´ë•Œ, ë©”ëª¨ë¦¬ ì¸¡ë©´ì—ì„œ ê¸°ì¡´ ë°ì´í„° í”„ë ˆì„ì˜ ìƒˆ ë³µì‚¬ë³¸ì„ ìƒì„±í•˜ì§€ ì•Šê³  ê¸°ì¡´ ë°ì´í„°í”„ë ˆì„ì—ì„œ ì—´ë§Œ ìƒˆë¡œ ì¶”ê°€í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë°ì´í„° ë³µì‚¬ë¥¼ í”¼í•©ë‹ˆë‹¤. ì´ëŠ” ë©”ëª¨ë¦¬ ì‚¬ìš©ì„ ìµœì†Œí™”í•˜ê³  ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.
Polarsì˜ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ë³´ë©´ ë¶ˆë³€ ë°ì´í„° í”„ë ˆì„ì„ ì‚¬ìš©í•˜ë©°, ìƒˆë¡œìš´ ë°ì´í„° í”„ë ˆì„ì„ ë§Œë“¤ ë•Œ ê¸°ì¡´ ë°ì´í„°ë¥¼ ê³µìœ í•  ìˆ˜ ìˆëŠ” ë°©ì‹ìœ¼ë¡œ ì„¤ê³„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë°ì´í„° í”„ë ˆì„ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ìƒˆ ì—´ì„ ì¶”ê°€í•˜ë”ë¼ë„, ì „ì²´ ë°ì´í„° í”„ë ˆì„ì„ ë³µì‚¬í•˜ì§€ ì•Šê³  í•„ìš”í•œ ë¶€ë¶„ë§Œ ì²˜ë¦¬í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„° í”„ë ˆì„ì„ ìƒì„±í•©ë‹ˆë‹¤.

:::

### 5.2.10 replace_column

ì¸ë±ìŠ¤ ìœ„ì¹˜ì— ìˆëŠ” ì—´ ì „ì²´ë¥¼ ì‹œë¦¬ì¦ˆ ê°’ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.

```python
s = pl.Series("a", [10, 20, 30, 40, 50])
# df.replace_column("ì—´ ì¸ë±ìŠ¤", "ëŒ€ì²´í•  ì‹œë¦¬ì¦ˆ")
print(df.replace_column(0, s))
```

```
shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2.11 with_row_index

ë°ì´í„°í”„ë ˆì„ì˜ ì²« ë²ˆì§¸ ì—´ì— í–‰ ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì¸ë±ìŠ¤ ì—´ì˜ íƒ€ì…ì€ ì •ìˆ˜í˜•ì…ë‹ˆë‹¤.

```python
print(df.with_row_index())
```

```
shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ index â”† a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ ---   â”† --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ u32   â”† i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 0     â”† 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 1     â”† 20  â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 2     â”† 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 3     â”† 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 4     â”† 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

ì¸ë±ìŠ¤ ì—´ì˜ ì»¬ëŸ¼ëª…ì„ ì„¤ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
# df.with_row_index("ì¸ë±ìŠ¤ ì—´ ì»¬ëŸ¼ëª…")
print(df.with_row_index("id"))
```

```
shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ u32 â”† i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 0   â”† 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 1   â”† 20  â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 2   â”† 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 3   â”† 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 4   â”† 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

offsetì„ 1000ìœ¼ë¡œ ì„¤ì •í•˜ë©´ 1000ë¶€í„° ì¸ë±ìŠ¤ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤. offsetì€ ìŒìˆ˜ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

```python
print(df.with_row_index("id", offset=1000))
```

```
shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id   â”† a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ ---  â”† --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ u32  â”† i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1000 â”† 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 1001 â”† 20  â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 1002 â”† 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 1003 â”† 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 1004 â”† 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

int_range() ë° len() ì„ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ ì¸ë±ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
print(
    df.select(
        pl.int_range(pl.len(), dtype=pl.UInt32).alias("index"),
        pl.all(),
    )
)
```

```
shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ index â”† a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ ---   â”† --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ u32   â”† i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 0     â”† 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 1     â”† 20  â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 2     â”† 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 3     â”† 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 4     â”† 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5.3 DataFrameì˜ Data(ë°ì´í„°)

### 5.3.1 ë°ì´í„° ì¡°íšŒ

í–‰, ì—´ì„ ë‘˜ ë‹¤ ë°˜ì˜í•œ ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
print(df[0,'a']) # í–‰, ì—´
print(df[0,2])
print(df['a','score'])
```

```
10
2022-01-01 00:00:00
shape: (5, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† score â”‚
â”‚ --- â”† ---   â”‚
â”‚ i64 â”† f64   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 4.0   â”‚
â”‚ 20  â”† 5.0   â”‚
â”‚ 30  â”† 6.0   â”‚
â”‚ 40  â”† 7.0   â”‚
â”‚ 50  â”† 8.0   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

`df[0, 'a']`ëŠ” row(í–‰) ë°ì´í„°ì˜ ì¸ë±ìŠ¤ ì¤‘ 0 ë²ˆì§¸ í–‰ì„ ì„ íƒí•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤. ê·¸ í–‰ì˜ ê°’ ì¤‘ â€œaâ€ column(ì»¬ëŸ¼, ì—´)ì„ ê°€ì§€ëŠ” ê°’ë§Œ ê°€ì§€ê³  ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 5.3.2 item

íŠ¹ì • ë°ì´í„°í”„ë ˆì„ì˜ ê°’ì„ ìŠ¤ì¹¼ë¼ë¡œ ë°˜í™˜í•˜ê±°ë‚˜ ì£¼ì–´ì§„ í–‰/ì—´ì— ìˆëŠ” ìš”ì†Œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. í–‰/ì—´ì´ ì œê³µë˜ì§€ ì•Šì€ ê²½ìš°, ì´ëŠ” df[0,0]ê³¼ ê°™ìœ¼ë©°, ëª¨ì–‘ì´ (1,1)ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤. í–‰/ì—´ì„ ì‚¬ìš©í•˜ë©´ df[í–‰,ì—´]ê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
print(df.select((pl.col("score")).sum()).item())
```

```
30.0
```

```python
# df.item(í–‰ ì¸ë±ìŠ¤, ì—´ ì¸ë±ìŠ¤)
print(df.item(1, 2))
```

```
2022-01-02 00:00:00
```

```python
# df.item(í–‰ ì¸ë±ìŠ¤, ì»¬ëŸ¼ëª…)
print(df.item(2, "score"))
```

```
6.0
```

### 5.3.3 ë°ì´í„° ê°’ ë³€ê²½í•˜ê¸°

í–‰, ì—´ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ìœ„ì¹˜ì— ìˆëŠ” ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df[1,1] = 3
print(df)
```

```
shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 3   â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

ë‹¤ì‹œ ì›ë˜ëŒ€ë¡œ ëŒë ¤ë†“ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```python
df[1,1] = 20
print(df)
```

```
shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3.4 clone

ë°ì´í„°í”„ë ˆì„ì„ ë³µì‚¬í•  ë•Œ, `df_copy=df` ì™€ ê°™ì´ ë³µì‚¬í•˜ê²Œ ë˜ë©´ ê°™ì€ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤. ì•„ë˜ ì½”ë“œë¥¼ ë³´ë©´ df_copyì˜ ê°’ì„ 3ìœ¼ë¡œ ë°”ê¾¸ì—ˆëŠ”ë° dfë„ ê°’ì´ ë°”ë€ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df_copy = df
df_copy[1,1] = 3
print("df",df)
print("df_copy",df_copy)
```

```
df shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 3   â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
df_copy shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 3   â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

ë‹¤ì‹œ ì›ë˜ ê°’ìœ¼ë¡œ ë³€ê²½í•œ ë’¤, clone í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```python
df_copy[1,1] = 20
print(df)
```

```
shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

cloneì„ í•˜ë©´ ë°ì´í„°í”„ë ˆì„ì˜ ë³µì‚¬ë³¸ì„ ë§Œë“­ë‹ˆë‹¤. ì´ë•Œ ë‘ ë°ì´í„°í”„ë ˆì„ì€ ë‹¤ë¥¸ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ê°€ì§€ë¯€ë¡œ df_copy ê°’ì„ ë°”ê¿”ë„ dfì— ì ìš©ë˜ì§€ ì•ŠëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df_copy = df.clone()
df_copy[1,1] = 3
print("df",df)
print("df_copy",df_copy)
```

```
df shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
df_copy shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 3   â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

:::div{.callout}
ë°ì´í„° ë¶„ì„ ì‹œ, ì›ë³¸ ë°ì´í„°ëŠ” ê±°ì˜ ê±´ë“¤ì´ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. clone()ì„ ì´ìš©í•´ì„œ ë°ì´í„° í”„ë ˆì„ ë³µì‚¬ í›„ ë¶„ì„í•˜ì‹œëŠ” ê²ƒì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.

:::

## 5.4 ë°ì´í„° ìƒì„±

```python
%%writefile rawData.csv
ì‚¬ì›ë²ˆí˜¸,ì—°ì°¨,ì…ì‚¬ì—°ë„,ë§¤ì¶œ,ìˆœìµ
110,1,2015,1000000,100001
109,2,2016,2000000,200001
108,3,2017,3000000,300001
107,4,2018,4000000,400001
106,5,2019,8000000,800001
107,6,2020,16000000,1600001
```

```
Overwriting rawData.csv
```

## 5.5 ë°ì´í„° ì½ê¸°

CSV íŒŒì¼ ë°ì´í„°ë¥¼ ì½ì–´ì˜µë‹ˆë‹¤.

```python
print(pl.read_csv('rawData.csv'))
```

```
shape: (6, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‚¬ì›ë²ˆí˜¸ â”† ì—°ì°¨ â”† ì…ì‚¬ì—°ë„ â”† ë§¤ì¶œ     â”† ìˆœìµ    â”‚
â”‚ ---      â”† ---  â”† ---      â”† ---      â”† ---     â”‚
â”‚ i64      â”† i64  â”† i64      â”† i64      â”† i64     â”‚
â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•¡
â”‚ 110      â”† 1    â”† 2015     â”† 1000000  â”† 100001  â”‚
â”‚ 109      â”† 2    â”† 2016     â”† 2000000  â”† 200001  â”‚
â”‚ 108      â”† 3    â”† 2017     â”† 3000000  â”† 300001  â”‚
â”‚ 107      â”† 4    â”† 2018     â”† 4000000  â”† 400001  â”‚
â”‚ 106      â”† 5    â”† 2019     â”† 8000000  â”† 800001  â”‚
â”‚ 107      â”† 6    â”† 2020     â”† 16000000 â”† 1600001 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

# 6. ë°ì´í„° ì‚­ì œ

ë°ì´í„°í”„ë ˆì„ì—ì„œ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.

## 6.1 drop

`drop` í•¨ìˆ˜ëŠ” ë°ì´í„°í”„ë ˆì„ì—ì„œ ì§€ì •í•œ ì—´(ì»¬ëŸ¼)ì„ ì‚­ì œí•  ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

```python
# drop(â€™ì»¬ëŸ¼ëª…â€™)
print(df.drop('a'))
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

`df.drop('a')`ì„ ì´ìš©í•´ â€˜aâ€™ ì—´ì„ ì‚­ì œí•˜ì˜€ìŠµë‹ˆë‹¤. ë§Œì•½ ì›ë³¸ì— ë°˜ì˜í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ì‹œ df ë³€ìˆ˜ì— ì €ì¥í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. ì‹¤ìŠµ ì§„í–‰ì„ ìœ„í•´ ì‹¤í–‰ì‹œí‚¤ì§€ ì•Šë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```python
# df = df.drop('a')
# print(df)
```

ì—¬ëŸ¬ ì»¬ëŸ¼ëª…ì„ ì—°ë‹¬ì•„ ì‘ì„±í•˜ì—¬ ì „ë‹¬í•˜ê±°ë‚˜ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ì „ë‹¬í•˜ì—¬ ì—¬ëŸ¬ê°œì˜ ì»¬ëŸ¼ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.drop('a','score'))
# print(df.drop(['a','score']))
```

```
shape: (5, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ age â”† date                â”† grade â”‚
â”‚ --- â”† ---                 â”† ---   â”‚
â”‚ i64 â”† datetime[Î¼s]        â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 2022-01-01 00:00:00 â”† a     â”‚
â”‚ 20  â”† 2022-01-02 00:00:00 â”† b     â”‚
â”‚ 30  â”† 2022-01-03 00:00:00 â”† c     â”‚
â”‚ 40  â”† 2022-01-04 00:00:00 â”† b     â”‚
â”‚ 50  â”† 2022-01-05 00:00:00 â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

polars ì…€ë ‰í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ê°œì˜ ìˆ«ìí˜• ì»¬ëŸ¼ë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
import polars.selectors as cs

print(df.drop(cs.numeric()))
```

```
shape: (5, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ date                â”† grade â”‚
â”‚ ---                 â”† ---   â”‚
â”‚ datetime[Î¼s]        â”† str   â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 2022-01-01 00:00:00 â”† a     â”‚
â”‚ 2022-01-02 00:00:00 â”† b     â”‚
â”‚ 2022-01-03 00:00:00 â”† c     â”‚
â”‚ 2022-01-04 00:00:00 â”† b     â”‚
â”‚ 2022-01-05 00:00:00 â”† e     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6.2 drop_in_place

ë‹¨ì¼ ì—´ì„ drop í›„ ì›ë³¸ì— ë°˜ì˜í•œ ë’¤, ì‚­ì œëœ ì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
print(df.drop_in_place('a'))
```

```
shape: (5,)
Series: 'a' [i64]
[
	10
	20
	30
	40
	50
]
```

```python
print(df)
```

```
shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ age â”† date                â”† score â”† grade â”‚
â”‚ --- â”† ---                 â”† ---   â”† ---   â”‚
â”‚ i64 â”† datetime[Î¼s]        â”† f64   â”† str   â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 10  â”† 2022-01-01 00:00:00 â”† 4.0   â”† a     â”‚
â”‚ 20  â”† 2022-01-02 00:00:00 â”† 5.0   â”† b     â”‚
â”‚ 30  â”† 2022-01-03 00:00:00 â”† 6.0   â”† c     â”‚
â”‚ 40  â”† 2022-01-04 00:00:00 â”† 7.0   â”† b     â”‚
â”‚ 50  â”† 2022-01-05 00:00:00 â”† 8.0   â”† e     â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6.3 clear

ë™ì¼í•œ ì»¬ëŸ¼ëª…ì„ ê°€ì§„ ë°ì´í„°ê°€ ì—†ê±°ë‚˜(n=0) ní–‰ì´ nullë¡œ ì±„ì›Œì§„(n>0) í˜„ì¬ ë°ì´í„° í”„ë ˆì„ì˜ ë¹ˆ ë³µì‚¬ë³¸ì„ ë§Œë“­ë‹ˆë‹¤.

```python
print(df2)
```

```
shape: (2, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ col1 â”† col2 â”‚
â”‚ ---  â”† ---  â”‚
â”‚ f32  â”† i64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 1.0  â”† 3    â”‚
â”‚ 2.0  â”† 4    â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df2.clear())
```

```
shape: (0, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ col1 â”† col2 â”‚
â”‚ ---  â”† ---  â”‚
â”‚ f32  â”† i64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

nì€ ì§€ì›Œì§„ ë°ì´í„°í”„ë ˆì„ì—ì„œ nullë¡œ ì±„ì›Œì§„ í–‰ì˜ ìˆ˜ë¡œ ë°ì´í„°í”„ë ˆì„ì˜ í˜„ì¬ í–‰ ìˆ˜ë³´ë‹¤ í´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df2.clear(n=2))
```

```
shape: (2, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ col1 â”† col2 â”‚
â”‚ ---  â”† ---  â”‚
â”‚ f32  â”† i64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ null â”† null â”‚
â”‚ null â”† null â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

# 7. ê²°ì¸¡ì¹˜ ì²˜ë¦¬

## 7.1 ê²°ì¸¡ê°’ ì¶”ê°€

null ê°’ì„ ì¶”ê°€í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```python
df_null = pl.DataFrame({
    'ì´ë¦„': ['A', 'B', None],
    'ë‚˜ì´': [25, 35, None],
    'ì„±ë³„': ['ë‚¨', 'ì—¬', 'ë‚¨'],
    'í•™ì ': [4.5, 4.0, None],
    'ì£¼ì†Œ': [None, 'jeju', None],
})

print(df_null)
```

```
shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ A    â”† 25   â”† ë‚¨   â”† 4.5  â”† null â”‚
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”† jeju â”‚
â”‚ null â”† null â”† ë‚¨   â”† null â”† null â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

ë°ì´í„° ê°’ ì¶”ê°€í–ˆë˜ ê²ƒê³¼ ê°™ì´ None ê°’ì„ ë„£ì–´ì¤ë‹ˆë‹¤.

```python
df_null[2,'ì„±ë³„'] = None
print(df_null)
```

```
shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ A    â”† 25   â”† ë‚¨   â”† 4.5  â”† null â”‚
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”† jeju â”‚
â”‚ null â”† null â”† null â”† null â”† null â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

ì´ë²ˆì—ëŠ” NaN ê°’ì„ ì¶”ê°€í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```python
df_nan = pl.DataFrame({
    'ì´ë¦„': ['A', 'B', 'C'],
    'ë‚˜ì´': [25, 35, 40],
    'ì„±ë³„': ['ë‚¨', 'ì—¬', 'ë‚¨'],
    'í•™ì ': [4.5, 4.0, np.nan],
    'ì£¼ì†Œ': ['seoul', 'jeju', 'busan'],
})

print(df_nan)
```

- np.nan: NaNìœ¼ë¡œ ê°’ì„ ì±„ì›€

```
shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ  â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---   â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str   â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ A    â”† 25   â”† ë‚¨   â”† 4.5  â”† seoul â”‚
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”† jeju  â”‚
â”‚ C    â”† 40   â”† ë‚¨   â”† NaN  â”† busan â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

ì•„ë˜ì™€ ê°™ì´ ê°’ì„ NaNìœ¼ë¡œ ë³€ê²½í•  ê²½ìš° NaNê°’ì´ ì•„ë‹Œ, null ê°’ì´ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤. ì´ëŠ” NaNì´ ì‹¤ìˆ˜í˜•ì´ê¸° ë•Œë¬¸ì— íƒ€ì…ì´ ë§ì§€ ì•Šì•„ null ê°’ìœ¼ë¡œ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤.

```python
df_nan[1,1] = np.nan
print(df_nan)
```

```
shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ  â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---   â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str   â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ A    â”† 25   â”† ë‚¨   â”† 4.5  â”† seoul â”‚
â”‚ B    â”† null â”† ì—¬   â”† 4.0  â”† jeju  â”‚
â”‚ C    â”† 40   â”† ë‚¨   â”† NaN  â”† busan â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

NaN ê°’ì„ ì¶”ê°€í•  ë•ŒëŠ” ë¨¼ì € ì‹¤ìˆ˜í˜•ìœ¼ë¡œ ìë£Œí˜•ì„ ë³€ê²½í•œ ë’¤, NaNê°’ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.

```python
df_nan = df_nan.cast({'ë‚˜ì´':pl.Float32})
df_nan[1,1] = np.nan
print(df_nan)
```

```
shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ  â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---   â”‚
â”‚ str  â”† f32  â”† str  â”† f64  â”† str   â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ A    â”† 25.0 â”† ë‚¨   â”† 4.5  â”† seoul â”‚
â”‚ B    â”† NaN  â”† ì—¬   â”† 4.0  â”† jeju  â”‚
â”‚ C    â”† 40.0 â”† ë‚¨   â”† NaN  â”† busan â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7.2 ê²°ì¸¡ì¹˜ í™•ì¸

`null_count`ëŠ” ë°ì´í„°ì— ì—´ë³„ë¡œ null ê°’ì˜ ê°œìˆ˜ê°€ ëª‡ê°œ ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df_null.null_count()) # ê²°ì¸¡ê°’ ê°œìˆ˜ í™•ì¸
```

```
shape: (1, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ u32  â”† u32  â”† u32  â”† u32  â”† u32  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 1    â”† 1    â”† 1    â”† 1    â”† 2    â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

## 7.3 ê²°ì¸¡ì¹˜ ì²˜ë¦¬

### 7.3.1 ê²°ì¸¡ì¹˜ ì‚­ì œ(drop_nulls)

`drop_nulls` í•¨ìˆ˜ëŠ” ë°ì´í„°í”„ë ˆì„ì—ì„œ ê²°ì¸¡ê°’(null)ì„ í¬í•¨í•œ í–‰ì„ ì‚­ì œí•  ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

```python
print(df_null.drop_nulls())
```

```
shape: (1, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”† jeju â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

subset ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ polars ì…€ë ‰í„°ë¡œ ë°ì´í„° íƒ€ì…ì´ ë¬¸ìì—´ì¸ ì—´ì´ê³  nullì´ ìˆëŠ” ê²½ìš° í–‰ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—†ìŒ(ê¸°ë³¸ê°’)ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ëª¨ë“  ì—´ì— ìˆëŠ” ê²°ì¸¡ê°’ì„ í™•ì¸í•˜ê³  í•´ë‹¹ í–‰ì„ ì‚­ì œí•©ë‹ˆë‹¤.

```python
print(df_null.drop_nulls(subset=cs.string()))
```

```
shape: (1, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”† jeju â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

ëª¨ë“  í–‰ì´ nullì¸ ê²½ìš°, í•´ë‹¹ í–‰ì„ ì‚­ì œí•©ë‹ˆë‹¤.

```python
print(df_null.filter(~pl.all_horizontal(pl.all().is_null())))
```

```
shape: (2, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ A    â”† 25   â”† ë‚¨   â”† 4.5  â”† null â”‚
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”† jeju â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

ëª¨ë“  ì—´ì´ nullì¸ ê²½ìš°, í•´ë‹¹ ì—´ì„ ì‚­ì œí•©ë‹ˆë‹¤.

```python
df_null[1,'ì£¼ì†Œ'] = None
print(df_null)
```

```
shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ A    â”† 25   â”† ë‚¨   â”† 4.5  â”† null â”‚
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”† null â”‚
â”‚ null â”† null â”† null â”† null â”† null â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df_null[[s.name for s in df_null if not (s.null_count() == df_null.height)]])
```

```
shape: (3, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ A    â”† 25   â”† ë‚¨   â”† 4.5  â”‚
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”‚
â”‚ null â”† null â”† null â”† null â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3.2 ê²°ì¸¡ì¹˜ ì±„ìš°ê¸°(fill_null, fill_nan)

fill_nullì„ ì‚¬ìš©í•˜ì—¬ ì§€ì •ëœ ê°’ì´ë‚˜ ì–´ë–¤ ê°’ì„ ì±„ìš¸ì§€ ì „ëµì„ ì„¸ì›Œ null ê°’ì„ ì±„ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- value : null ê°’ ëŒ€ì‹  ì±„ìš¸ ê°’
- strategy : null ê°’ì„ ì±„ìš°ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì „ëµ
  - None(ê¸°ë³¸ê°’), forward, backward, min, max, mean, 0, 1
- limit : strategyì—ì„œ 'forward' ë˜ëŠ” 'backward'ë¥¼ ì‚¬ìš©í•  ë•Œ ì—°ì†ìœ¼ë¡œ ì±„ìš¸ null ê°’ì˜ ê°œìˆ˜
- matches_supertype : ì±„ìš¸ ê°’ì˜ íƒ€ì…ì´ ë‹¤ë¥¼ ê²½ìš°, ì±„ìš¸ ê°’ì˜ íƒ€ì…ê³¼ ì¼ì¹˜í•˜ë„ë¡ ì—´ì˜ íƒ€ì…ì„ ì±„ìš¸ ê°’ì˜ íƒ€ì…ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ Trueì´ë©°, Falseë¡œ ì„¤ì •í•  ê²½ìš° íƒ€ì…ì´ ë§ëŠ” ì—´ì—ë§Œ ê°’ì´ ì±„ì›Œì§€ë©°, íƒ€ì…ì´ ë§ì§€ ì•Šì€ ì—´ì€ nullì„ ì¶œë ¥í•˜ê²Œ ë©ë‹ˆë‹¤.

```python
print(df_null.fill_null(99))
```

```
shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---  â”‚
â”‚ str  â”† i64  â”† str  â”† f64  â”† str  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ A    â”† 25   â”† ë‚¨   â”† 4.5  â”† null â”‚
â”‚ B    â”† 35   â”† ì—¬   â”† 4.0  â”† null â”‚
â”‚ null â”† 99   â”† null â”† 99.0 â”† null â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df_null['ë‚˜ì´','í•™ì '].fill_null(strategy="max"))
```

```
shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ë‚˜ì´ â”† í•™ì  â”‚
â”‚ ---  â”† ---  â”‚
â”‚ i64  â”† f64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 25   â”† 4.5  â”‚
â”‚ 35   â”† 4.0  â”‚
â”‚ 35   â”† 4.5  â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df_null['ë‚˜ì´','í•™ì '].fill_null(strategy="zero"))
```

```
shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ë‚˜ì´ â”† í•™ì  â”‚
â”‚ ---  â”† ---  â”‚
â”‚ i64  â”† f64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 25   â”† 4.5  â”‚
â”‚ 35   â”† 4.0  â”‚
â”‚ 0    â”† 0.0  â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df_null['ë‚˜ì´','í•™ì '].fill_null(strategy="forward"))
```

```
shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ë‚˜ì´ â”† í•™ì  â”‚
â”‚ ---  â”† ---  â”‚
â”‚ i64  â”† f64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 25   â”† 4.5  â”‚
â”‚ 35   â”† 4.0  â”‚
â”‚ 35   â”† 4.0  â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df_null['ë‚˜ì´','í•™ì '].fill_null(strategy="forward", limit=1))
```

```
shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ë‚˜ì´ â”† í•™ì  â”‚
â”‚ ---  â”† ---  â”‚
â”‚ i64  â”† f64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 25   â”† 4.5  â”‚
â”‚ 35   â”† 4.0  â”‚
â”‚ 35   â”† 4.0  â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df_null['ë‚˜ì´','í•™ì '].fill_null(9.9, matches_supertype=True))
```

```
shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ë‚˜ì´ â”† í•™ì  â”‚
â”‚ ---  â”† ---  â”‚
â”‚ f64  â”† f64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 25.0 â”† 4.5  â”‚
â”‚ 35.0 â”† 4.0  â”‚
â”‚ 9.9  â”† 9.9  â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df_null['ë‚˜ì´','í•™ì '].fill_null(9.9, matches_supertype=False))
```

```
shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ë‚˜ì´ â”† í•™ì  â”‚
â”‚ ---  â”† ---  â”‚
â”‚ i64  â”† f64  â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 25   â”† 4.5  â”‚
â”‚ 35   â”† 4.0  â”‚
â”‚ null â”† 9.9  â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

fill_nanì„ ì‚¬ìš©í•˜ì—¬ ë¶€ë™ ì†Œìˆ˜ì  NaN ê°’ì„ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ì±„ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df_nan.fill_nan(3.5))
```

```
shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„ â”† ë‚˜ì´ â”† ì„±ë³„ â”† í•™ì  â”† ì£¼ì†Œ  â”‚
â”‚ ---  â”† ---  â”† ---  â”† ---  â”† ---   â”‚
â”‚ str  â”† f32  â”† str  â”† f64  â”† str   â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ A    â”† 25.0 â”† ë‚¨   â”† 4.5  â”† seoul â”‚
â”‚ B    â”† 3.5  â”† ì—¬   â”† 4.0  â”† jeju  â”‚
â”‚ C    â”† 40.0 â”† ë‚¨   â”† 3.5  â”† busan â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

:::div{.callout}
ë¶€ë™ì†Œìˆ˜ì  NaN(ìˆ«ì ì•„ë‹˜)ì€ ëˆ„ë½ëœ ê°’ì´ ì•„ë‹ˆë¼ëŠ” ì ì— ìœ ì˜í•˜ì…”ì•¼ í•©ë‹ˆë‹¤. ëˆ„ë½ëœ ê°’ì„ ëŒ€ì²´í•˜ë ¤ë©´ fill_null()ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

:::

# 8. ë°ì´í„° í•„í„°

### filter

í•˜ë‚˜ ì´ìƒì˜ ì¡°ê±´ì„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°í”„ë ˆì„ì˜ í–‰ì„ í•„í„°ë§í•©ë‹ˆë‹¤. í•„í„°ë§ ê²°ê³¼ëŠ” ë…¼ë¦¬í˜•(True, Fasle) ì‹œë¦¬ì¦ˆë¡œ Trueë¡œ ë°˜í™˜ëœ í–‰ì€ í–‰ì˜ ìˆœì„œëŠ” ê¸°ì¡´ ë°ì´í„°í”„ë ˆì„ê³¼ ê°™ì€ ìˆœì„œëŒ€ë¡œ ìœ ì§€ë˜ë©°, Falseë¡œ ë°˜í™˜ëœ í–‰ì€ nullì„ í¬í•¨í•˜ì—¬ ì‚­ì œë©ë‹ˆë‹¤.

```python
df = pl.DataFrame(
    {
        "foo": [1, 2, 3],
        "bar": [6, 7, 8],
        "ham": ["a", "b", "c"],
    }
)
```

```python
# df.filter(í•„í„°ë§ í•  ì¡°ê±´)
print(df.filter(pl.col("foo") > 1))
```

```
shape: (2, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ foo â”† bar â”† ham â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† i64 â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 2   â”† 7   â”† b   â”‚
â”‚ 3   â”† 8   â”† c   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

ì¡°ê±´ì„ ì—¬ëŸ¬ê°œ ë‘ê³  ì‹¶ì€ ê²½ìš°, `&(and, ê·¸ë¦¬ê³ ) ì—°ì‚°ì`, `|(or, ë˜ëŠ”) ì—°ì‚°ì`ì™€ ê²°í•©í•˜ì—¬ í•„í„°ë§ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df.filter((pl.col("foo") < 3) & (pl.col("ham") == "a"))
```

```
shape: (1, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ foo â”† bar â”† ham â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† i64 â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† 6   â”† a   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

```python
df.filter((pl.col("foo") == 1) | (pl.col("ham") == "c"))
```

```
shape: (2, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ foo â”† bar â”† ham â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† i64 â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† 6   â”† a   â”‚
â”‚ 3   â”† 8   â”† c   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

ì‰¼í‘œ(,)ë¡œ ì—°ê²°í•˜ì—¬ & ì—°ì‚°ìì™€ ê°™ì´ ì—¬ëŸ¬ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” í–‰ì„ ì¶œë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df.filter(
    pl.col("foo") <= 2,
    ~pl.col("ham").is_in(["b", "c"]),
)
```

```
shape: (1, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ foo â”† bar â”† ham â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† i64 â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† 6   â”† a   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

`ì»¬ëŸ¼ëª… = ê°’`ìœ¼ë¡œ ì—´ì„ í•„í„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. pl.col(name).eq(value)ì™€ ë™ì¼í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.

```python
df.filter(foo=2, ham="b")
```

```
shape: (1, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ foo â”† bar â”† ham â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† i64 â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 2   â”† 7   â”† b   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

### is_duplicated

ë°ì´í„° í”„ë ˆì„ì—ì„œ ì¤‘ë³µëœ ëª¨ë“  í–‰ì˜ bool ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

```python
df = pl.DataFrame(
    {
        "a": [1, 2, 3, 1],
        "b": ["x", "y", "z", "x"],
        "c": ["b", "b", "b", "b"],
    }
)

print(df)
```

```python
shape: (4, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† str â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† a   â”† b   â”‚
â”‚ 2   â”† a   â”† b   â”‚
â”‚ 3   â”† a   â”† b   â”‚
â”‚ 1   â”† a   â”† b   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

```python
df.is_duplicated()
shape: (4,)
Series: '' [bool]
[
        true
        false
        false
        true
]
```

ì´ ë§ˆìŠ¤í¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì¤‘ë³µëœ ì„ ì„ ì‹œê°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df.filter(df.is_duplicated())
shape: (2, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”‚
â”‚ --- â”† --- â”‚
â”‚ i64 â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† x   â”‚
â”‚ 1   â”† x   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

### is_unique

ë°ì´í„°í”„ë ˆì„ì˜ ëª¨ë“  ê³ ìœ í•œ í–‰ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

```python
print(df.is_unique())
```

```python
shape: (4,)
Series: '' [bool]
[
	false
	true
	true
	false
]
```

ê³ ìœ ê°’ì„ ê°€ì§„ í–‰ë§Œ ì¶œë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.filter(df.is_unique()))
```

```python
shape: (2, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† str â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 2   â”† a   â”† b   â”‚
â”‚ 3   â”† a   â”† b   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

### unique

ë°ì´í„°í”„ë ˆì„ì—ì„œ ì¤‘ë³µëœ í–‰ì„ ì‚­ì œí•©ë‹ˆë‹¤. ë§Œì•½, ë°ì´í„°í”„ë ˆì„ ë˜ëŠ” í•˜ìœ„ ì§‘í•©ì— List ìœ í˜•ì˜ ì—´ì´ ìˆëŠ” ê²½ìš° ì´ ë©”ì„œë“œëŠ” ì‹¤íŒ¨í•©ë‹ˆë‹¤.

```python
print(df.unique())
```

```python
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† str â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† a   â”† b   â”‚
â”‚ 2   â”† a   â”† b   â”‚
â”‚ 3   â”† a   â”† b   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

- subset : ì¤‘ë³µ í–‰ì„ ì‹ë³„í•  ë•Œ ê³ ë ¤í•  ì—´ ì´ë¦„ ë˜ëŠ” ì„ íƒê¸°ì…ë‹ˆë‹¤. ì—†ìŒ(ê¸°ë³¸ê°’)ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ëª¨ë“  ì—´ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- keep : {'first', 'last', 'any', 'none'} ì¤‘ë³µ í–‰ ì¤‘ ìœ ì§€í•  í–‰.
  'any': ì–´ë–¤ í–‰ì´ ìœ ì§€ë˜ëŠ”ì§€ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë” ë§ì€ ìµœì í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. 'none': ì¤‘ë³µ í–‰ì„ ìœ ì§€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 'first': ì²« ë²ˆì§¸ ê³ ìœ  í–‰ì„ ìœ ì§€í•©ë‹ˆë‹¤. 'last': ë§ˆì§€ë§‰ ê³ ìœ  í–‰ì„ ìœ ì§€í•©ë‹ˆë‹¤.
- **maintain_order** : ì›ë˜ ë°ì´í„°í”„ë ˆì„ê³¼ ë™ì¼í•œ ìˆœì„œë¥¼ ìœ ì§€í•©ë‹ˆë‹¤. ì´ ê²½ìš° ê³„ì‚° ë¹„ìš©ì´ ë” ë§ì´ ë“­ë‹ˆë‹¤. Trueë¡œ ì„¤ì •í•˜ë©´ ìŠ¤íŠ¸ë¦¬ë° ì—”ì§„ì—ì„œ ì‹¤í–‰í•  ê°€ëŠ¥ì„±ì´ ì°¨ë‹¨ë©ë‹ˆë‹¤.

```python
print(df.unique(subset=["b", "c"]))
```

```python
shape: (1, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† str â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† a   â”† b   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

```python
print(df.unique(keep="last"))
```

```python
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† str â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 2   â”† a   â”† b   â”‚
â”‚ 1   â”† a   â”† b   â”‚
â”‚ 3   â”† a   â”† b   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

```python
print(df.unique(subset=["b", "c"], maintain_order=True))
```

```python
shape: (1, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† str â”† str â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† a   â”† b   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

<aside>
pandasì˜ drop_duplicatesì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.

</aside>

ì†ì„±ê°’ ì¤‘ì—ì„œ ìœ ì¼í•œ ê°’ ì¶œë ¥

```
print(df["a"].unique())
```

```
shape: (3,)
Series: 'a' [i64]
[
	1
	2
	3
]
```

### n_unique

ê³ ìœ í•œ í–‰ì˜ ìˆ˜ ë˜ëŠ” ê³ ìœ í•œ í–‰ ë¶€ë¶„ ì§‘í•©ì˜ ìˆ˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
df = pl.DataFrame(
    {
        "a": [1, 1, 2, 3, 4, 5],
        "b": [0.5, 0.5, 1.0, 2.0, 3.0, 3.0],
        "c": [True, True, True, False, True, True],
    }
)
print(df)
```

```python
shape: (6, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c     â”‚
â”‚ --- â”† --- â”† ---   â”‚
â”‚ i64 â”† f64 â”† bool  â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1   â”† 0.5 â”† true  â”‚
â”‚ 1   â”† 0.5 â”† true  â”‚
â”‚ 2   â”† 1.0 â”† true  â”‚
â”‚ 3   â”† 2.0 â”† false â”‚
â”‚ 4   â”† 3.0 â”† true  â”‚
â”‚ 5   â”† 3.0 â”† true  â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
print(df.n_unique())
```

```python
5
```

ì†ì„± ê°’ì— ëŒ€í•œ ë¹ˆë„ìˆ˜ ì¶œë ¥

```python
print(df['a'].n_unique())
```

```python
3
```

```python
# ë‹¨ìˆœ ì—´
print(df.n_unique(subset=["b", "c"]))
```

```python
4
```

```python
# í‘œí˜„ì‹
df.n_unique(subset=[(pl.col("a") // 2),
                    (pl.col("c") | (pl.col("b") >= 2)),
                   ],
)
```

```python
3
```

- subset : ê³„ì‚°í•  ëŒ€ìƒì„ ì •ì˜í•˜ëŠ” í•˜ë‚˜ ì´ìƒì˜ ì—´/í‘œí˜„ì‹

ë°ì´í„° í”„ë ˆì„ ìˆ˜ì¤€ì—ì„œ ì‘ë™í•˜ë©°, í‘œí˜„ì‹ ìˆ˜ì¤€ì—ì„œ í•˜ìœ„ ì§‘í•©ì— ëŒ€í•´ ì‘ì—…í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì¡° íŒ¨í‚¹ì„ ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
expr_unique_subset = pl.struct("a", "b").n_unique()
```

ëŒ€ì‹  ì—´ë³„ ê³ ìœ  ê°’ì˜ ìˆ˜ë¥¼ ê³„ì‚°í•˜ë ¤ëŠ” ê²½ìš° í‘œí˜„ì‹ ìˆ˜ì¤€ êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ê²°ê³¼ê°€ í¬í•¨ëœ ìƒˆ í”„ë ˆì„ì„ ë°˜í™˜í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
df = pl.DataFrame(
    [[1, 2, 3], [1, 2, 4]], schema=["a", "b", "c"], orient="row"
)
df_nunique = df.select(pl.all().n_unique())
print(df_nunique)
```

```python
shape: (1, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ u32 â”† u32 â”† u32 â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† 1   â”† 2   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

ì§‘ê³„ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê·¸ë£¹ë³„ ê³ ìœ  ê°’ì„ ë°˜í™˜í•˜ëŠ” ë™ë“±í•œ ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤.

```python
df_agg_nunique = df.group_by("a").n_unique()
print(df_agg_nunique)
```

```python
shape: (1, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”† c   â”‚
â”‚ --- â”† --- â”† --- â”‚
â”‚ i64 â”† u32 â”† u32 â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1   â”† 1   â”† 2   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

### is_empty

ë°ì´í„° í”„ë ˆì„ì— í–‰ì´ ì—†ëŠ” ê²½ìš° Trueë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
df.is_empty()
```

```python
df.filter(pl.col("id") > 99).is_empty()
```

# 9. ë°ì´í„° ì •ë ¬

## sort

ì§€ì •ëœ ì»¬ëŸ¼ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„° í”„ë ˆì„ì„ ì •ë ¬í•©ë‹ˆë‹¤. ë¬¸ìì—´ë¡œ ì…ë ¥í•  ê²½ìš° ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤.

```
import polars as pl

df = pl.DataFrame(
    {
        "a": [1, 2, None],
        "b": [6.0, 5.0, 4.0],
        "c": ["a", "c", "b"],
    }
)

# df.sort("ì»¬ëŸ¼ëª…")
print(df.sort("a"))
```

```
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a    â”† b   â”† c   â”‚
â”‚ ---  â”† --- â”† --- â”‚
â”‚ i64  â”† f64 â”† str â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ null â”† 4.0 â”† b   â”‚
â”‚ 1    â”† 6.0 â”† a   â”‚
â”‚ 2    â”† 5.0 â”† c   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

ê³„ì‚°ì‹ì„ ê¸°ì¤€ìœ¼ë¡œë„ ì •ë ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
# df.sort("ê³„ì‚°ì‹")
print(df.sort(pl.col("a") + pl.col("b") * 2, nulls_last=True))
```

```
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a    â”† b   â”† c   â”‚
â”‚ ---  â”† --- â”† --- â”‚
â”‚ i64  â”† f64 â”† str â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 2    â”† 5.0 â”† c   â”‚
â”‚ 1    â”† 6.0 â”† a   â”‚
â”‚ null â”† 4.0 â”† b   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

- nulls_last : ì •ë ¬í•  ë•Œ null ê°’ì„ ë§ˆì§€ë§‰ì— ì˜¤ë„ë¡ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - `nulls_last=True` : ëª¨ë“  ì—´ì— ì ìš©ë˜ëŠ” ë‹¨ì¼ ë¶€ìš¸ ê°’ ì§€ì •
  - `nulls_last=[True, False, True]` : ê° ì—´ì— ëŒ€í•´ ê°œë³„ì ìœ¼ë¡œ ì œì–´ë¥¼ ìœ„í•´ ë¶€ìš¸ ë¦¬ìŠ¤íŠ¸ ì§€ì •

ì´ì²˜ëŸ¼ a, c ì—´ë§Œ nulls_lastë¥¼ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
print(df.sort([pl.col("a"), pl.col("b"), pl.col("c")], nulls_last=[True, False, True]))
```

```
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a    â”† b   â”† c   â”‚
â”‚ ---  â”† --- â”† --- â”‚
â”‚ i64  â”† f64 â”† str â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 2    â”† 5.0 â”† c   â”‚
â”‚ 1    â”† 6.0 â”† a   â”‚
â”‚ null â”† 4.0 â”† b   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

ë¦¬ìŠ¤íŠ¸ë¡œ ì—¬ëŸ¬ ì»¬ëŸ¼ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤.

```
print(df.sort(["c", "a"], descending=True))
```

```
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a    â”† b   â”† c   â”‚
â”‚ ---  â”† --- â”† --- â”‚
â”‚ i64  â”† f64 â”† str â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 2    â”† 5.0 â”† c   â”‚
â”‚ null â”† 4.0 â”† b   â”‚
â”‚ 1    â”† 6.0 â”† a   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

- descending : ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤.

descendingëŠ” nulls_lastê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ì—¬ëŸ¬ ì—´ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ëŠ” ê²½ìš° ë¶€ìš¸ ë¦¬ìŠ¤íŠ¸ ì „ë‹¬í•˜ì—¬ ì—´ë³„ë¡œ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
print(df.sort(["c", "a"], descending=[False, True]))
```

```
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a    â”† b   â”† c   â”‚
â”‚ ---  â”† --- â”† --- â”‚
â”‚ i64  â”† f64 â”† str â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1    â”† 6.0 â”† a   â”‚
â”‚ null â”† 4.0 â”† b   â”‚
â”‚ 2    â”† 5.0 â”† c   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

ë˜í•œ ì‰¼í‘œë¡œ ì»¬ëŸ¼ëª…ì„ ì…ë ¥í•˜ì—¬ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì—¬ëŸ¬ ì—´ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤.

```
df.sort("c", "a", descending=[False, True])
```

```
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a    â”† b   â”† c   â”‚
â”‚ ---  â”† --- â”† --- â”‚
â”‚ i64  â”† f64 â”† str â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 1    â”† 6.0 â”† a   â”‚
â”‚ null â”† 4.0 â”† b   â”‚
â”‚ 2    â”† 5.0 â”† c   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

ìš”ì†Œê°€ ë™ì¼í•œ ê²½ìš° ìˆœì„œë¥¼ ìœ ì§€í•˜ê³  ì‹¶ë‹¤ë©´ maintain_order=True ë¥¼ í•©ë‹ˆë‹¤.

```python
import polars as pl

df = pl.DataFrame(
    {
        "a": [1, 2, None],
        "b": [6.0, 5.0, 5.0],
        "c": ["a", "b", "b"],
    }
)

print(df.sort("c", descending=True, maintain_order=True))
```

```python
shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a    â”† b   â”† c   â”‚
â”‚ ---  â”† --- â”† --- â”‚
â”‚ i64  â”† f64 â”† str â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 2    â”† 5.0 â”† b   â”‚
â”‚ null â”† 5.0 â”† b   â”‚
â”‚ 1    â”† 6.0 â”† a   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

multithreaded=True(ê¸°ë³¸ê°’)ì¸ ê²½ìš° ë°ì´í„° ì •ë ¬ ì‹œ ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë³‘ë ¬ ì²˜ë¦¬í•˜ì—¬ ì„±ëŠ¥ì„ ìµœì í™” í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
print(df.sort("c", descending=True, multithreaded=True))
```

<aside>
**`multithreaded` ì˜µì…˜ì€ ì–¸ì œ ì‚¬ìš©í•˜ëŠ”ê°€?**

- ë°ì´í„°ì…‹ì´ ë§¤ìš° í´ ë•Œ
- ë©€í‹°ì½”ì–´ í”„ë¡œì„¸ì„œë¥¼ ê°€ì§€ê³  ìˆì„ ë•Œ
- ë°ì´í„° ì •ë ¬ ì‘ì—…ì´ ì‹œê°„ì´ ë§ì´ ê±¸ë¦¬ëŠ” ê²½ìš° ë³‘ë ¬ ì²˜ë¦¬ í˜œíƒì„ ì›í•  ë•Œ

ì‘ì€ ë°ì´í„° ì…‹ì´ë‚˜ ë””ë²„ê¹…ì„ ì‰½ê²Œ í•˜ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ” ë©€í‹° ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ë©´ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì˜¤ë²„í—¤ë“œê°€ ì‹¤ì œ ì •ë ¬ ì‹œê°„ë³´ë‹¤ ë” ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ´ ë•ŒëŠ” ë‹¨ì¼ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” íš¨ìœ¨ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</aside>

## reverse

DataFrameì„ ë°˜ëŒ€ë¡œ ë’¤ì§‘ìŠµë‹ˆë‹¤.

```python
df = pl.DataFrame(
    {
        "key": ["a", "b", "c"],
        "val": [1, 2, 3],
    }
)
df.reverse()
```

```python
shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ key â”† val â”‚
â”‚ --- â”† --- â”‚
â”‚ str â”† i64 â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ c   â”† 3   â”‚
â”‚ b   â”† 2   â”‚
â”‚ a   â”† 1   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

# 10. ë¬¸ìì—´ ì²˜ë¦¬ ë°©ë²•

```python
weather = pl.DataFrame(
    {
        "station": ["Station " + str(x) for x in range(1, 6)],
        "temperatures": [
            "20 5 5 E1 7 13 19 9 6 20",
            "18 8 16 11 23 E2 8 E2 E2 E2 90 70 40",
            "19 24 E9 16 6 12 10 22",
            "E2 E0 15 7 8 10 E1 24 17 13 6",
            "14 8 E0 16 22 24 E1",
        ],
    }
)
print(weather)
```

```python
weather['temperatures'].dtype
```

```python
out = weather.with_columns(
    pl.col("temperatures")
)
print(out)
```

```python
# df.columns.str.replace('ë°”ê¿€ê°’', 'ë°”ê¿€ ë¬¸ìì—´')
weather.with_columns(
    pl.col("temperatures").str.replace("E","W")
)
```

```python
# df.columns.str.replace('ë°”ê¿€ê°’', 'ë°”ê¿€ ë¬¸ìì—´')
weather.with_columns(
    weather['temperatures'].str.replace("E","W")
)
```

```python
out = weather.with_columns(
    pl.col("temperatures").str.split(" ")
)
print(out)
```

```python
out = weather.with_columns(
    pl.col("temperatures").str.split(" ")
    ).explode(
        "temperatures"
)
print(out)
```

```python
out = weather.with_columns(
    pl.col("temperatures").str.split(" ")
    ).with_columns(
        pl.col("temperatures").list.head(3).alias("top3"),
        pl.col("temperatures").list.slice(-3, 3).alias("bottom_3"),
        pl.col("temperatures").list.len().alias("obs"),
)
print(out)
```

```python
out = weather.with_columns(
    pl.col("temperatures")
    .str.split(" ")
)
print(out)
```

```pytho
out = weather.with_columns(
    pl.col("temperatures")
    .str.split(" ")
    .list.eval(pl.element().cast(pl.Int64, strict=False).is_null())
)
print(out)
```

```python
out = weather.with_columns(
    pl.col("temperatures")
    .str.split(" ")
    .list.eval(pl.element().cast(pl.Int64, strict=False).is_null())
    .list.sum()
)
print(out)
```

```python
out = weather.with_columns(
    pl.col("temperatures")
    .str.split(" ")
    .list.eval(pl.element().cast(pl.Int64, strict=False).is_null())
    .list.sum()
    .alias("errors")
)
print(out)
```

```python
out = weather.with_columns(
    pl.col("temperatures")
    .str.split(" ")
    .list.eval(pl.element().str.contains("(?i)[a-z]"))
    .list.sum()
    .alias("errors")
)
print(out)
```

```python
weather_by_day = pl.DataFrame(
    {
        "station": ["Station " + str(x) for x in range(1, 11)],
        "day_1": [17, 11, 8, 22, 9, 21, 20, 8, 8, 17],
        "day_2": [15, 11, 10, 8, 7, 14, 18, 21, 15, 13],
        "day_3": [16, 15, 24, 24, 8, 23, 19, 23, 16, 10],
    }
)
print(weather_by_day)
```

```python
rank_pct = (pl.element().rank(descending=True) / pl.col("*").count()).round(2)

out = weather_by_day.with_columns(
    # create the list of homogeneous data
    pl.concat_list(pl.all().exclude("station")).alias("all_temps")
).select(
    # select all columns except the intermediate list
    pl.all().exclude("all_temps"),
    # compute the rank by calling `list.eval`
    pl.col("all_temps").list.eval(rank_pct, parallel=True).alias("temps_rank"),
)

print(out)
```

```python
array_df = pl.DataFrame(
    [
        pl.Series("Array_1", [[1, 3], [2, 5]]),
        pl.Series("Array_2", [[1, 7, 3], [8, 1, 0]]),
    ],
    schema={
        "Array_1": pl.Array(pl.Int64, 2),
        "Array_2": pl.Array(pl.Int64, 3),
    },
)
print(array_df)
```
