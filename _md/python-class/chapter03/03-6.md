---
chapter: 클래스 속성
title: 매직메서드 - 반복
date: 2024-01-30
---

# 1. 반복 가능한 객체

파이썬에서는 `for` 루프를 사용하여 반복 가능한 객체를 순회할 수 있습니다. 반복 가능한 객체는 `__iter__` 매직 메서드를 가진 객체입니다. 이 메서드는 이터레이터 객체를 반환해야 합니다.

# 1. `__iter__` 매직 메서드

파이썬에서는 `__iter__` 매직 메서드를 사용하여 반복 가능한 객체를 만들 수 있습니다. 이 메서드는 `__next__` 메서드를 가진 이터레이터 객체를 반환해야 합니다.

```python
class MyRange:
    def __init__(self, start, end):
        self.start = start
        self.end = end

    def __iter__(self):
        return self

    def __next__(self):
        if self.start >= self.end:
            raise StopIteration
        value = self.start
        self.start += 1
        return value

my_range = MyRange(0, 3)
for i in my_range:
    print(i)
```


# 2. `__next__` 매직 메서드

`__next__` 매직 메서드는 이터레이터 객체에서 다음 값을 반환합니다. 만약 더 이상 반환할 값이 없다면 `StopIteration` 예외를 발생시켜야 합니다.

```python
class MyRange:
    def __init__(self, start, end):
        self.start = start
        self.end = end

    def __iter__(self):
        return self

    def __next__(self):
        if self.start >= self.end:
            raise StopIteration
        value = self.start
        self.start += 1
        return value

my_range = MyRange(0, 3)
print(next(my_range))
print(next(my_range))
print(next(my_range))
print(next(my_range))
```

# 3. `__iter__`와 `__next__` 매직 메서드

`__iter__`와 `__next__` 매직 메서드를 사용하여 이터레이터 객체를 만들 수 있습니다. 이터레이터 객체는 `__iter__` 메서드를 가진 객체이며, `__next__` 메서드를 사용하여 다음 값을 반환합니다.

```python
class MyRange:
    def __init__(self, start, end):
        self.start = start
        self.end = end

    def __iter__(self):
        return self

    def __next__(self):
        if self.start >= self.end:
            raise StopIteration
        value = self.start
        self.start += 1
        return value

my_range = MyRange(0, 3)
print(next(my_range))
print(next(my_range))
print(next(my_range))
print(next(my_range))
```

:::div{.callout}

💡 위 코드는 [https://pythontutor.com/python-debugger.html#mode=edit](https://pythontutor.com/python-debugger.html#mode=edit) 서비스를 통해 시각화해서 단계별로 실행해보면서 이해하시길 권해드립니다.

:::

# 5. 이터레이터 재사용

`MyIterator` 클래스로 생성된 인스턴스 `my_iterator`는 한 번 순회하면 더 이상 사용할 수 없습니다. 이를 재사용 가능하게 만들기 위해서는 `__iter__` 메서드에서 `self.current_value` 변수를 초기화해야 합니다. 이로써 `my_iterator` 객체는 여러 번 순회할 수 있게 되었습니다.

```python-exec
class MyIterator:
    def __init__(self, stop):
        self.stop = stop

    def __iter__(self):
        self.current_value = 0  # __iter__에서 초기화
        return self

    def __next__(self):
        if self.current_value >= self.stop:
            raise StopIteration
        result = self.current_value
        self.current_value += 1
        return result

my_iterator = MyIterator(5)

for i in my_iterator:
    print(i)
```

# 6. 이터레이터

```python
class MyIterator(Sequence):
    def __init__(self, stop):
        self.stop = stop
        self.current_value = 0

    def __iter__(self):
        return self

    def __next__(self):
        if self.current_value >= self.stop:
            raise StopIteration
        result = self.current_value
        self.current_value += 1
        return result

my_iterator = MyIterator(5)
```