---
chapter: Streamlit 요소 알아보기
title: 차트 요소(데이터 시각화)
date: 2025-03-24
---

데이터 시각화에서는 Streamlit의 차트 함수와 다양한 라이브러리의 차트 함수를 애플리케이션에 표시하는 방법을 소개합니다. Line 차트, Bar 차트, Pie 차트 등등의 다양한 시각화 그래프를 활용하여 대시보드를 구성할 수 있습니다. 현재 가장 기본적인 라이브러리는 [Matplotlib](https://matplotlib.org/)입니다. 그리고 [Vega Lite](https://vega.github.io/vega-lite/)(2D 차트), [deck.gl](http://deck.gl/)(지도 및 3D 차트)과 같은 대화형 차트 라이브러리도 있습니다. 마지막으로, `st.line_chart` 및 `st.area_chart`와 같이 Streamlit에 기본으로 제공되는 몇 가지 차트 유형도 제공합니다.

<br>

# 기본 차트 요소

## **st.area_chart**

`st.area_chart`는 영역 차트를 표시합니다. 그래프 선 아래쪽 영역을 채워 보다 시각적으로 볼 수 있어 데이터의 추세, 변동, 비교를 명확하게 파악하기 용이합니다.

`st.area_chart`는 `st.altair_chart`를 중심으로 만들어진 구문입니다. 가장 큰 차이점은 Streamlit에서 제공하는 함수로 데이터의 자체 열과 인덱스를 사용하여 차트의 Altair 사양을 파악해 시각적으로 표현이 가능합니다. 따라서 데이터 넣고 바로 시각화 할 때는 쉽지만 사용자 정의, 커스터마이징의 유연성은 상대적으로 떨어질 수 있다는 단점이 있습니다. `st.area_chart`가 데이터 사양을 올바르게 추측하지 못하는 경우, `st.altair_chart`를 사용하여 원하는 차트를 생성해보시길 바랍니다.

```python
st.area_chart(data=None, *, x=None, y=None, x_label=None, y_label=None, color=None, stack=None, width=None, height=None, use_container_width=True)
```

<br>

**매개변수**

- `data`(Anything supported by st.dataframe) **:** 차트에 사용할 데이터를 입력합니다. 해당 데이터는 배열(Array), 리스트(List), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `x`(str, None, Keyword only) : x축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 x축 값에 데이터 인덱스를 사용합니다.
- `y`(str, Sequence of str, None, Keyword only) : y축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 나머지 모든 열의 데이터를 데이터 계열로 그립니다. 문자열 시퀀스인 경우, 와이드 포맷 테이블을 롱 포맷 테이블로 변환하여 동일한 차트에 여러 개의 시리즈를 그립니다.
  - 와이드 포맷(Wide format) : 하나의 행에 여러 컬럼으로 값이 나뉘어 있는 형태
    | 날짜 | 서울 | 부산 |
    | ---------- | ---- | ---- |
    | 2024-01-01 | 10 | 20 |
    | 2024-01-02 | 15 | 25 |
  - 롱 포맷 (Long format) : 하나의 행에 '카테고리' 컬럼과 '값' 컬럼으로 구성된 형태
    | 날짜 | 지역 | 값 |
    | ---------- | ---- | --- |
    | 2024-01-01 | 서울 | 10 |
    | 2024-01-01 | 부산 | 20 |
    | 2024-01-02 | 서울 | 15 |
    | 2024-01-02 | 부산 | 25 |
- `x_label`(str, None, Keyword only) : x축의 레이블입니다. None(기본값)이면 사용 가능한 경우 x에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `y_label`(str, None, Keyword only) : y축의 레이블입니다. None(기본값)이면 사용 가능한 경우 y에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `color`(str, tuple, Sequence of str, Sequence of tuple, None, Keyword only) : 차트에서 서로 다른 계열에 사용할 색상입니다.
  - 계열이 1개만 있는 영역형 차트
    - None : 기본 색
    - #ffaa00 또는 #ffaa0088과 같은 16진수 문자열
    - 빨강, 녹색, 파랑 및 알파 구성 요소가 0에서 255 사이의 정수 또는 0.0에서 1.0 사이의 실수로 지정된 RGB 또는 RGBA 튜플입니다.
  - 여러 계열이 있는 영역 차트에서 데이터프레임이 긴 형식(즉, y가 None이거나 열 하나만 있는 경우)
    - None : 기본 색
    - 데이터에서 해당 데이터 포인트의 색상에 사용할 열의 이름입니다. 이 열의 값에 따라 동일한 색상의 계열로 그룹화됩니다. 또한 이 열의 값이 위의 색상 형식(16진수 문자열 또는 색상 튜플) 중 하나와 일치하는 경우 해당 색상이 사용됩니다.
      ex1) 데이터 집합에 1000개의 행이 있지만 이 열에 '성인', '어린이', '아기' 값만 포함된 경우 해당 1000개의 데이터 포인트는 기본 색상표에서 자동으로 색상이 선택되어 세 가지 계열로 그룹화됩니다.
      ex2) 동일한 1000행 데이터 집합의 경우 이 열에 "#ffaa00", "#f0f", "#0000ff" 값이 포함된 경우 1000개의 데이터 요소는 여전히 3개의 계열로 그룹화되지만 이번에는 색상이 "#ffaa00", "#f0f", "#0000ff"가 됩니다.
  - 여러 계열이 있는 영역형 차트에서 데이터프레임이 와이드 형식(즉, y가 열의 시퀀스인 경우)
    - None : 기본 색
    - 차트의 각 시리즈에 사용할 문자열 색상 또는 색상 튜플 리스트입니다. 이 리스트는 `y` 개수와 길이가 같아야 합니다.
      ex) 3개 계열의 경우, color=["#fd0", "#f0f", "#04f"]
- `stack`(bool, "normalize", "center", None, Keyword only) : 영역을 쌓아 표시할지 여부입니다.
  - None(기본값) : Vega의 기본값(차트 유형에 따라 자동으로 선택)을 사용합니다.
  - True : 영역이 차트 내에서 겹치지 않도록 위로 영역을 쌓아올려 표시합니다.
    ![스크린샷 2025-04-11 오후 2.10.19.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-11_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.10.19.png)
  - False : 스택 없이 영역을 따로따로 그려 서로 겹칩니다.
    ![스크린샷 2025-04-11 오후 2.09.30.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-11_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.09.30.png)
  - normalize : 영역을 쌓아 올리는데 차트 전체 높이를 100%로 맞춰 정규화시킵니다. ex) 퍼센트 누적 그래프
    ![스크린샷 2025-04-11 오후 2.11.26.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-11_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.11.26.png)
  - center : 영역을 쌓는데 기준선(가운데)을 중심으로 위/아래 대칭처럼 배치하여 Streamgraph(시간에 따라 여러 변수의 변화 시각화한 그래프)가 만들어집니다.
    ![스크린샷 2025-04-08 오후 3.02.32.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.02.32.png)
- `width`(int, None, Keyword only) : 차트의 가로 너비를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 차트 너비를 상위 컨테이너 너비까지 plotting 라이브러리에 따라 콘텐츠에 맞게 설정합니다. 너비가 부모 컨테이너 너비보다 크면 차트 너비를 부모 컨테이너 너비와 일치하도록 설정합니다. 너비를 사용하려면 use_container_width=False로 설정해야 합니다.
- `height`(int, None, Keyword only) : 차트의 세로 너비(높이)를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 plotting 라이브러리에 따라 콘텐츠에 맞게 차트의 높이를 설정합니다.
- `use_container_width`(bool, Keyword only) : 차트를 포함하는 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 차트가 포함된 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False : `width`에 따라 차트의 너비를 설정합니다.

<br>

**예시 1**

다음 예시는 연도에 따라 각 도시의 인구 이동을 `st.area_chart`으로 시각화하는 예시입니다.

```python
import streamlit as st
import pandas as pd

# 데이터 생성
data = {
    "Year": [2018, 2019, 2020, 2021, 2022, 2023],
    "Seoul": [50, 55, 60, 58, 56, 52],
    "Busan": [45, 50, 52, 50, 48, 46],
    "Jeju": [70, 72, 68, 66, 64, 60]
}

df = pd.DataFrame(data)

# 그래프 생성
st.area_chart(df.set_index("Year"))
```

![스크린샷 2023-06-19 오후 9.21.13.png](/images/streamlit/chapter02/part03/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-06-19_%25EC%2598%25A4%25ED%259B%2584_9.21.13.png)

<br>

**예시2**

다음 예시는 `st.area_chart`를 사용해 랜덤 데이터를 생성 후 area 차트를 시각화하는 예시입니다. 데이터프레임이 와이드 형식인 경우 `y`에 여러 열을 그룹화하여 서로 다른 색상으로 여러 컬럼의 값을 표시할 수 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

# 데이터 생성
df = pd.DataFrame(np.random.randn(20, 3), columns=["a", "b", "c"])

# 그래프 생성
st.area_chart(df)

st.area_chart(
    chart_data,
    x="col1",
    y=["col2", "col3"],
    color=["#FF0000", "#0000FF"],  # Optional
)
```

![스크린샷 2023-06-19 오후 9.23.59.png](/images/streamlit/chapter02/part03/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-06-19_%25EC%2598%25A4%25ED%259B%2584_9.23.59.png)

`x`와 `y`에 사용할 다른 열을 선택할 수도 있고, 세 번째 열에 따라 색상을 동적으로 설정할 수도 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(
    {
        "col1": np.random.randn(20),
        "col2": np.random.randn(20),
        "col3": np.random.choice(["A", "B", "C"], 20),
    }
)

st.area_chart(chart_data, x="col1", y="col2", color="col3")
```

![스크린샷 2025-04-08 오후 2.54.42.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.54.42.png)

<br>

**예시3**

다음 예시는 `st.area_chart`를 사용해 랜덤 데이터를 생성 후 area 차트를 시각화하는 예시입니다. `stack`을 center로 설정하여 영역을 쌓는데 기준선(가운데)을 중심으로 위/아래 대칭처럼 배치하여 Streamgraph(시간에 따라 여러 변수의 변화 시각화한 그래프)를 생성합니다.

```bash
pip install vega_datasets
```

```python
import streamlit as st
from vega_datasets import data

source = data.unemployment_across_industries()

st.area_chart(source, x="date", y="count", color="series", stack="center")
```

![스크린샷 2025-04-08 오후 3.02.32.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.02.32.png)

<br>

## **st.bar_chart**

`st.bar_chart`는 막대 그래프를 표시합니다. 막대 그래프는 범주형 데이터의 빈도, 크기, 비교 등을 시각적으로 나타내는 데 사용됩니다.

`st.bar_chart`는 `st.altair_chart`를 중심으로 만들어진 구문입니다. 가장 큰 차이점은 Streamlit에서 제공하는 함수로 데이터의 자체 열과 인덱스를 사용하여 차트의 Altair 사양을 파악해 시각적으로 표현이 가능합니다. 따라서 데이터 넣고 바로 시각화 할 때는 쉽지만 사용자 정의, 커스터마이징의 유연성은 상대적으로 떨어질 수 있다는 단점이 있습니다. `st.bar_chart`가 데이터 사양을 올바르게 추측하지 못하는 경우, `st.altair_chart`를 사용하여 원하는 차트를 생성해보시길 바랍니다.

```python
st.bar_chart(data=None, *, x=None, y=None, x_label=None, y_label=None, color=None, horizontal=False, stack=None, width=None, height=None, use_container_width=True)
```

<br>

**매개변수**

- `data`(Anything supported by st.dataframe) : 차트에 사용할 데이터를 입력합니다. 해당 데이터는 배열(Array), 리스트(List), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `x`(str, None, Keyword only) : x축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 x축 값에 데이터 인덱스를 사용합니다.
- `y`(str, None, Keyword only) : y축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 나머지 모든 열의 데이터를 데이터 계열로 그립니다. 문자열 시퀀스인 경우, 와이드 포맷 테이블을 롱 포맷 테이블로 변환하여 동일한 차트에 여러 개의 시리즈를 그립니다.
- `y`(stror None, Keyword only) : y축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 나머지 모든 열의 데이터를 데이터 계열로 그립니다. 문자열 시퀀스인 경우, 와이드 포맷 테이블을 롱 포맷 테이블로 변환하여 동일한 차트에 여러 개의 시리즈를 그립니다.
- `x_label`(str, None, Keyword only) : x축의 레이블입니다. None(기본값)이면 사용 가능한 경우 x에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `y_label`(str, None, Keyword only) : y축의 레이블입니다. None(기본값)이면 사용 가능한 경우 y에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `color`(str, tuple, Sequence of str, Sequence of tuple, None, Keyword only) : 차트에서 서로 다른 계열에 사용할 색상입니다.
  - 계열이 1개만 있는 막대형 차트
    - None : 기본 색
    - #ffaa00 또는 #ffaa0088과 같은 16진수 문자열
    - 빨강, 녹색, 파랑 및 알파 구성 요소가 0에서 255 사이의 정수 또는 0.0에서 1.0 사이의 실수로 지정된 RGB 또는 RGBA 튜플입니다.
  - 여러 계열이 있는 막대형 차트에서 데이터프레임이 긴 형식(즉, y가 None이거나 열 하나만 있는 경우)
    - None : 기본 색
    - 데이터에서 해당 데이터 포인트의 색상에 사용할 열의 이름입니다. 이 열의 값에 따라 동일한 색상의 계열로 그룹화됩니다. 또한 이 열의 값이 위의 색상 형식(16진수 문자열 또는 색상 튜플) 중 하나와 일치하는 경우 해당 색상이 사용됩니다.
      ex1) 데이터 집합에 1000개의 행이 있지만 이 열에 '성인', '어린이', '아기' 값만 포함된 경우 해당 1000개의 데이터 포인트는 기본 색상표에서 자동으로 색상이 선택되어 세 가지 계열로 그룹화됩니다.
      ex2) 동일한 1000행 데이터 집합의 경우 이 열에 "#ffaa00", "#f0f", "#0000ff" 값이 포함된 경우 1000개의 데이터 요소는 여전히 3개의 계열로 그룹화되지만 이번에는 색상이 "#ffaa00", "#f0f", "#0000ff"가 됩니다.
  - 여러 계열이 있는 막대형 차트에서 데이터프레임이 와이드 형식(즉, y가 열의 시퀀스인 경우)
    - None : 기본 색
    - 차트의 각 시리즈에 사용할 문자열 색상 또는 색상 튜플 리스트입니다. 이 리스트는 `y` 개수와 길이가 같아야 합니다.
      ex) 3개 계열의 경우, color=["#fd0", "#f0f", "#04f"]
- `horizontal`(bool, Keyword only) : 막대를 가로로 표시할지 여부입니다.
  - True : x축과 y축을 바꾸고 막대를 가로로 표시합니다.
  - False(기본값) : 막대가 세로로 표시됩니다.
- `stack`(bool, "normalize", "center", "layered", None, Keyword only) : 막대를 쌓아 표시할지 여부입니다.
  - None(기본값) : Vega의 기본값(차트 유형에 따라 자동으로 선택)을 사용합니다.
  - True : 막대가 차트 내에서 겹치지 않도록 위에 막대를 쌓아올려 표시합니다.
  - False : 막대가 나란히 표시됩니다.
  - normalize : 막대가 쌓아 올리는데 차트 전체 높이를 100%로 맞춰 정규화시킵니다. ex) 퍼센트 누적 그래프
  - center : 막대를 쌓는데 축을 중심으로 전체 높이가 중앙에 오도록 이동합니다.
- `width`(int, None, Keyword only) : 차트의 가로 너비를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 차트 너비를 상위 컨테이너 너비까지 plotting 라이브러리에 따라 콘텐츠에 맞게 설정합니다. 너비가 부모 컨테이너 너비보다 크면 차트 너비를 부모 컨테이너 너비와 일치하도록 설정합니다. 너비를 사용하려면 use_container_width=False로 설정해야 합니다.
- `height`(int, None, Keyword only) : 차트의 세로 너비(높이)를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 plotting 라이브러리에 따라 콘텐츠에 맞게 차트의 높이를 설정합니다.
- `use_container_width`(bool, Keyword only) : 차트를 포함하는 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 차트가 포함된 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False : `width`에 따라 차트의 너비를 설정합니다.

<br>

**예시 1**

다음 예시는 `st.bar_chart`를 사용하여 막대 차트를 생성하는 예시입니다. chart_data 변수에 10행 5열의 랜덤한 값을 가지는 데이터프레임을 생성합니다. `st.bar_chart`를 사용하여 막대 차트를 생성합니다. 데이터프레임은 chart_data를 전달합니다. `width` ,`height`를 사용하여 막대 차트의 가로, 세로 크기를 600, 400으로 설정합니다. `use_container_width`를 사용하여 막대 차트의 너비를 컨테이너의 너비에 맞추지 않고 고정된 크기로 설정합니다.

```python
import streamlit as st

# 데이터
chart_data = pd.DataFrame(np.random.randn(10, 5),
                          columns=["a", "b", "c", "d", "e"])

# 막대 차트 출력
st.bar_chart(chart_data, width=600, height=400, use_container_width=False)
```

![Untitled](/images/streamlit/chapter02/part03/Untitled.png)

`x`와 `y`에 사용할 다른 열을 선택할 수도 있고, 세 번째 열에 따라 색상을 동적으로 설정할 수도 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(
    {
        "col1": list(range(20)) * 3,
        "col2": np.random.randn(60),
        "col3": ["A"] * 20 + ["B"] * 20 + ["C"] * 20,
    }
)

st.bar_chart(chart_data, x="col1", y="col2", color="col3")
```

![스크린샷 2025-04-08 오후 3.38.26.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.38.26.png)

데이터프레임이 와이드 형식인 경우 `y`에 여러 열을 그룹화하여 서로 다른 색상의 여러 계열을 표시할 수 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(
    {
        "col1": list(range(20)),
        "col2": np.random.randn(20),
        "col3": np.random.randn(20),
    }
)

st.bar_chart(
    chart_data,
    x="col1",
    y=["col2", "col3"],
    color=["#FF0000", "#0000FF"],  # Optional
)
```

![스크린샷 2025-04-08 오후 3.39.32.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.39.32.png)

<br>

**예시 2**

다음 예시는 `st.bar_chart`를 사용하여 막대 차트를 생성하는 예시입니다. source 변수에 vega_datasets 라이브러리의 barley 데이터를 가지고옵니다. `st.bar_chart`를 사용하여 막대 차트를 생성합니다. 데이터프레임은 source를 전달합니다. `horizontal`를 사용하여 막대 차트를 회전하여 가로로 표시합니다.

```python
import streamlit as st
from vega_datasets import data

source = data.barley()

st.bar_chart(source, x="variety", y="yield", color="site", horizontal=True)
```

![스크린샷 2025-04-08 오후 3.40.18.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.40.18.png)

`stack`을 False로 주시면 막대 차트의 중첩을 해제할 수 있습니다.

```python
import streamlit as st
from vega_datasets import data

source = data.barley()

st.bar_chart(source, x="year", y="yield", color="site", stack=False)
```

![스크린샷 2025-04-08 오후 4.03.26.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.03.26.png)

만약, streamlit.errors.StreamlitAPIException: Streamlit does not support non-stacked (grouped) bar charts with Altair 4.x. Please upgrade to Version 5 에러가 뜨면 altair 라이브러리를 버전 5로 업그레이드해줍니다.

```bash
pip install --upgrade altair
```

<br>

## **st.line_chart**

`st.line_chart`는 꺾은선형 차트를 표시합니다. 주로 시계열 데이터나 연속적인 데이터의 변화를 보여주기 위해 사용됩니다.

`st.line_chart`는 `st.altair_chart`를 중심으로 만들어진 구문입니다. 가장 큰 차이점은 Streamlit에서 제공하는 함수로 데이터의 자체 열과 인덱스를 사용하여 차트의 Altair 사양을 파악해 시각적으로 표현이 가능합니다. 따라서 데이터 넣고 바로 시각화 할 때는 쉽지만 사용자 정의, 커스터마이징의 유연성은 상대적으로 떨어질 수 있다는 단점이 있습니다. `st.line_chart`가 데이터 사양을 올바르게 추측하지 못하는 경우, `st.altair_chart`를 사용하여 원하는 차트를 생성해보시길 바랍니다.

```python
st.line_chart(data=None, *, x=None, y=None, x_label=None, y_label=None, color=None, width=None, height=None, use_container_width=True)
```

<br>

**매개변수**

- `data`(Anything supported by st.dataframe) **:** 차트에 사용할 데이터를 입력합니다. 해당 데이터는 배열(Array), 리스트(List), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다. 보통 선 그래프를 그릴 경우, 연속성이 있는 값(시간 또는 순서의 수치 데이터)을 넣습니다.
- `x`(str, None, Keyword only) : x축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 x축 값에 데이터 인덱스를 사용합니다.
- `y`(str, Sequence of str, None, Keyword only) : y축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 나머지 모든 열의 데이터를 데이터 계열로 그립니다. 문자열 시퀀스인 경우, 와이드 포맷 테이블을 롱 포맷 테이블로 변환하여 동일한 차트에 여러 개의 시리즈를 그립니다.
- `x_label`(str, None, Keyword only) : x축의 레이블입니다. None(기본값)이면 사용 가능한 경우 x에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `y_label`(str, None, Keyword only) : y축의 레이블입니다. None(기본값)이면 사용 가능한 경우 y에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `color`(str, tuple, Sequence of str, Sequence of tuple, None, Keyword only) : 차트에서 서로 다른 계열에 사용할 색상입니다.
  - 계열이 1개만 있는 꺾은선형 차트
    - None : 기본 색
    - #ffaa00 또는 #ffaa0088과 같은 16진수 문자열
    - 빨강, 녹색, 파랑 및 알파 구성 요소가 0에서 255 사이의 정수 또는 0.0에서 1.0 사이의 실수로 지정된 RGB 또는 RGBA 튜플입니다.
  - 여러 계열이 있는 꺾은선형 차트에서 데이터프레임이 긴 형식(즉, y가 None이거나 열 하나만 있는 경우)
    - None : 기본 색
    - 데이터에서 해당 데이터 포인트의 색상에 사용할 열의 이름입니다. 이 열의 값에 따라 동일한 색상의 계열로 그룹화됩니다. 또한 이 열의 값이 위의 색상 형식(16진수 문자열 또는 색상 튜플) 중 하나와 일치하는 경우 해당 색상이 사용됩니다.
      ex1) 데이터 집합에 1000개의 행이 있지만 이 열에 '성인', '어린이', '아기' 값만 포함된 경우 해당 1000개의 데이터 포인트는 기본 색상표에서 자동으로 색상이 선택되어 세 가지 계열로 그룹화됩니다.
      ex2) 동일한 1000행 데이터 집합의 경우 이 열에 "#ffaa00", "#f0f", "#0000ff" 값이 포함된 경우 1000개의 데이터 요소는 여전히 3개의 계열로 그룹화되지만 이번에는 색상이 "#ffaa00", "#f0f", "#0000ff"가 됩니다.
  - 여러 개의 선이 있는 꺾은선형 차트에서 데이터프레임이 와이드 형식(즉, y가 열의 시퀀스인 경우)
    - None : 기본 색
    - 차트의 각 시리즈에 사용할 문자열 색상 또는 색상 튜플 리스트입니다. 이 리스트는 `y` 개수와 길이가 같아야 합니다.
      ex) 3개 계열의 경우, color=["#fd0", "#f0f", "#04f"]
- `width`(int, None, Keyword only) : 차트의 가로 너비를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 차트 너비를 상위 컨테이너 너비까지 plotting 라이브러리에 따라 콘텐츠에 맞게 설정합니다. 너비가 부모 컨테이너 너비보다 크면 차트 너비를 부모 컨테이너 너비와 일치하도록 설정합니다. 너비를 사용하려면 use_container_width=False로 설정해야 합니다.
- `height`(int, None, Keyword only) : 차트의 세로 너비(높이)를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 plotting 라이브러리에 따라 콘텐츠에 맞게 차트의 높이를 설정합니다.
- `use_container_width`(bool, Keyword only) : 차트를 포함하는 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 차트가 포함된 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False : `width`에 따라 차트의 너비를 설정합니다.

<br>

**예시 1**

다음은 NumPy의 random 함수를 사용하여 값을 생성하고, 컬럼명은 2개 `columns = ["s", "t"]`를 넣어 데이터프레임을 생성합니다. `width`와 `height` 값을 0, 300으로 두어 선 그래프의 너비는 0, 높이 값은 300으로 설정합니다. `use_container_width`를 True로 설정하여 선 그래프의 너비를 컨테이너의 너비에 맞춰지게 선 그래프를 그립니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(np.random.randn(10, 2),
                          columns=["s", "t"])

st.line_chart(chart_data, width=0, height=300, use_container_width=True)
```

![스크린샷 2025-04-08 오후 4.23.24.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.23.24.png)

`x`와 `y`에 사용할 다른 열을 선택할 수도 있고, 세 번째 열에 따라 색상을 동적으로 설정할 수도 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(
    {
        "col1": np.random.randn(20),
        "col2": np.random.randn(20),
        "col3": np.random.choice(["A", "B", "C"], 20),
    }
)

st.line_chart(chart_data, x="col1", y="col2", color="col3")
```

![스크린샷 2025-04-08 오후 4.24.27.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.24.27.png)

데이터프레임이 와이드 형식인 경우 `y`에 여러 열을 그룹화하여 서로 다른 색상의 여러 줄을 표시할 수 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(
    np.random.randn(20, 3), columns=["col1", "col2", "col3"]
)

st.line_chart(
    chart_data,
    x="col1",
    y=["col2", "col3"],
    color=["#FF0000", "#0000FF"],  # Optional
)
```

![스크린샷 2025-04-08 오후 4.25.20.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.25.20.png)

<br>

**예시 2**

다음은 NumPy의 random 함수를 사용하여 데이터프레임을 생성합니다. `.add_rows`를 사용하여 꺾은선형 차트에 새로운 데이터를 추가해보도록 하겠습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

# 첫 번째 데이터프레임 생성
df1 = pd.DataFrame(
    np.random.randn(50, 20), columns=("col %d" % i for i in range(20))
)

# 두 번째 데이터프레임 생성
df2 = pd.DataFrame(
    np.random.randn(50, 20), columns=("col %d" % i for i in range(20))
)

# 첫 번째 데이터프레임을 사용한 차트 생성
my_chart = st.line_chart(df1)

# 두 번째 데이터프레임을 기존 차트에 추가
my_chart.add_rows(df2)
# 이제 차트에는 df1 뒤에 df2의 데이터가 추가된 꺾은선형 차트가 표시됩니다.
```

![스크린샷 2025-03-31 오후 3.43.21.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-03-31_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.43.21.png)

<br>

## **st.scatter_chart**

`st.scatter_chart`는 스캐터 플롯 차트를 표시합니다. `st.scatter_chart`는 `st.altair_chart`를 중심으로 만들어진 구문입니다. 가장 큰 차이점은 Streamlit에서 제공하는 함수로 데이터의 자체 열과 인덱스를 사용하여 차트의 Altair 사양을 파악해 시각적으로 표현이 가능합니다. 따라서 데이터 넣고 바로 시각화 할 때는 쉽지만 사용자 정의, 커스터마이징의 유연성은 상대적으로 떨어질 수 있다는 단점이 있습니다. `st.scatter_chart`가 데이터 사양을 올바르게 추측하지 못하는 경우, `st.altair_chart`를 사용하여 원하는 차트를 생성해보시길 바랍니다.

```python
st.scatter_chart(data=None, *, x=None, y=None, x_label=None, y_label=None, color=None, size=None, width=None, height=None, use_container_width=True)
```

<br>

**매개변수**

- `data`(Anything supported by st.dataframe) **:** 차트에 사용할 데이터를 입력합니다. 해당 데이터는 배열(Array), 리스트(List), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `x`(str, None, Keyword only) : x축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 x축 값에 데이터 인덱스를 사용합니다.
- `y`(str, Sequence of str, None, Keyword only) : y축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 나머지 모든 열의 데이터를 데이터 계열로 그립니다. 문자열 시퀀스인 경우, 와이드 포맷 테이블을 롱 포맷 테이블로 변환하여 동일한 차트에 여러 개의 시리즈를 그립니다.
- `x_label`(str, None, Keyword only) : x축의 레이블입니다. None(기본값)이면 사용 가능한 경우 x에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `y_label`(str, None, Keyword only) : y축의 레이블입니다. None(기본값)이면 사용 가능한 경우 y에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `color`(str, tuple, Sequence of str, Sequence of tuple, None, Keyword only) : 각 데이터 포인트를 나타내는 원의 색상입니다.
  - None : 기본 색
  - #ffaa00 또는 #ffaa0088과 같은 16진수 문자열
  - 빨강, 녹색, 파랑 및 알파 구성 요소가 0에서 255 사이의 정수 또는 0.0에서 1.0 사이의 실수로 지정된 RGB 또는 RGBA 튜플입니다.
  - 데이터에서 해당 데이터 포인트의 색상에 사용할 열의 이름입니다. 이 열의 값에 따라 동일한 색상의 계열로 그룹화됩니다. 또한 이 열의 값이 위의 색상 형식(16진수 문자열 또는 색상 튜플) 중 하나와 일치하는 경우 해당 색상이 사용됩니다. 그렇지 않으면 기본 색상표에서 색상이 자동으로 선택됩니다.
    ex1) 데이터 집합에 1000개의 행이 있지만 이 열에 '성인', '어린이', '아기' 값만 포함된 경우 해당 1000개의 데이터 포인트는 기본 색상표에서 자동으로 색상이 선택되어 세 가지 계열로 그룹화됩니다.
    ex2) 실수 또는 정수만 포함된 경우 해당 1000개의 데이터 포인트는 연속적인 색상 그라데이션의 색상을 사용하여 표시됩니다.
    ex3) "#ffaa00", "#f0f", "#0000ff" 값만 포함된 경우 1000개의 데이터포인트 각각에 "#ffaa00", "#f0f" 또는 "#0000ff"가 적절하게 할당됩니다.
  - 데이터프레임이 와이드 형식(즉, y가 열의 시퀀스인 경우)
    - 차트의 각 시리즈에 사용할 문자열 색상 또는 색상 튜플 리스트입니다. 이 리스트는 `y` 개수와 길이가 같아야 합니다.
      ex) 3개 계열의 경우, color=["#fd0", "#f0f", "#04f"]
- `size`(str, float, int, None, Keyword only) : 각 점을 나타내는 원의 크기입니다. 모든 데이터 포인트에 사용할 단일 크기를 지정하려면 숫자를 입력하거나 크기에 사용할 열의 이름을 입력하여 각 데이터 포인트가 다른 크기의 원으로 표시될 수 있습니다.
- `width`(int, None, Keyword only) : 차트의 가로 너비를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 차트 너비를 상위 컨테이너 너비까지 plotting 라이브러리에 따라 콘텐츠에 맞게 설정합니다. 너비가 부모 컨테이너 너비보다 크면 차트 너비를 부모 컨테이너 너비와 일치하도록 설정합니다. 너비를 사용하려면 use_container_width=False로 설정해야 합니다.
- `height`(int, None, Keyword only) : 차트의 세로 너비(높이)를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 plotting 라이브러리에 따라 콘텐츠에 맞게 차트의 높이를 설정합니다.
- `use_container_width`(bool, Keyword only) : 차트를 포함하는 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 차트가 포함된 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False : `width`에 따라 차트의 너비를 설정합니다.

<br>

**예시 1**

다음은 NumPy의 random 함수를 사용하여 값을 생성하고, 컬럼명은 3개 `columns=["a", "b", "c"]`를 넣어 데이터프레임을 생성합니다. 여기서 col1을 `x`축으로, col2를 `y`축으로, col3를 크기로, col4를 색상으로 설정하고 `st.scatter_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(
    np.random.randn(20, 3), columns=["col1", "col2", "col3"]
)
chart_data["col4"] = np.random.choice(["A", "B", "C"], 20)

st.scatter_chart(
    chart_data,
    x="col1",
    y="col2",
    color="col4",
    size="col3",
)
```

![스크린샷 2025-04-09 오후 2.01.35.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.01.35.png)

마지막으로, 데이터프레임이 와이드 형식인 경우 `y`에 여러 열을 그룹화하여 서로 다른 색상으로 여러 시리즈를 표시할 수 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(
    np.random.randn(20, 4), columns=["col1", "col2", "col3", "col4"]
)

st.scatter_chart(
    chart_data,
    x="col1",
    y=["col2", "col3"],
    size="col4",
    color=["#FF0000", "#0000FF"],  # Optional
)
```

![스크린샷 2025-04-09 오후 2.02.32.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.02.32.png)

<br>

**예시 2**

다음 예시는 `alt.chart`를 사용하여 차트 객체를 만들고, `mark_circle`을 이용하여 원형 마커를 사용하는 scatter plot를 그립니다. `encode`를 사용해서 축 및 툴팁에 대한 값을 설정합니다. 여기서 x축의 값을 `x`축으로, y축의 값을 `y`축으로, z값을 크기와 색상으로 설정하고 툴팁으로 x축의 값, y축의 값, z 값을 표시하고 `st.altair_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np
import altair as alt

# 데이터프레임 만들기
df_chart = pd.DataFrame(np.random.randn(100, 3),
                        columns=["x축의 값", "y축의 값", "z값"])

# Altair 차트 객체 만들기
df_altair_chart = alt.Chart(df_chart).mark_circle().encode(x="x축의 값", y="y축의 값", size="z값", color="z값",tooltip=["x축의 값","y축의 값","z값"])
st.altair_chart(df_altair_chart, use_container_width=True)
```

![스크린샷 2025-04-09 오후 1.54.31.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.54.31.png)

<br>

## **st.map**

`st.map`는 Streamlit에서 제공하는 함수로 스캐터 플롯이 겹쳐진 지도를 생성하고 데이터를 표시하는 기능을 제공합니다. 사용자는 지도 위에 점으로 위치를 표시하여 지리적 데이터를 시각화하고 위치 정보를 시각적으로 전달할 수 있습니다.

`st.map` 함수가 내부적으로 `st.pydeck_chart` 함수를 사용하기 때문에 지도의 중심과 자동으로 확대/축소 수준을 조정해 지도 위에 스캐터 플롯 차트를 그릴 수 있습니다.

```python
st.map(data=None, *, latitude=None, longitude=None, color=None, size=None, zoom=None, use_container_width=True, width=None, height=None)
```

<br>

**매개변수**

- `data`(Anything supported by st.dataframe) : Map 차트의 좌표로 사용할 데이터를 입력합니다. 해당 데이터는 배열(Array), 시리즈(Series), 또는 데이터프레임(DataFrame) 또는 데이터가 저장된 파일 등 다양한 형식이 입력될 수 있습니다.
- `latitude`(str, None, Keyword only) : 차트에서 데이터 포인트의 위도 좌표가 포함된 열의 이름입니다. None인 경우 위도 데이터는 'lat', 'latitude', 'LAT' 또는 'LATITUDE'라는 이름의 열에서 가져옵니다.
- `longitude`(str, None, Keyword only) : 차트에서 데이터 포인트의 경도 좌표가 포함된 열의 이름입니다. None인 경우 경도 데이터는 'lon', 'longitude', 'LON' 또는 'LONGITUDE'라는 이름의 열에서 가져옵니다.
- `color`(str, tuple, None, Keyword only) : 각 데이터 포인트를 나타내는 원의 색상을 지정합니다.
  - None : 기본 색
  - #ffaa00 또는 #ffaa0088과 같은 16진수 문자열
  - 빨강, 녹색, 파랑 및 알파 구성 요소가 0에서 255 사이의 정수 또는 0.0에서 1.0 사이의 실수로 지정된 RGB 또는 RGBA 튜플입니다.
  - 데이터에서 해당 데이터 포인트의 색상에 사용할 열의 이름입니다. 이 열의 값에 따라 동일한 색상의 계열로 그룹화됩니다. 또한 이 열의 값이 위의 색상 형식(16진수 문자열 또는 색상 튜플) 중 하나와 일치하는 경우 해당 색상이 사용됩니다.
- `size`(str, float, int, None, Keyword only) : 각 점을 나타내는 원의 크기입니다. 기본 크기를 사용하려면 None, 모든 데이터 포인트에 사용할 단일 크기를 지정하려면 숫자를 입력하거나 크기에 사용할 열의 이름을 입력하여 각 데이터 포인트가 다른 크기의 원으로 표시될 수 있습니다.
- `zoom`(int, Keyword only) : 지도의 초기 확대/축소 수준을 지정합니다. 값이 클수록 지도가 확대됩니다. 기본값은 10입니다.
- `use_container_width`(bool, Keyword only) : 지도의 기본 너비를 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 지도 기본 너비를 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False : 지도 너비를 plotting 라이브러리에 따라 설정하되, 지도 너비가 너무 크면 부모(상위) 컨테이너 너비까지 콘텐츠에 맞게 설정합니다.
- `width`(int, None, Keyword only) : 차트의 가로 너비를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 차트 너비를 상위 컨테이너 너비까지 plotting 라이브러리에 따라 콘텐츠에 맞게 설정합니다. 너비가 부모 컨테이너 너비보다 크면 차트 너비를 부모 컨테이너 너비와 일치하도록 설정합니다. 너비를 사용하려면 use_container_width=False로 설정해야 합니다.
- `height`(int, None, Keyword only) : 차트의 세로 너비(높이)를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 plotting 라이브러리에 따라 콘텐츠에 맞게 차트의 높이를 설정합니다.

<br>

**예시 1**

다음 예시는 서울시 좌표를 중심으로 생성된 랜덤 데이터를 `st.map`으로 시각화하는 예시입니다. `zoom`은 10으로 지정하여 뷰의 초기 상태를 설정하고, `use_container_width`은 False로 지정합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

df = pd.DataFrame(np.random.randn(1000, 2) / [20, 20] + [37.57, 126.98],
                  columns=["lat", "lon"])

st.map(df, zoom=10, use_container_width=False)
```

![스크린샷 2025-04-09 오후 3.14.29.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.14.29.png)

<br>

**예시 2**

다음 예시는 한국 시도 구청의 좌표를 `st.map`를 통해 시각화하는 예시입니다. `zoom`은 5.5으로 지정하여 뷰의 초기 상태를 설정하고, `use_container_width`은 True로 지정하여 자동으로 해당 차트가 있는 컨테이너의 너비에 맞춰서 크기가 설정됩니다.

```python
import pandas as pd
import streamlit as st

locations = {
  "서울" : [37.566418, 126.977950],#서울시청
  "부산" : [35.180152, 129.074980],#부산시청
  "대구" : [35.871468, 128.601757],#대구시청
  "인천" : [37.456445, 126.705873],#인천시청
  "광주" : [35.160068, 126.851426],#광주광역시청
  "대전" : [36.350664, 127.384819],#대전시청
  "울산" : [35.539772, 129.311486],#울산시청
  "세종" : [36.480838, 127.289181],#세종시청
  "경기" : [37.275221, 127.009382],#경기도청
  "강원" : [37.885300, 127.729835],#강원(강원도청)
  "충북" : [36.635947, 127.491345],#충북도청
  "충남" : [36.658826, 126.672849],#충남도청
  "전북" : [35.820599, 127.108759],#전북도청
  "전남" : [34.816351, 126.462924],#전남도청
  "경북" : [36.574108, 128.509303],#경북도청
  "경남" : [35.238398, 128.692371],#경남도청
  "제주" : [33.3617007, 126.511657]#제주
    }

df_locations = pd.DataFrame(locations).T
df_locations.columns = ["lat", "lon"]

st.map(df_locations, zoom=5.5, use_container_width=True)
```

![스크린샷 2023-06-13 오후 8.38.09.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-06-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_8.38.09.png)

<br>

**예시 3**

다음 예시는 한국 시도 구청의 좌표를 `st.map`를 통해 시각화하는 예시입니다. `size`는 20으로 지정하여 점의 크기를 설정하고, 색상을 설정합니다.

```python
import pandas as pd
import streamlit as st

locations = {
  "서울" : [37.566418, 126.977950],#서울시청
  "부산" : [35.180152, 129.074980],#부산시청
  "대구" : [35.871468, 128.601757],#대구시청
  "인천" : [37.456445, 126.705873],#인천시청
  "광주" : [35.160068, 126.851426],#광주광역시청
  "대전" : [36.350664, 127.384819],#대전시청
  "울산" : [35.539772, 129.311486],#울산시청
  "세종" : [36.480838, 127.289181],#세종시청
  "경기" : [37.275221, 127.009382],#경기도청
  "강원" : [37.885300, 127.729835],#강원(강원도청)
  "충북" : [36.635947, 127.491345],#충북도청
  "충남" : [36.658826, 126.672849],#충남도청
  "전북" : [35.820599, 127.108759],#전북도청
  "전남" : [34.816351, 126.462924],#전남도청
  "경북" : [36.574108, 128.509303],#경북도청
  "경남" : [35.238398, 128.692371],#경남도청
  "제주" : [33.3617007, 126.511657]#제주
    }

df_locations = pd.DataFrame(locations).T
df_locations.columns = ["lat", "lon"]

st.map(df_locations, size=20, color="#0044ff")
```

![스크린샷 2025-04-09 오후 3.18.58.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.18.58.png)

<br>

**예시 4**

다음 예시는 랜덤으로 위경도를 생성하고 `st.map`를 통해 시각화하는 예시입니다. `latitude`는 col1으로 위도를 설정하고, `longitude`는 col2로 지정하여 경도를 설정합니다. 점의 크기는 col3으로 설정하고, 색상은 col4로 설정합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

df = pd.DataFrame(
    {
        "col1": np.random.randn(1000) / 50 + 37.76,
        "col2": np.random.randn(1000) / 50 + -122.4,
        "col3": np.random.randn(1000) * 100,
        "col4": np.random.rand(1000, 4).tolist(),
    }
)

st.map(df, latitude="col1", longitude="col2", size="col3", color="col4")
```

![스크린샷 2025-04-09 오후 3.21.06.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.21.06.png)

<br>

# 고급 차트 요소

## **st.pyplot**

`st.pyplot`는 Python 차트 라이브러리 Matplotlib 기반의 차트를 표시합니다. Streamlit에서 Matplotlib 차트를 시각화하려면 matplotlib.pyplot 그림을 그리고 `st.pyplot`로 시각화하시면 됩니다. `st.pyplot`을 사용하려면 matplotlib를 설치하셔야 합니다.

```bash
pip install matplotlib
```

```python
st.pyplot(fig=None, clear_figure=None, use_container_width=True, **kwargs)
```

<br>

**매개변수**

- `fig`(Matplotlib Figure) : 렌더링할 Matplotlib 그림 객체입니다.
- `clear_figure`(bool) : matplotlib 렌더링에 대한 Jupyter의 접근 방식을 시뮬레이션합니다. 만약, 지정하지 않으면 `fig` 값에 따라 기본값이 선택됩니다.
  - True : 렌더링된 후 그림이 지워집니다. `fig`를 설정하지 않았을때 기본값
  - False : 렌더링된 후 그림이 지워지지 않습니다. `fig`가 설정되어 있을때 기본값
- `use_container_width`(bool) : 그림의 기본 너비를 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 그림의 기본 너비를 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False(기본값) : 그림 너비를 plotting 라이브러리에 따라 설정하되, 그림 너비가 너무 크면 부모(상위) 컨테이너 너비까지 콘텐츠에 맞게 설정합니다.
- `**kwargs`(any, Keyword only) \*\*\*\*: Matplotlib의 savefig 함수에 전달할 인수입니다.

<br>

### **Area chart(Seaborn 라이브러리 활용)**

Seaborn은 Matplotlib의 기능을 기반으로 한 데이터 시각화 라이브러리로, Matplotlib에 비해 더 간편한 구문과 다양한 스타일링 옵션을 제공합니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. Seaborn의 `sns.lineplot` 함수와 `fill_between` 함수를 사용하여 영역형 차트로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns

fig, ax = plt.subplots()
sns.lineplot(data)
ax.fill_between(x, y1, color=None, alpha=0)
ax.fill_between(x, y1, y2, color=None, alpha=0)
...

st.pyplot(fig)
```

<br>

`fill_between`**의 매개변수**

- `x` : x축에 입력할 배열(array) 또는 리스트(list)입니다.
- `y1` : 아래쪽 경곗값(범위의 시작점)으로, y 좌표 값입니다.
- `y2` : 위쪽 경곗값(범위의 끝점)으로, y 좌표 값입니다.
- `color`(str, None) : 차트에서 서로 다른 계열에 사용할 색상입니다.
- `alpha`(float, None) : 영역의 투명도를 나타내며, 0(투명)부터 1(불투명) 사이의 값을 지정합니다.
  - 0(기본값) : 완전히 투명한 상태입니다.

<br>

**예시 1**

다음 예시는 랜덤한 값으로 영역형 차트를 생성합니다. `sns.lineplot`으로 선 그래프를 생성한 뒤 `fill_between`을 추가하면서 영역형 차트를 생성하고 `st.pyplot`을 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.DataFrame(np.random.randn(20, 3), columns=["a", "b", "c"])

fig, ax = plt.subplots()
sns.lineplot(data=df)

ax.fill_between(df.index, df["a"], color="blue", alpha=0.3)
ax.fill_between(df.index, df["a"], df["b"], color="green", alpha=0.3)
ax.fill_between(df.index, df["b"], df["c"], color="yellow", alpha=0.3)
ax.fill_between(df.index, df["c"], color="red", alpha=0.3)

st.pyplot(fig)
```

![스크린샷 2025-04-11 오후 5.16.13.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-11_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.16.13.png)

<br>

### **Line Chart(Matplotlib 라이브러리 활용)**

Matplotlib은 Python의 데이터 시각화 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있는 강력한 도구입니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. `ax.plot`을 사용하여 주어진 데이터를 선 그래프로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt

fig, ax = plt.subplots()
ax.plot(x, y, color=None, linewidth=None, linestyle=None, marker=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `x` : x축에 입력할 배열(Array) 또는 리스트(List)입니다.
- `y` : y축에 입력할 배열(Array) 또는 리스트(List)입니다.
- `label`(str, None) : 그래프의 범례에 표시될 항목의 이름을 지정합니다. 범례는 그래프에 사용된 데이터 열을 설명하는데 사용됩니다. 여러 개의 그래프를 한 번에 표현하고 싶을 때 `label`을 지정해 주면 어떤 그래프인지 파악할 수 있습니다.
- `color`(str, None) : 그래프의 선 색상을 지정합니다. 문자열("blue", "green", "red") 또는 RGB 값으로 지정할 수 있습니다.
- `linewidth`(int, None) : 그래프의 선 두께를 지정합니다.
- `linestyle`(str, None) : 그래프의 선 스타일을 지정합니다.
  - "-" : 실선
  - "--" : 점선
  - "-." : 파선
  - ":" : 점파선
- `marker`(str, None) : 그래프 안에 있는 데이터의 포인트를 표시 가능하게 해주는 마커의 종류를 지정합니다. 마커의 종류는 원("o"), 사각형("s"), 세모("^") 등이 있습니다.

<br>

**예시 1**

다음 예시는 `x`에 정수 0-9까지 x축 범위를 지정하고, 1과 10 사이의 정수를 랜덤하게 `y` 값으로 사용하여 라인 차트를 생성합니다. `ax.plot`으로 선 그래프를 생성한 뒤 `st.pyplot`을 사용하여 차트를 시각화합니다. `color`는 "navy" 색상을 지정하고, `linewidth`는 2로 선의 두께를 지정합니다. `linestyle`은 실선("-")을 적용하고 `marker`를 "o"로 지정하여 원형 마커를 사용합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import random

# 랜덤데이터
x = range(10)
y = [random.randint(1, 10) for _ in x]

# 라인차트
fig, ax = plt.subplots()
ax.plot(x,y, color="navy", linewidth=2, linestyle="-", marker="o")

# 그래프
st.pyplot(fig)
```

![스크린샷 2025-04-08 오후 5.11.28.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.11.28.png)

<br>

### **Line Chart(Seaborn 라이브러리 활용)**

Seaborn은 Matplotlib의 기능을 기반으로 한 데이터 시각화 라이브러리로, Matplotlib에 비해 더 간편한 구문과 다양한 스타일링 옵션을 제공합니다. Matplotlib의 `plt.figure`를 사용하여 새로운 Figure 객체를 생성하고, Seaborn의 `sns.lineplot` 함수를 사용하여 주어진 데이터를 선 그래프로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns

fig = plt.figure(figsize=(10, 6))
sns.lineplot(data=None, x=None, y=None, style=None,
             palette=None, marker=None, label=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `data` : 차트에 사용할 데이터를 입력합니다. 주로 데이터프레임(DataFrame) 형식의 데이터를 사용하며, 열(column)에 따라 막대 그래프가 그려집니다.
- `x` : x축 데이터를 지정합니다. 이름 또는 인덱스로 지정할 수 있습니다.
- `y` : y축 데이터를 지정합니다. 이름 또는 인덱스로 지정할 수 있습니다.
- `style`(str, None) : 그래프의 스타일을 지정합니다. 스타일 종류는 "darkgrid", "whitegrid", "dark", "white", "ticks" 등이 있습니다.
  - darkgrid : 시각화 그래프의 배경을 어두운색으로 설정하고, 격자 라인을 추가합니다.
  - whitegrid : 시각화 그래프의 배경을 밝은색으로 설정하고, 격자 라인을 추가합니다.
  - dark : 시각화 그래프의 배경과 요소들을 어두운색으로 설정합니다.
  - white : 시각화 그래프의 배경과 요소들을 밝은색으로 설정합니다.
- `palette`(str, None) : 선의 색상 팔레트를 지정합니다. 기존 팔레트와 사용자 정의 팔레트를 선택할 수 있습니다. 팔레트는 "deep", "pastel", "bright", "dark", "Set1", "Set2" 등이 있습니다.
  - deep : 진한 색상을 가지고 있어 주로 데이터 강조나 대비를 위해 사용합니다.
  - pastel : 연한 색상을 가지고 있어, 부드러운 데이터의 변화를 나타내고자 할 때 사용합니다.
  - bright : 선명하고 밝은 색상을 가지고 있어 주로 데이터 강조 시 사용합니다.
  - dark : 어두운 색상으로 주로 데이터의 형태나 구조를 강조하는 데 사용합니다.
  - Set1 : 9가지 서로 다른 색조를 가진 팔레트로 다양한 데이터 범주를 시각적으로 구분 시 사용합니다.
  - Set2 : Set1과 유사하지만 다른 색상 조합을 제공하여 데이터 구분을 가능하게 합니다.
- `marker`(str, None) : 그래프 안에 있는 데이터의 포인트를 표시 가능하게 해주는 마커의 종류를 지정합니다. 마커의 종류는 원("o"), 사각형("s"), 세모("^") 등이 있습니다.
- `label` : 그래프의 범례에 표시될 항목의 이름을 지정합니다. 범례는 그래프에 사용된 데이터 열을 설명하는데 사용됩니다. 여러 개의 그래프를 한 번에 표현하고 싶을 때 `label`을 지정해 주면 어떤 그래프인지 파악할 수 있습니다.

<br>

**예시 1**

다음 예시는 Seaborn 라이브러리를 사용하여 연도별 판매 추이를 시각화합니다. 트렌드를 선 그래프로 표현할 수 있도록 "Sales", "Revenue"에 연속형 데이터를 입력하여 데이터프레임을 생성합니다. Seaborn의 `set_palette` 함수를 "Set2"로 지정합니다. `sns.lineplot`을 이용하여 `x`에는 연도 데이터가 있는 컬럼명을, `y`에는 판매 데이터가 있는 컬럼명을 입력하고 `st.pyplot`을 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import seaborn as sns
import pandas as pd
import matplotlib.pyplot as plt

data = {"Year": [2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023],
        "Sales": [100, 150, 200, 180, 150, 130, 200, 250, 270],
        "Revenue": [50, 80, 120, 90, 100, 80, 150, 200, 220]}
df = pd.DataFrame(data)

sns.set_palette("Set2")
fig = plt.figure(figsize=(10, 6))

# 다중 라인 그래프 그리기
sns.lineplot(x="Year", y="Sales", data=df, marker="o", label="Sales")
sns.lineplot(x="Year", y="Revenue", data=df, marker="o", label="Revenue")

plt.title("Sales and Revenue Trend")
plt.xlabel("Year")
plt.ylabel("Amount")
plt.legend()

st.pyplot(fig)
```

![Untitled](/images/streamlit/chapter02/part03/Untitled%201.png)

<br>

### **Bar Chart(Matplotlib 라이브러리 활용)**

Matplotlib은 Python의 데이터 시각화 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있는 강력한 도구입니다. Matplotlib의 `plt.bar`를 사용하여 주어진 데이터를 막대 그래프로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

이때, `plt.bar`를 사용하여 막대 그래프의 스타일, 색상, 레이블, 제목 등 외관을 원하는 대로 자유롭게 설정할 수 있습니다. 또한 여러 개의 막대를 동시에 표시하는 것과 막대를 그룹화해서 비교 분석할 수 있는 기능을 제공합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt

plt.bar(x, height, width=0.8, bottom=None, *,
        align="center", data=None, **kwargs)
st.pyplot(plt)
```

<br>

**매개변수**

- `x`(float, array) : 막대 그래프의 x 좌표입니다. 각 막대의 위치를 나타내는 값으로 사용됩니다. 주로 숫자, 문자열, 또는 범주형 데이터가 될 수 있습니다.
- `height`(float, array) : 차트의 세로 너비(높이)입니다. 막대의 크기를 나타내는 값으로 사용됩니다. 주로 숫자로 표현되는 데이터가 될 수 있습니다.
- `width`(float, array) : 차트의 가로 너비입니다. 기본값은 0.8입니다.
- `bottom`(float, array) : 막대 그래프의 맨 아래 위치를 나타내는 값입니다. 주로 누적 막대 그래프를 그릴 때 사용됩니다.
- `align` : 막대 그래프의 막대 위치를 정렬하는 방법을 지정합니다.
  - center(기본값) : 막대가 x 좌표 상의 중앙에 정렬됩니다.
  - edge : 막대의 왼쪽 끝이 x 좌표 상의 위치에 오도록 지정합니다.
- `data` : 막대 그래프를 그릴 때 사용할 데이터를 입력합니다. 해당 데이터는 배열(Array), 시리즈(Series), 또는 데이터프레임(DataFrame) 또는 데이터가 저장된 파일 등 다양한 형식이 될 수 있습니다.
- `**kwargs` \*\*\*\*: 추가적인 그래프 속성 및 스타일을 지정하기 위한 키워드 인수입니다. 예를 들어, 색상, 투명도, 라벨 등을 설정할 수 있습니다.

<br>

**예시 1**

다음 예시는 너비 0.5의 중앙 정렬한 “lightblue” 색상 막대 그래프입니다. `plt.bar`로 막대 그래프를 생성한 뒤 `st.pyplot`을 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt

# 데이터셋 생성
x = ['A', 'B', 'C', 'D']
data = [10, 15, 7, 12]

# 막대 그래프 생성
plt.bar(x, data, width=0.5 , align="center", color="lightblue")
st.pyplot(plt)
```

![스크린샷 2025-04-08 오후 4.09.43.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.09.43.png)

<br>

### **Bar Chart(Seaborn 라이브러리 활용)**

Seaborn은 Matplotlib의 기능을 기반으로 한 데이터 시각화 라이브러리로, Matplotlib에 비해 더 간편한 구문과 다양한 스타일링 옵션을 제공합니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. Seaborn의 `sns.barplot` 함수를 사용하여 주어진 데이터를 막대 그래프로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns

fig, ax = plt.subplots()
sns.barplot(data=None, *, x=None, y=None, hue=None, color=None, palette=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `data` : 막대 그래프를 그릴 때 사용할 데이터를 입력합니다. 주로 데이터프레임(DataFrame) 형식의 데이터를 사용하며, 열(column)에 따라 막대 그래프가 그려집니다.
- `x` : x축에 입력할 배열(array) 또는 데이터 열입니다. `data` 매개변수를 전달하지 않은 경우에만 필요합니다.
- `y` : y축에 입력할 배열(array) 또는 데이터 열입니다. `data` 매개변수를 전달하지 않은 경우에만 필요합니다.
- `hue` : 데이터를 그룹화하는 기준 열을 지정합니다. 그룹화된 데이터는 막대 그래프의 색상을 구분하는 데 사용됩니다.
- `color` : 막대 그래프의 색상을 지정합니다. 단일 색상 또는 RGB 값을 사용할 수 있습니다.
- `palette`(list, dict): 막대 그래프의 색상 팔레트를 지정합니다. Seaborn 팔레트 이름, Matplotlib 컬러 맵 또는 Seaborn 색상 팔레트 객체를 사용할 수 있습니다.

<br>

**예시 1**

다음 예시는 `sns.barplot`을 사용하여 막대 차트를 생성하고 `st.pyplot`을 사용하여 차트를 시각화합니다. `color`는 “#A8468A”로 지정하고 `x`에는 점수, `y`에는 연도를 전달합니다. `plt.xlim`을 통해 x축 범위를 55부터 100으로 지정합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

# 맥OS의 경우
plt.rc('font', family='AppleGothic')

# 윈도우의 경우
# plt.rc('font', family='Malgun Gothic')
# plt.rc('font', family='NanumGothic')

plt.rcParams['axes.unicode_minus'] = False

# 연도별 점수 데이터셋 설정
plt.figure(figsize=(10, 10))
goal = [65, 60, 75, 80, 95]
year = ["2019", "2020", "2021", "2022", "2023"]

# 차트 생성
sns.barplot(x=goal, y=year, color="#A8468A")

#차트 제목, x축 범위, 레이블명 설정
plt.title("연도별 점수 변화")
plt.xlim(55, 100)
plt.xlabel("점수")
plt.ylabel("연도")

st.pyplot(plt)
```

![스크린샷 2023-06-25 오후 5.16.04.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-06-25_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_5.16.04.png)

<br>

### **Pie Chart(Matplotlib 라이브러리 활용)**

Matplotlib은 Python의 데이터 시각화 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있는 강력한 도구입니다. Matplotlib의 `plt.pie`를 사용하여 주어진 데이터로 파이 차트를 그리고, `plt.gcf`를 사용하여 차트를 가져옵니다. Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt

plt.pie(x, labels=None, colors=None, autopct=None, explode=None)
st.pyplot(plt)
```

`plt.subplots`를 사용한 파이 차트 생성 방법입니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. `ax.pie`를 사용하여 주어진 데이터를 파이 차트로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt

fig, ax = plt.subplots()
ax.pie(x, labels=None, colors=None, autopct=None, radius=1, wedgeprops=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `x` : 파이 차트를 그릴 때 사용할 데이터를 입력합니다. 각 범주의 값들을 포함하는 배열(array) 또는 리스트입니다.
- `labels`(list) : 그래프의 범례에 표시될 항목의 이름을 지정합니다. 범례는 그래프에 사용된 데이터 열을 설명하는데 사용됩니다. 각 부분의 라벨(이름)을 지정해 주면 어떤 그래프인지 파악할 수 있습니다.
- `colors`(array) \*\*\*\*: 각 부분의 색상을 지정합니다.
- `autopct`(str) : 부분의 퍼센트 값을 표시하는 방식을 지정합니다.
- `explode`(array) : 특정 부분을 강조하기 위해 원의 중심에서 벗어나는 정도를 지정합니다.
- `radius`(float): 파이 차트의 반지름을 지정하는 값입니다. 기본값은 1로 반지름 길이 1을 나타냅니다.
- `wedgeprops` : 파이 차트 부채꼴의 속성을 지정하는 딕셔너리니다. 주로 구멍을 생성하기 위해 `width`와 `edgecolor` 속성을 사용합니다.
  - `width` : 파이 차트 중심으로부터 구멍의 크기를 결정합니다. 1은 구멍이 없는 원형 파이 차트를 의미하고, 0은 완전한 구멍이 있는 원을 의미합니다.
  - `edgecolor` : 구멍의 테두리 색상을 지정합니다.

<br>

**예시 1**

다음 예시는 `labels` 리스트와 `sizes` 리스트를 생성하여 랜덤한 데이터를 생성하여, `ax.pie`로 파이 그래프를 생성한 뒤 `st.pyplot`을 사용하여 파이 차트를 시각화합니다. `autopct`를 "%1.1f%%”으로 적용하여 소수점 1자리까지 표시하고, `sizes` 리스트에서 가장 작은 값을 찾아서 `explode`을 0.1으로 설정해 간격을 띄워줍니다.

```python
import random
import matplotlib.pyplot as plt
import streamlit as st

# 랜덤 데이터 생성
labels = ["A", "B", "C", "D"]
sizes = [random.randint(1, 100) for _ in range(len(labels))]

# 그래프 그리기
fig, ax = plt.subplots()
ax.pie(sizes, labels=["A", "B", "C", "D"] ,
       colors= ["lightsteelblue", "thistle", "bisque", "lightsalmon"],
       autopct="%1.1f%%",
       explode=[0 if s != min(sizes) else 0.1 for s in sizes])

# 그래프 출력
st.pyplot(fig)
```

![Untitled](/images/streamlit/chapter02/part03/Untitled%202.png)

<br>

**예시 2**

다음 예시는 `ax.pie`로 파이 그래프를 생성한 뒤 `st.pyplot`을 사용하여 파이 차트를 시각화합니다. `autopct`를 "%0.0f%%”로 설정하여 각 영역에 일의 자리의 퍼센트 값을 설정하고, `radius`를 1로 반지름을 설정합니다. `wedgeprops`의 `width`를 0.8로 설정하여 파이 차트 중앙에 구멍을 표시합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns

#매개변수 설정
x = [30, 20, 10, 40]
labels = ["A", "B", "C", "D"]
colors = ["lightsteelblue", "thistle", "bisque", "lightsalmon"]
autopct = "%0.0f%%"

#파이차트 생성
fig, ax = plt.subplots()
ax.pie(x, labels=labels, colors=colors, autopct=autopct, radius=1,
       wedgeprops=dict(width=0.7, edgecolor="w"))
ax.axis("equal")

st.pyplot(fig)
```

![Untitled](/images/streamlit/chapter02/part03/Untitled%203.png)

<br>

### **Histogram(Matplotlib 라이브러리 활용)**

Matplotlib은 Python의 데이터 시각화 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있는 강력한 도구입니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. `ax.hist`를 사용하여 주어진 데이터를 Histogram로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt

fig, ax = plt.subplots()
ax.hist(x, bins=None, color=None, alpha=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `x` : Histogram을 그릴 때 사용할 데이터를 입력합니다. 해당 데이터는 배열(array), 리스트(list), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `bins`(int) : Histogram의 구간 개수를 지정합니다.
- `color`(str, None) : 막대의 색상을 지정합니다.
- `alpha`(float) : 막대의 투명도를 나타내며, 0(투명)부터 1(불투명) 사이의 값을 지정합니다.
  - 0(기본값) : 완전히 투명한 상태입니다.

<br>

**예시 1**

다음 예시는 arr 변수에 랜덤한 값을 가지는 배열을 생성하여 `ax.hist`를 사용하여 Histogram 차트를 생성하고 `st.pyplot`을 사용하여 파이 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import numpy as np

arr = np.random.normal(1, 1, size=100)
fig, ax = plt.subplots()
ax.hist(arr, bins=20)

st.pyplot(fig)
```

![스크린샷 2025-04-11 오후 4.56.36.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-11_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.56.36.png)

<br>

**예시 2**

다음 예시는 NumPy와 Matplotlib을 사용하여 Histogram을 생성하는 예시입니다. `ax.hist`를 사용하여 Histogram을 생성하고 `st.pyplot`을 사용하여 Histogram을 시각화합니다. `bins`를 20으로 설정하여 20개의 구간으로 Histogram을 나누고, `color`를 “skyblue”로 설정하여 막대의 색상을 하늘색으로 지정합니다. `alpha`를 0.7로 설정하여 투명도를 지정하였습니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import numpy as np

arr = np.random.normal(1, 1, size=100)
fig, ax = plt.subplots()
ax.hist(arr, bins=20, color="skyblue", alpha=0.7)
st.pyplot(fig)
```

![스크린샷 2023-06-20 오후 5.20.34.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-06-20_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_5.20.34.png)

<br>

### **Histogram(Seaborn 라이브러리 활용)**

Seaborn은 Matplotlib의 기능을 기반으로 한 데이터 시각화 라이브러리로, Matplotlib에 비해 더 간편한 구문과 다양한 스타일링 옵션을 제공합니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. Seaborn의 `sns.histplot` 함수를 사용하여 주어진 데이터를 Histogram으로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns

fig, ax = plt.subplots()
sns.histplot(data, bins=None, color=None, kde=False)
st.pyplot(fig)
```

<br>

**매개변수**

- `data` : Histogram을 그릴 때 사용할 데이터를 입력합니다. 해당 데이터는 배열(array), 리스트(list), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `bins`(int) : Histogram의 구간 개수를 지정합니다.
- `color`(str, None) : 막대의 색상을 지정합니다.
- `kde`(bool) : 커널 밀도 추정(Kernel Density Estimation)을 활성화시킬지 여부를 지정합니다.
  - True : 커널 밀도 추정(Kernel Density Estimation) 활성화
  - False(기본값) : 커널 밀도 추정(Kernel Density Estimation) 비활성화

<br>

**예시 1**

다음 예시는 `bins`를 20으로 설정하여 20개의 구간으로 나누고, `sns.histplot`로 Histogram을 생성한 뒤 `st.pyplot`을 사용하여 Histogram을 시각화합니다. `color`를 “pink”로 설정하여 막대의 색상을 분홍색, `kde`를 True로 설정하여 커널 밀도 추정을 활성화로 지정하였습니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

arr = np.random.normal(1, 1, size=100)
fig, ax = plt.subplots()
fig = plt.figure(figsize=(10,4))
sns.histplot(arr, bins=20, color="pink", kde=True)
st.pyplot(fig)
```

![스크린샷 2023-06-20 오후 5.20.46.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-06-20_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_5.20.46.png)

<br>

### **Scatter Plot(Matplotlib 라이브러리 활용)**

Matplotlib은 Python의 데이터 시각화 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있는 강력한 도구입니다. Matplotlib의 `plt.scatter`를 사용하여 주어진 데이터로 스캐터 플롯을 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt

plt.figure(figsize=(10,5))
plt.scatter(x, y, s=None, c=None, marker=None, alpha=None)
st.pyplot(plt)
```

<br>

**매개변수**

- `x` : x축에 입력할 배열(Array) 또는 리스트(List)입니다.
- `y` : y축에 입력할 배열(Array) 또는 리스트(List)입니다.
- `s`(float, None) : 각 점을 나타내는 원의 크기입니다.
- `color`(str, None) : 점의 색상을 지정합니다.
- `marker`(str, None) : 그래프 안에 있는 데이터의 포인트를 표시 가능하게 해주는 마커의 종류를 지정합니다. 마커의 종류는 원("o"), 사각형("s"), 세모("^") 등이 있습니다.
- `alpha`(float, None) : 점의 투명도를 나타내며, 0(투명)부터 1(불투명) 사이의 값을 지정합니다.
  - 0(기본값) : 완전히 투명한 상태입니다.

<br>

**예시 1**

다음 예시는 `plt.scatter`를 사용하여 스캐터 플롯을 만들고 `st.pyplot`을 사용하여 차트를 시각화합니다. 각 차트는 상관관계를 시각화합니다.

```python
import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
import koreanize_matplotlib

# 랜덤한 데이터 만들기
np.random.seed(10)
x = np.random.rand(100)
y = np.random.rand(100)

x_positive = np.random.rand(100)
y_positive = 1.5 * x_positive + np.random.rand(100)
x_negative = np.random.rand(100)
y_negative = -1.5 * x_negative + np.random.rand(100)

plt.figure(figsize = (15,6))

# 상관관계를 갖지 않는 산점도
plt.subplot(1,3,1)
plt.scatter(x, y, color = "orange", alpha = 0.7)
plt.xlabel("X축의 값")
plt.ylabel("Y축의 값")
plt.title("산점도")

# 양의 상관관계를 갖는 산점도
plt.subplot(1,3,2)
plt.scatter(x_positive, y_positive, color = "red", alpha = 0.7)
plt.xlabel("X축의 값")
plt.ylabel("Y축의 값")
plt.title("양의 상관관계를 가지는 산점도")

# 음의 상관관계를 갖는 산점도
plt.subplot(1,3,3)
plt.scatter(x_negative, y_negative, alpha = 0.7)
plt.xlabel("X축의 값")
plt.ylabel("Y축의 값")
plt.title("음의 상관관계를 가지는 산점도")
st.pyplot(plt)
```

![Untitled](/images/streamlit/chapter02/part03/Untitled%204.png)

<br>

### **Box Plot(Matplotlib 라이브러리 활용)**

Matplotlib은 Python의 데이터 시각화 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있는 강력한 도구입니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. `ax.boxplot`을 사용하여 주어진 데이터를 상자 수염도로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

상자 수염도는 주로 데이터의 분포와 이상치를 식별하고 데이터의 정상 범위를 파악하는 데 도움을 줍니다. 최솟값, 최댓값, 중앙값, 사분위수 등 통계 정보를 함께 제공하기 때문데 그룹 간 차이점을 쉽게 파악할 수 있어 시계열 데이터의 변동성과 패턴을 시각화하여 계절성 추이를 파악할 수 있습니다.

```python
import streamlit as st
import matplotlib as plt

fig, ax = plt.subplots()
ax.boxplot(x, notch=None, sym=None, vert=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `x` : 상자 수염도를 그릴 때 사용할 데이터를 입력합니다. 해당 데이터는 배열(array), 리스트(list), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `notch`(bool, None) : 상자 수염도의 중앙에 있는 홈 모양의 부분을 그릴지 여부를 지정합니다.
  - True : 상자 수염도의 중앙에 있는 홈 모양의 부분이 그려집니다.
  - False(기본값) : 상자 수염도의 중앙에 홈 모양이 그려지지 않습니다.
- `sym`(str, None) : 이상치를 나타내는 기호를 지정합니다.
- `vert`(bool, None) : 상자 수염도의 방향을 지정합니다.
  - True(기본값) : 상자 수염도의 방향이 수직(세로)로 그려집니다.
  - False : 상자 수염도의 방향이 수평(가로)로 그려집니다.

<br>

**예시 1**

다음 예시는 `ax.boxplot`를 사용하여 스캐터 플롯을 만들고 `st.pyplot`을 사용하여 차트를 시각화합니다. `notch`를 True로 설정하여 중앙 부분을 홈 모양으로 만들고, `sym`을 “rs”로 설정하여 이상치를 붉은색 사각형으로 보이게 설정합니다. 또한, `vert`를 True로 설정하여 상자 수염도를 수직 방향으로 생성합니다.

```python
import streamlit as st
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

data = np.random.randn(100, 9)
df = pd.DataFrame(data, columns=["S", "T", "R", "E", "A", "M", "L", "I", "T"])

fig, ax = plt.subplots()
ax.boxplot(x=data, notch=True, sym="rs", vert=True)
ax.set_xticklabels(df.columns)
ax.set_ylabel("value")
st.pyplot(fig, clear_figure=True, use_container_width=False)
```

![Untitled](/images/streamlit/chapter02/part03/Untitled%205.png)

<br>

### **Boxplot(Seaborn 라이브러리 활용)**

Seaborn은 Matplotlib의 기능을 기반으로 한 데이터 시각화 라이브러리로, Matplotlib에 비해 더 간편한 구문과 다양한 스타일링 옵션을 제공합니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. Seaborn의 `sns.boxplot` 함수를 사용하여 주어진 데이터를 상자 수염도로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

Box plot은 주로 데이터의 분포와 이상치를 식별하고 데이터의 정상 범위를 파악하는 데 도움을 줍니다. 최솟값, 최댓값, 중앙값, 사분위수 등 통계 정보를 함께 제공하기 때문데 그룹 간 차이점을 쉽게 파악할 수 있어 시계열 데이터의 변동성과 패턴을 시각화하여 계절성 추이를 파악할 수 있습니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns

fig, ax = plt.subplots()
sns.boxplot(data=None, orient=None, width=None, notch=None,
            sym=None, palette=None, linewidth=None, whis=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `data` : 상자 수염도를 그릴 때 사용할 데이터를 입력합니다. 해당 데이터는 배열(array), 리스트(list), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `orient`(str, None) : 상자 수염도의 방향을 지정합니다.
  - “v”(기본값) : 상자 수염도의 방향을 수직(세로)로 그려집니다.
  - “h” : 상자 수염도의 방향을 수평(가로)로 그려집니다.
- `width`(int, None) : 상자 수염도의 너비를 나타내며, 0부터 1사이의 값을 지정합니다.
- `notch`(bool, None) : 상자 수염도의 중앙에 있는 홈 모양의 부분을 그릴지 여부를 결정합니다.
  - True : 상자 수염도의 중앙에 있는 홈 모양의 부분이 그려집니다.
  - False(기본값) : 상자 수염도의 중앙에 홈 모양이 그려지지 않습니다.
- `sym`(str, None) : 이상치를 나타내는 기호를 지정합니다.
- `palette`(str, None) : 상자 수염도에 사용할 색상 팔레트를 지정합니다.
- `linewidth`(int, None) : 상자 수염도의 테두리 두께를 지정합니다.
- `whis`(int, None) : 상자 수염도의 극단치 경곗값을 사분위 범위를 의미하는 IQR(Interquartile range)의 몇 배수로 설정할지 지정합니다.

<br>

**예시 1**

다음 예시는 `sns.boxplot`를 사용하여 상자 수염도를 만들고 `st.pyplot`을 사용하여 차트를 시각화합니다. `width`를 0.3으로 설정하여 상자 수염도의 너비를 지정하고 `palette`는 Seaborn 라이브러리의 내장 색상 팔레트 중 하나인 “Set3”을 설정합니다. `orient`를 “h”로 설정하여 상자 수염도를 수평 방향으로 생성합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# 데이터 생성
data = np.random.normal(0, 1, size=(100, 6))
df = pd.DataFrame(data, columns=["S", "T", "R", "E", "A", "M"])

# 그래프 생성
fig, ax = plt.subplots()
sns.boxplot(data=df, orient="h", width=0.3, palette ="Set3")

st.pyplot(fig)
```

![스크린샷 2023-07-13 오후 6.29.29.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_6.29.29.png)

<br>

### **Heatmap(Matplotlib 라이브러리 활용)**

Matplotlib은 Python의 데이터 시각화 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있는 강력한 도구입니다. Matplotlib의 `ax.imshow`를 사용하여 주어진 데이터로 Heatmap을 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

Heatmap은 데이터 값을 색상으로 표시하여 행과 열을 가진 표 형태의 데이터를 시각화하는 방법입니다. Streamlit에서 Heatmap을 구현하기 위해 별도의 내장 함수는 제공되지 않습니다. 각 데이터 값은 색상으로 표시되며, 값이 클수록 더 진한 색상으로 표현입니다. Heatmap은 데이터의 패턴, 상관관계, 집중도 등을 시각적으로 파악하는데 도움이 됩니다. Streamlit에서는 Matplotlib, Seaborn, Plotly와 같은 다양한 라이브러리를 활용하여 Heatmap을 시각화할 수 있습니다.

```python
import streamlit as st
import matplotlib.pyplot as plt

fig, ax = plt.subplots()
ax.imshow(X, cmap=None, interpolation=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `X` : Heatmap를 그릴 때 사용할 데이터를 입력합니다. 해당 데이터는 배열(array), 리스트(list), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `cmap`(str, None) : Heatmap의 컬러 맵을 지정합니다.
- `interpolation`(str, None) : 데이터의 보간 방법을 지정합니다.
  - None : 보간 방법 지정 안함
  - nearest : 가장 가까운 픽셀값으로 보간
  - bilinear : 선형 보간(더 부드러워 보임)

<br>

**예시 1**

다음 예시는 `ax.imshow`를 사용하여 Heatmap을 만들고 `st.pyplot`을 사용하여 차트를 시각화합니다. `cmap`를 “hot”으로 설정하여 색상을 붉은색으로 지정하고, `interpolation`를 ”nearest”으로 설정하여 인접한 픽셀의 값을 사용하여 보간하여 부드럽게 Heatmap을 시각화합니다.

```python
import streamlit as st
import numpy as np
import matplotlib.pyplot as plt

data = np.random.rand(10, 10)
fig, ax = plt.subplots()
ax.imshow(data, cmap="hot", interpolation="nearest")
st.pyplot(fig)
```

![스크린샷 2023-07-10 오후 10.45.53.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-10_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.45.53.png)

<br>

### **Heatmap(Seaborn 라이브러리 활용)**

Seaborn은 Matplotlib의 기능을 기반으로 한 데이터 시각화 라이브러리로, Matplotlib에 비해 더 간편한 구문과 다양한 스타일링 옵션을 제공합니다. Matplotlib의 `plt.subplots`을 사용하여 Figure 객체와 Axes 객체를 생성합니다. `fig`에는 Figure 객체가 할당되고, `ax`에는 Axes 객체가 할당됩니다. Seaborn의 `sns.heatmap` 함수를 사용하여 주어진 데이터를 Heatmap으로 그린 다음, Matplotlib의 `plt` 객체를 `st.pyplot`에 전달하여 차트를 시각화합니다.

Heatmap은 데이터 값을 색상으로 표시하여 행과 열을 가진 표 형태의 데이터를 시각화하는 방법입니다. Streamlit에서 heatmap을 구현하기 위해 별도의 내장 함수는 제공되지 않습니다. 각 데이터 값은 색상으로 표시되며, 값이 클수록 더 진한 색상으로 표현입니다. Heatmap은 데이터의 패턴, 상관관계, 집중도 등을 시각적으로 파악하는 데 도움이 됩니다. Streamlit에서는 Matplotlib, Seaborn, Plotly와 같은 다양한 라이브러리를 활용하여 heatmap을 시각화할 수 있습니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns

fig, ax= plt.subplots()
sns.heatmap(data, annot=None, fmt=None, cmap=None, cbar=None, square=None)
st.pyplot(fig)
```

<br>

**매개변수**

- `data` : Heatmap를 그릴 때 사용할 데이터를 입력합니다. 해당 데이터는 배열(array), 리스트(list), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `annot`(bool, None) : 각 셀에 숫자 값을 표시할지 여부를 지정합니다.
  - True : 각 셀에 숫자 값을 표시합니다.
  - False(기본값) : 각 셀에 숫자 값을 표시하지 않습니다.
- `fmt`(str, None) : `annot`이 True로 설정된 경우 숫자 값을 표시할 때 사용되는 형식 문자열입니다.
- `cmap`(str, None) : Heatmap의 컬러 맵을 지정합니다.
- `square`(bool, None) : 각 셀의 모양을 정사각형으로 표시할지 여부를 지정합니다.
  - True : 각 셀을 정사각형으로 표시합니다.
  - False(가본값) : 각 셀을 정사각형으로 표시하지 않습니다.

<br>

**예시 1**

다음 예시는 `sns.heatmap`을 사용하여 Heatmap을 만들고 `st.pyplot`을 사용하여 차트를 시각화합니다. `annot`를 True로 설정하여 숫자 값을 Heatmap에 주석으로 표시하고, `fmt`를 “.2f”로 설정하여 주석 값의 소수점 2자리까지 표시합니다. `cmap`를 “hot”으로 설정하고, `square`를 True로 설정하여 정사각형 모양으로 Heatmap을 생성합니다.

```python
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

data = np.random.rand(10, 10)
fig, ax = plt.subplots()
sns.heatmap(data, annot=True, fmt=".2f", cmap="hot", square=True)
st.pyplot(fig)
```

![스크린샷 2023-07-10 오후 10.42.59.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-10_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.42.59.png)

<br>

## **st.plotly_chart**

`st.plotly_chart`는 Python 차트 라이브러리 Plotly의 plot() 함수의 인수를 거의 그대로 따르며, 대화형 Plotly 차트를 표시합니다. Streamlit에서 Plotly 차트를 시각화하려면 Plotly의 py.plot 또는 py.iplot을 호출할 때마다 `st.plotly_chart`를 사용하시면 됩니다. `st.plotly_chart`를 사용하려면 plotly를 설치하셔야 합니다. orjson을 함께 설치하면 앱의 성능이 향상될 수 있습니다.

```bash
pip install plotly
```

```python
st.plotly_chart(figure_or_data, use_container_width=True, *, theme="streamlit", key=None, on_select="ignore", selection_mode=('points', 'box', 'lasso'), **kwargs)
```

<br>

**매개변수**

- `figure_or_data`(plotly.graph_objs.Figure, plotly.graph_objs.Data, dict/list of plotly.graph_objs.Figure/Data) : 렌더링할 Plotly 그림 또는 데이터 객체입니다.
- `use_container_width`(bool) : 그림의 기본 너비를 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 그림의 기본 너비를 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False(기본값) : 그림 너비를 plotting 라이브러리에 따라 설정하되, 그림 너비가 너무 크면 부모(상위) 컨테이너 너비까지 콘텐츠에 맞게 설정합니다.
- `theme`("streamlit", None, Keyword only) : 차트의 테마를 설정합니다.
  - "streamlit"(기본값) : Streamlit의 기본 디자인을 사용합니다.
  - None : Plotly의 기본 디자인을 사용합니다.
- `key`(str, Keyword only) : 차트의 고유키로 사용할 문자열로 요소에 ID를 부여하는데 사용합니다. 두 위젯의 키가 같을 수는 없기 때문에 None(기본값)인 경우 요소의 ID는 다른 파라미터의 값 또는 차트의 콘텐츠에 따라 차트의 키가 생성됩니다.
  또한, `selection_mode`가 설정되어 선택 기능이 활성화되고 `key`가 제공되면, Streamlit은 세션 상태에 해당 `key`를 등록하여 사용자의 선택 상태를 저장합니다. 이때, 선택 상태는 읽기 전용으로, 코드에서 직접 수정할 수 없고 사용자의 상호작용으로만 변경됩니다.
- `on_select`("ignore", "rerun", callable, Keyword only) : 그림이 사용자 선택 이벤트에 응답하는 방식입니다. 그림이 입력 위젯처럼 작동할지 여부를 제어합니다.
  - "ignore"(기본값) : 차트의 선택 이벤트에 반응하지 않습니다. 그림이 입력 위젯처럼 동작하지 않습니다.
  - "rerun" : 차트에서 데이터를 선택하면 앱을 다시 실행합니다. 이 경우 `st.plotly_chart`는 선택된 데이터를 딕셔너리로 반환합니다.
  - callable : 앱을 다시 실행하고 callable을 앱의 나머지 부분보다 먼저 콜백 함수로 실행합니다. 이 경우 `st.plotly_chart`은 선택된 데이터를 딕셔너리로 반환합니다.
- `selection_mode`("points", "box", "lasso", an Iterable of these, Keyword only) : 차트의 select 모드입니다.
  - points : 차트에서 개별 데이터 포인트를 기준으로 선택할 수 있습니다.
  - box : 차트에서 직사각형 영역을 기준으로 선택할 수 있습니다.
  - lasso : 차트에서 자유형 영역을 기준으로 선택할 수 있습니다.
  - single-column : 한 번에 하나의 열만 선택할 수 있습니다.
  - Iterable of these : 차트에서 지정된 모드에 따라 선택할 수 있습니다. 모든 `selection_mode`는 기본적으로 활성화되어 있습니다.
- `**kwargs`(null, Keyword only) : Plotly의 plot() 함수에 전달할 인수입니다.

<br>

**반환값**

- on_select="ignore"(기본값) 일 때, 차트 요소에 대한 내부 자리 표시자(placeholder)를 반환합니다.
  :::div{.callout}

  내부 자리 표시자는 UI 요소가 화면에 배치될 위치를 지정하고, 이후에 해당 요소를 조작할 수 있게 하는 참조 객체입니다.

  :::

- 그 밖의 경우 딕셔너리와 유사한 객체(element, dict)를 반환합니다. 이 객체는 다음 두 가지 방법으로 접근할 수 있으며, 객체의 속성들은 PlotlyState 딕셔너리 스키마에 정의되어 있습니다.
  - 키 표기법 : result["속성이름"]
  - 속성 표기법 : result.속성이름

<br>

**예제 1**

다음 예시는 `plotly.figure_factory`의 `create_distplot`을 사용하여 여러 그룹의 분포를 시각화한 히스토그램과 커널 밀도 추정(KDE) 차트를 생성합니다. `np.random.randn`을 이용해 정규 분포를 따르는 세 개의 데이터 그룹을 만들고, 이를 리스트 형태로 묶은 후 `group_labels`로 각 그룹에 이름을 부여합니다. `bin_size` 매개변수를 `[.1, .25, .5]`로 설정하여 그룹별로 다른 bin 크기를 지정하고, KDE 곡선과 함께 각 그룹의 히스토그램을 시각화합니다. 생성된 Plotly Figure 객체는 `st.plotly_chart`를 사용하여 Streamlit 앱에 출력됩니다.

이때 `create_distplot`은 커널 밀도 추정 곡선을 계산할 때 `scipy.stats.gaussian_kde`를 내부적으로 사용하기 때문에, 이 기능을 실행하려면 `scipy` 라이브러리가 사전에 설치되어 있어야 합니다. 설치되지 않은 경우 ModuleNotFoundError: No module named 'scipy' 오류가 발생할 수 있으므로, pip install scipy 명령어로 별도 설치가 필요합니다.

```python
import streamlit as st
import numpy as np
import plotly.figure_factory as ff

# Add histogram data
x1 = np.random.randn(200) - 2
x2 = np.random.randn(200)
x3 = np.random.randn(200) + 2

# Group data together
hist_data = [x1, x2, x3]

group_labels = ['Group 1', 'Group 2', 'Group 3']

# Create distplot with custom bin_size
fig = ff.create_distplot(
        hist_data, group_labels, bin_size=[.1, .25, .5])

st.plotly_chart(fig)
```

![스크린샷 2025-05-08 오후 5.41.57.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.41.57.png)

<br>

**예제 2**

다음 예시는 Chart selections-PlotlyState를 사용하여 차트를 시각화하는 방법을 보여줍니다. Chart selections-PlotlyState는 Plotly 차트 선택 상태의 스키마로 선택 상태는 키 및 속성 표기법을 모두 지원하는 딕셔너리와 같은 객체에 저장됩니다. 선택 상태는 세션 상태를 통해 프로그래밍 방식으로 변경하거나 설정할 수 없으며, 현재 선택 이벤트만 지원됩니다.

<br>

**매개변수**

- `selection`(dict) : `on_select` 이벤트의 상태입니다. `selection`은 키 및 속성 표기법을 모두 지원하는 딕셔너리형 객체를 반환합니다. 속성은 PlotlySelectionState 딕셔너리 스키마에 의해 설명됩니다.
  - `points`(list[dict[str, Any]]) : 상자 및 올가미 모드로 선택한 데이터 포인트를 포함하여 차트에서 선택한 데이터 포인트입니다. 데이터에는 각 포인트에 연결된 값과 `point_indices`를 채우는 데 사용되는 포인트 인덱스가 포함됩니다. 포인트에 크기 또는 범례 그룹과 같은 추가 정보가 할당된 경우 이 정보도 포함됩니다.
  - `point_indices`(list[int]) : 차트에서 선택한 모든 데이터 포인트의 숫자 인덱스입니다. 식별된 각 포인트의 세부 정보가 포인트에 포함됩니다.
  - `box`(list[dict[str, Any]]) : 상자 선택과 관련된 메타 데이터입니다. 여기에는 선택한 영역의 좌표가 포함됩니다.
  - `lasso`(list[dict[str, Any]]) : 올가미 선택과 관련된 메타 데이터입니다. 여기에는 선택한 영역의 좌표가 포함됩니다.

사용 가능한 세 가지 방법(직접 클릭, 상자, 올가미) 중 하나로 포인트를 선택해 보세요. 현재 선택 상태는 세션 상태를 출력할 수 있습니다.

```python
import streamlit as st
import plotly.express as px

df = px.data.iris()  # iris is a pandas DataFrame
fig = px.scatter(df, x="sepal_width", y="sepal_length")

event = st.plotly_chart(fig, key="iris", on_select="rerun")

event
```

![스크린샷 2025-05-08 오후 5.58.34.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.58.34.png)

![직접 클릭](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.39.45.png)

![상자](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.41.17.png)

![올가미](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.41.03.png)

좀 더 복잡한 그래프로 작업할 때 포인트 속성은 추가 정보를 표시합니다.

```python
import streamlit as st
import plotly.express as px

df = px.data.iris()
fig = px.scatter(
    df,
    x="sepal_width",
    y="sepal_length",
    color="species",
    size="petal_length",
    hover_data=["petal_width"],
)

event = st.plotly_chart(fig, key="iris", on_select="rerun")

event.selection
```

단일 포인트를 선택할 때의 선택 상태입니다.

![스크린샷 2025-05-09 오전 9.45.47.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-09_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_9.45.47.png)

<br>

**예제 3**

Theming은 Plotly 차트의 시각적 스타일을 일관되게 정의하는 방법으로, 색상, 폰트, 레이아웃 등을 통합적으로 관리합니다.

다음 예시는 Streamlit 테마와 기본 Plotly 테마가 적용된 차트의 예를 살펴보겠습니다.

Plotly Chart는 기본적으로 Streamlit 테마를 사용하여 표시됩니다. 이 테마는 세련되고 사용자 친화적이며 Streamlit의 색상 팔레트가 통합되어 있습니다. 차트가 앱의 나머지 디자인과 더 잘 통합된다는 추가적인 이점이 있습니다. Streamlit 테마는 Streamlit 1.16.0부터 theme="streamlit" 키워드 인수를 통해 사용할 수 있습니다. 이 테마를 비활성화하고 Plotly의 기본 테마를 사용하려면 theme=None을 대신 사용하셔야 합니다.

```python
import plotly.express as px
import streamlit as st

df = px.data.gapminder()

fig = px.scatter(
    df.query("year==2007"),
    x="gdpPercap",
    y="lifeExp",
    size="pop",
    color="continent",
    hover_name="country",
    log_x=True,
    size_max=60,
)
```

아래 코드를 실행시켜 보시면 Streamlit 테마가 활성화 및 비활성화된 차트를 확인할 수 있습니다. 먼저, Streamlit 테마가 활성화된 코드를 살펴보면 기본적으로 Streamlit 테마가 활성화되어 있지만 차트 구성을 변경할 수 있으며, 사용자 지정 색상이나 글꼴로 덮어쓸 수 있습니다. 예를 들어 차트 선이 기본 빨간색 대신 녹색으로 표시할 수 있습니다.

```python
# chart 생성 코드
...

# Use the Streamlit theme.
# This is the default. So you can also omit the theme argument.
st.plotly_chart(fig, theme="streamlit", use_container_width=True)
```

![스크린샷 2025-05-09 오후 2.26.35.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.26.35.png)

테마가 비활성화된 경우(theme=None)에는 Plotly의 기본 테마가 사용됩니다. 이 모드에서는 Streamlit의 시각적 스타일이 적용되지 않고, 대신 Plotly의 기본 스타일링이 적용됩니다. 이는 특별한 시각적 요구사항이 있거나 Plotly의 기본 디자인 언어를 선호할 때 유용합니다. 아래 코드에서 보듯이 `theme=None` 매개변수를 설정하여 쉽게 이 모드로 전환할 수 있습니다.

```python
# chart 생성 코드
...

# Use the native Plotly theme.
st.plotly_chart(fig, theme=None, use_container_width=True)
```

![스크린샷 2025-05-09 오후 2.26.59.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.26.59.png)

다음 예시는 사용자 지정 색상 눈금이 정의되어 반영된 Plotly 차트입니다. Streamlit 테마가 활성화되어 있어도 사용자 지정 색상 눈금이 차트에 계속 반영되는 것을 확인할 수 있습니다.

```python
import plotly.express as px
import streamlit as st

st.subheader("사용자 지정 색상")
df = px.data.iris()
fig = px.scatter(
    df,
    x="sepal_width",
    y="sepal_length",
    color="sepal_length",
    color_continuous_scale="reds",
)

st.markdown("### Streamlit 테마 활성화")
st.plotly_chart(fig, theme="streamlit", use_container_width=True)

st.markdown("### Streamlit 테마 비활성화")
st.plotly_chart(fig, theme=None, use_container_width=True)
```

![스크린샷 2025-05-09 오후 2.28.51.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.28.51.png)

![스크린샷 2025-05-09 오후 2.28.04.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.28.04.png)

<br>

### **Area chart(Plotly 라이브러리 활용)**

Plotly는 Matplotlib나 Seaborn보다 더 다양한 인터랙티브 기능을 제공하여 상호작용적으로 데이터 탐색하거나 시각화 할 수 있도록 도와주는 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있습니다. Plotly 라이브러리의 `go.scatter`를 사용하고 `go.scatter`의 `fill`를 tozeroy나 tonexty로 설정하여 면적 그래프를 생성하고 `st.plotly_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import plotly.graph_objects as go

fig = go.Figure()
fig.add_trace(go.Scatter(x, y, fill=None, mode=None, fillcolor=None)
fig.add_trace(go.Scatter(x, y, fill=None, mode=None, fillcolor=None)
...

st.plotly_chart(fig)
```

<br>

`go.Scatter` **객체의 매개변수**

- `x` : x축에 입력할 배열(array) 또는 리스트(list)입니다.
- `y` : y축에 입력할 배열(array) 또는 리스트(list)입니다.
- `fill`(str) : 면적을 채우는 방법을 지정합니다.
  - “tozeroy” : x축을 기준으로 0부터 y값까지 면적을 채웁니다.
  - “tonexty” : 이전 그래프와의 면적을 채웁니다.
- `mode`(str, None) : 선의 형태를 지정합니다.
  - “none” : 그래프에 선이나 점을 표현하지 않습니다. 면적그래프와 같이 선이나 점을 사용하지 않을 때 유용합니다.
  - “lines” : 그래프를 선 형태로 표현합니다. 연속된 데이터 포인트 사이를 선으로 연결합니다.
  - ”markers” : 그래프를 점 형태로 표현합니다. 각 데이터 포인트를 점으로 표시합니다.
  - “lines+markers” : 그래프를 선과 점의 조합으로 표현합니다. 선으로 데이터 포인트를 연결하면서 동시에 각 데이터 포인트를 점으로 표시합니다.
- `fillcolor`(str, None) : 면적의 색상을 지정합니다. RGBA 형식을 사용하여 색상의 RGB 값과 투명도를 지정할 수 있습니다.
  ex) rgba(0, 176, 246, 0.6), rgba(255, 153, 51, 0.6)

<br>

**예시 1**

다음 예시는 `fill`을 tozeroy로 설정하여 X축을 기준으로 0부터 해당 열의 값을 채우도록 설정합니다. 그리고 `mode`를 none으로 설정하여 선을 그리지 않고 면적만 표시하도록 설정합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np
import plotly.graph_objects as go

# 데이터 생성
df = pd.DataFrame(np.random.randn(20, 3), columns=["a", "b", "c"])

# 그래프 생성
fig = go.Figure()
fig.add_trace(go.Scatter(x=df.index, y=df["a"], fill="tozeroy", mode="none"))
fig.add_trace(go.Scatter(x=df.index, y=df["b"], fill="tozeroy", mode="none"))
fig.add_trace(go.Scatter(x=df.index, y=df["c"], fill="tozeroy", mode="none"))

st.plotly_chart(fig)
```

![스크린샷 2025-04-08 오후 3.18.14.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.18.14.png)

<br>

### **Pie Chart(Plotly 라이브러리 활용)**

Plotly는 Matplotlib나 Seaborn보다 더 다양한 인터랙티브 기능을 제공하여 상호작용적으로 데이터 탐색하거나 시각화 할 수 있도록 도와주는 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있습니다. Plotly 라이브러리의 `go.Figure`를 사용하여 파이 차트의 데이터를 설정하고, `go.Pie`를 사용하여 세부사항을 적용합니다. `st.plotly_chart`를 사용하여 파이 차트를 시각화합니다.

```python
import plotly.graph_objects as go

fig = go.Figure(data=go.Pie(labels=None,values=None,marker=None,hole=None))
st.plotly_chart(fig)
```

<br>

**매개변수**

- `data`(list, tuple) : Figure 객체에 표시할 데이터 입력합니다. 데이터는 그래프를 구성하는 요소들을 포함하는 리스트(List) 형태로 전달됩니다.
- `labels`(list, array) : 파이 차트의 각 조각에 대한 라벨(이름)을 포함하는 리스트(list)나 배열(array)입니다. 이 길이는 `values`의 길이와 같아야 합니다.
- `values`(list, array) : 각 파이 차트 조각에 대한 수치값(숫자)을 포함하는 리스트(list)나 배열(array)입니다. 이 길이는 `labels`의 길이와 같아야 합니다.
- `marker` : 파이 차트의 각 조각의 모양을 다양하게 커스터마이징할 수 있습니다. 예를 들어, 색상, 선 두께, 선 색상 등의 속성을 설정할 수 있습니다.
  - `colors` : 각 조각의 색상을 설정합니다. 지정하지 않은 경우, 기본 트레이스(trace) 색상이 적용됩니다. 튜플(tuple), 리스트(list), numpy 배열 또는 pandas Series로 지정될 수 있는 배열입니다.
- `hole`(int) : 파이 차트 중앙에 구멍을 만들어 도넛 차트를 생성할 수 있습니다. 값은 0에서 1 사이의 값으로 설정할 수 있습니다. 0에 가까울수록 작은 구멍이 생깁니다.

<br>

**예시 1**

다음 예시는 Plotly 라이브러리를 사용하여 파이 차트를 그리는 코드입니다. `go.Pie` 함수를 사용하여 파이 차트를 생성합니다. `labels` 매개변수에 파이 차트의 라벨을 설정하고 `values` 매개변수에는 파이 차트의 크기를 설정합니다. `marker` 매개변수를 사용하여 파이 차트의 색상을 px.colors.qualitative.Set3, 중앙에 구멍의 크기를 0.3으로 설정합니다. `st.plotly_chart`를 사용하여 파이 차트를 출력합니다.

```python
import streamlit as st
import plotly.graph_objects as go
import plotly.express as px

# 파이차트
fig = go.Figure(data=go.Pie(labels=["A", "B", "C", "D"], values=[40,30,20,10],
                            marker=dict(colors=px.colors.qualitative.Set3),
                            hole=0.3))
st.plotly_chart(fig)
```

![스크린샷 2025-05-12 오후 2.24.35.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-12_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.24.35.png)

<br>

### **Histogram(Plotly 라이브러리 활용)**

Plotly는 Matplotlib나 Seaborn보다 더 다양한 인터랙티브 기능을 제공하여 상호작용적으로 데이터 탐색하거나 시각화 할 수 있도록 도와주는 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있습니다. Plotly 라이브러리의 `go.Histogram`을 사용하여 Histogram을 생성하고 `st.plotly_chart`를 사용하여 Histogram을 시각화합니다.

```python
import streamlit as st
import plotly.graph_objects as go

fig = go.Figure(data=[go.Histogram(x, nbins=None, marker_color= None,
                                   opacity=None)])
st.plotly_chart(fig)
```

<br>

**매개변수**

- `x` : Histogram에 사용할 데이터를 입력합니다. 해당 데이터는 배열(array), 리스트(list), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `nbins`(int) : Histogram의 구간(bin) 개수를 지정합니다.
- `marker_color`(str, None) : 막대의 색상을 지정합니다.
- `opacity`(float, None) : 막대의 투명도를 나타내며, 0부터 1 사이의 값을 지정합니다.

<br>

**예시 1**

다음 예시는 `nbins`를 20으로 설정하여 20개의 구간으로 Histogram을 나누고, `marker_color`를 “green”로 설정하여 막대의 색상을 초록색으로 지정합니다. `opacity`를 0.5로 설정하여 투명도를 지정하였습니다.

```python
import streamlit as st
import plotly.graph_objects as go
import numpy as np

arr = np.random.normal(1, 1, size=100)

fig = go.Figure(data=[go.Histogram(x=arr, nbins=10, marker_color="green",
                                   opacity=0.5)])
st.plotly_chart(fig)
```

![스크린샷 2025-05-12 오후 2.27.04.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-12_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.27.04.png)

<br>

### **Scatter Plot(Plotly 라이브러리 활용)**

Plotly는 Matplotlib나 Seaborn보다 더 다양한 인터랙티브 기능을 제공하여 상호작용적으로 데이터 탐색하거나 시각화 할 수 있도록 도와주는 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있습니다. Plotly 라이브러리의 `px.scatter`를 사용하여 scatter plot를 생성하고 `st.plotly_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import plotly.express as px

fig = px.scatter(data_frame=None, x=None, y=None,
                 color=None, symbol=None, size=None)

st.plotly_chart(fig)
```

<br>

**매개변수**

- `data_frame` : Scatter plot에 사용할 데이터프레임을 입력합니다.
- `x` : x축 데이터를 지정합니다. 열 이름으로 지정할 수 있습니다.
- `y` : y축 데이터를 지정합니다. 열 이름으로 지정할 수 있습니다.
- `color`(str, None) : 점의 색상을 지정합니다.
- `symbol`(str, None) : 점의 모양을 지정합니다.
- `size`(str, int, None) : 각 점을 나타내는 원의 크기입니다.

<br>

**예시 1**

다음 예시는 `x`축과 `y`축 데이터를 정규분포에서 랜덤한 수를 생성하고 `color`를 통해 그룹 A, B, C 로 나누어서 색상을 지정하고 데이터 포인트의 크기를 1~20사이 값을 지정하여 scatter plot을 만들고 `st.plotly_chart`를 사용하여 차트를 시각화합니다.

```python
import pandas as pd
import numpy as np
import plotly.express as px
import streamlit as st

# 랜덤 데이터 생성
np.random.seed(2023)
points = 100
x = np.random.normal(0, 1, points)
y = np.random.normal(0, 1, points)
colors = np.random.choice(["그룹 B","그룹 C","그룹 A"], points)
sizes = np.random.uniform(1, 20, points)

data = pd.DataFrame({"x": x, "y": y, "colors": colors, "sizes": sizes})

# 산점도 생성
fig = px.scatter(data, x="x", y="y", color="colors", size="sizes")

# Streamlit에서 차트 표시
st.plotly_chart(fig)
```

![Untitled](/images/streamlit/chapter02/part03/Untitled%206.png)

<br>

### **Boxplot(Plotly 라이브러리 활용)**

Box plot은 주로 데이터의 분포와 이상치를 식별하고 데이터의 정상 범위를 파악하는 데 도움을 줍니다. 최솟값, 최댓값, 중앙값, 사분위수 등 통계 정보를 함께 제공하기 때문에 그룹 간 차이점을 쉽게 파악할 수 있어 시계열 데이터의 변동성과 패턴을 시각화하여 계절성 추이를 파악할 수 있습니다.

Plotly는 Matplotlib나 Seaborn보다 더 다양한 인터랙티브 기능을 제공하여 상호작용적으로 데이터 탐색하거나 시각화 할 수 있도록 도와주는 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있습니다. Plotly 라이브러리의 `go.Box`를 사용하여 Box plot을 생성하고 `st.plotly_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import plotly.express as px

fig = px.box(data_frame, x=None, y=None, title=None)
st.plotly_chart(fig)
```

<br>

**매개변수**

- `data_frame` : Box plot에 사용할 데이터프레임을 입력합니다.
- `x` : x축 데이터를 지정합니다. 열 이름으로 지정할 수 있습니다.
- `y` : y축 데이터를 지정합니다. 열 이름으로 지정할 수 있습니다.
- `title`(str, None) : Box plot의 제목을 지정합니다.

<br>

**예시 1**

다음 예시는 평균이 0이고 표준편차가 1인 정규 분포에서 추출된 (100, 9) 크기의 랜덤 데이터를 생성하여 9개의 열을 가진 데이터프레임(DataFrame)으로 변환합니다. Pandas의 melt를 통해 df를 “Variable”열에 변수 이름, “Value”열에 해당 변수의 값으로 변환합니다. df_long을 기반으로 Box plot을 생성하고 `st.plotly_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import plotly.express as px
import pandas as pd
import numpy as np

data = np.random.normal(0, 1, size=(100, 9))
df = pd.DataFrame(data, columns=["S", "T", "R", "E", "A", "M", "L", "I", "T"])
df_long = pd.melt(df, var_name="Variable", value_name="Value")

fig = px.box(df_long, x="Variable", y="Value", title="Box Plot")
st.plotly_chart(fig)
```

![스크린샷 2025-05-12 오후 5.33.19.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-12_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.33.19.png)

<br>

### **Heatmap(Plotly 라이브러리 활용)**

Heatmap은 데이터 값을 색상으로 표시하여 행과 열을 가진 표 형태의 데이터를 시각화하는 방법입니다. Streamlit에서 Heatmap을 구현하기 위해 별도의 내장 함수는 제공되지 않습니다. 각 데이터 값은 색상으로 표시되며, 값이 클수록 더 진한 색상으로 표현입니다. Heatmap은 데이터의 패턴, 상관관계, 집중도 등을 시각적으로 파악하는 데 도움이 됩니다. Streamlit에서는 Matplotlib, Seaborn, Plotly와 같은 다양한 라이브러리를 활용하여 Heatmap을 시각화할 수 있습니다.

Plotly는 Matplotlib나 Seaborn보다 더 다양한 인터랙티브 기능을 제공하여 상호작용적으로 데이터 탐색하거나 시각화 할 수 있도록 도와주는 라이브러리로, 다양한 종류의 그래프와 차트를 생성할 수 있습니다. Plotly 라이브러리의 `go.Heatmap`를 사용하여 Heatmap을 생성하고 `st.plotly_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import plotly.graph_objects as go

fig = go.Figure(data=go.heatmap(z, x, y, colorscale=None))
st.plotly_chart(fig)
```

<br>

**매개변수**

- `z` : Heatmap에 사용할 데이터를 입력합니다. 해당 데이터는 배열(array), 리스트(list), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `x` : x축 레이블을 지정합니다. 배열(array) 또는 리스트(list)을 사용할 수 있습니다.
- `y` : y축 레이블을 지정합니다. 배열(array) 또는 리스트(list)을 사용할 수 있습니다.
- `colorscale`(str, None) : Heatmap의 컬러 맵을 지정합니다.

<br>

**예시 1**

다음 예시는 `z`를 랜덤으로 지정한 10\*10크기인 2차원 배열인 데이터 배열로 지정하고, `colorscale`를 “hot”으로 지정하여 색상 맵을 설정하여 Heatmap을 만들고 `st.plotly_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import plotly.graph_objects as go
import numpy as np

data = np.random.rand(10, 10)
fig = go.Figure(data=go.Heatmap(z=data, colorscale="hot"))
st.plotly_chart(fig)
```

![스크린샷 2023-07-10 오후 10.41.03.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-10_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.41.03.png)

<br>

## **st.altair_chart**

`st.altair_chart`는 [Vega-Altair](https://altair-viz.github.io/) 라이브러리를 사용하여 차트를 표시합니다. Vega-Altair는 Vega 및 Vega-Lite를 기반으로 하는 Python용 선언적 통계 시각화 라이브러리입니다.

```python
st.altair_chart(altair_chart, *, use_container_width=None, theme="streamlit", key=None, on_select="ignore", selection_mode=None)
```

<br>

**매개변수**

- `data`(Anything supported by st.dataframe) **:** 차트에 사용할 데이터를 입력합니다. 해당 데이터는 배열(Array), 리스트(List), 또는 데이터프레임(DataFrame)을 사용할 수 있습니다.
- `x`(str, None, Keyword only) : x축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 x축 값에 데이터 인덱스를 사용합니다.
- `y`(str, Sequence of str, None, Keyword only) : y축 데이터에 연결된 열 이름입니다. None(기본값)인 경우 나머지 모든 열의 데이터를 데이터 계열로 그립니다. 문자열 시퀀스인 경우, 와이드 포맷 테이블을 뒤에서 롱 포맷 테이블로 변환하여 동일한 차트에 여러 개의 시리즈를 그립니다.
- `x_label`(str, None, Keyword only) : x축의 레이블입니다. None(기본값)이면 사용 가능한 경우 x에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `y_label`(str, None, Keyword only) : y축의 레이블입니다. None(기본값)이면 사용 가능한 경우 y에 지정된 열 이름을 사용하며, 그렇지 않으면 레이블이 표시되지 않습니다.
- `color`(str, tuple, Sequence of str, Sequence of tuple, None, Keyword only) : 차트에서 서로 다른 계열에 사용할 색상입니다.
  - 계열이 1개만 있는 영역형 차트
    - None : 기본 색
    - #ffaa00 또는 #ffaa0088과 같은 16진수 문자열
    - 빨강, 녹색, 파랑 및 알파 구성 요소가 0에서 255 사이의 정수 또는 0.0에서 1.0 사이의 실수로 지정된 RGB 또는 RGBA 튜플입니다.
  - 여러 계열이 있는 영역 차트에서 데이터프레임이 긴 형식(즉, y가 None이거나 열 하나만 있는 경우)
    - None : 기본 색
    - 데이터 집합에서 해당 데이터포인트의 색상을 가져올 열의 이름입니다. 데이터 요소는 이 열의 값에 따라 동일한 색상의 계열로 그룹화됩니다. 또한 이 열의 값이 위의 색상 형식(16진수 문자열 또는 색상 튜플) 중 하나와 일치하는 경우 해당 색상이 사용됩니다. ex1) 데이터 집합에 1000개의 행이 있지만 이 열에 '성인', '어린이', '아기' 값만 포함된 경우 해당 1000개의 데이터 포인트는 기본 색상표에서 자동으로 색상이 선택되어 세 가지 계열로 그룹화됩니다. ex2) 동일한 1000행 데이터 집합의 경우 이 열에 "#ffaa00", "#f0f", "#0000ff" 값이 포함된 경우 1000개의 데이터 요소는 여전히 3개의 계열로 그룹화되지만 이번에는 색상이 "#ffaa00", "#f0f", "#0000ff"가 됩니다.
  - 여러 계열이 있는 영역형 차트에서 데이터프레임이 와이드 형식(즉, y가 열의 시퀀스인 경우)
    - None : 기본 색
    - 차트의 각 시리즈에 사용할 문자열 색상 또는 색상 튜플 리스트입니다. 이 리스트는 y 값의 수와 길이가 같아야 합니다. ex) 3개 계열의 경우, color=["#fd0", "#f0f", "#04f"]
      - ex) 3개 계열의 경우, color=["#fd0", "#f0f", "#04f"]
- `stack`(bool, "normalize", "center", None, Keyword only) : 영역을 표시할지 여부입니다.
  - None(기본값) : Vega의 기본값(차트 유형에 따라 자동으로 선택)을 사용합니다.
  - True : 영역이 차트 내에서 겹치지 않도록 위에 영역을 추가하여 표시합니다.
  - False : 영역이 스택 없이 서로 겹칩니다.
  - normalize : 영역이 쌓이고 전체 높이가 차트 높이의 100%로 정규화됩니다.
  - center : 영역이 누적되고 기준선을 중심으로 이동하여 Streamgraph(시간에 따라 여러 변수의 변화 시각화한 그래프)가 만들어집니다.
- `width`(int, None, Keyword only) : 차트의 가로 너비를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 차트 너비를 상위 컨테이너 너비까지 plotting 라이브러리에 따라 콘텐츠에 맞게 설정합니다. 너비가 부모 컨테이너 너비보다 크면 차트 너비를 부모 컨테이너 너비와 일치하도록 설정합니다. 너비를 사용하려면 use_container_width=False로 설정해야 합니다.
- `height`(int, None, Keyword only) : 차트의 세로 너비(높이)를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 plotting 라이브러리에 따라 콘텐츠에 맞게 차트의 높이를 설정합니다.
- `use_container_width`(bool, Keyword only) : 차트를 포함하는 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 차트가 포함된 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False : 너비에 따라 차트의 너비를 설정합니다.

<br>

**예시 1**

다음 예시는 `alt.chart`를 사용하여 차트 객체를 만들고, `mark_circle`을 이용하여 원형 마커를 사용하는 scatter plot를 그립니다. `encode`를 사용해서 축 및 툴팁에 대한 값을 설정합니다. 여기서 “x축의 값”을 x축으로, “y축의 값”을 y축으로, “z값”을 크기와 색상으로 설정하고 툴팁으로 “x축의 값”, “y축의 값”, “z 값”을 표시하고 `st.altair_chart`를 사용하여 차트를 시각화합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np
import altair as alt

chart_data = pd.DataFrame(np.random.randn(100, 3), columns=["x축의 값", "y축의 값", "z값"])

c = (
   alt.Chart(chart_data)
   .mark_circle()
   .encode(x="x축의 값", y="y축의 값", size="z값", color="z값", tooltip=["x축의 값", "y축의 값", "z값"])
)

st.altair_chart(c)
```

![스크린샷 2025-05-07 오후 1.15.12.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-07_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.15.12.png)

<br>

**예제 2**

다음 예시는 Chart selections-VegaLiteState를 사용하여 차트를 시각화하는 방법을 보여줍니다. Chart selections-VegaLiteState는 Vega-Lite 이벤트 상태의 스키마로 이벤트 상태는 키 및 속성 표기법을 모두 지원하는 딕셔너리와 같은 객체에 저장됩니다. 이벤트 상태는 세션 상태를 통해 프로그래밍 방식으로 변경하거나 설정할 수 없으며, 현재 선택 이벤트만 지원됩니다.

<br>

**매개변수**

- `selection`(dict) : `on_select` 이벤트의 상태입니다. `selection`은 키 및 속성 표기법을 모두 지원하는 딕셔너리형 객체를 반환합니다. 각 Vega-Lite 선택 매개변수의 이름은 선택 딕셔너리의 속성이 됩니다. 각 속성 내 데이터의 형식은 Vega-Lite 내의 선택 매개변수 정의에 따라 결정됩니다.

다음 두 예시는 동일한 결과값을 반환합니다. 각각 차트 정의에 포인트 및 간격 선택 매개변수가 포함되어 있습니다. 포인트를 클릭하면 point_selection 속성 아래에 선택 항목이 표시되고 간격을 선택하면 interval_selection 속성 아래에 선택 항목이 표시됩니다. 원하는 경우 선택 매개변수에 다른 이름을 지정할 수 있습니다. 점을 선택하는 동안 Shift 키를 누르고 있으면 기존 점 선택이 유지됩니다. 추가 선택을 할 때는 간격 선택이 유지되지 않습니다.

- point_selection : 포인트 선택 매개변수
- interval_selection : 간격 또는 상자 선택 매개변수

첫번째 예시에서는 `st.altair_chart`를 사용합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np
import altair as alt

if "data" not in st.session_state:
    st.session_state.data = pd.DataFrame(
        np.random.randn(20, 3), columns=["a", "b", "c"]
    )
df = st.session_state.data

point_selector = alt.selection_point("point_selection")
interval_selector = alt.selection_interval("interval_selection")
chart = (
    alt.Chart(df)
    .mark_circle()
    .encode(
        x="a",
        y="b",
        size="c",
        color="c",
        tooltip=["a", "b", "c"],
        fillOpacity=alt.condition(point_selector, alt.value(1), alt.value(0.3)),
    )
    .add_params(point_selector, interval_selector)
)

event = st.altair_chart(chart, key="alt_chart", on_select="rerun")

event
```

![스크린샷 2025-04-23 오후 5.12.11.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.12.11.png)

다음 예제에서는 `st.vega_lite_chart`를 사용합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

if "data" not in st.session_state:
    st.session_state.data = pd.DataFrame(
        np.random.randn(20, 3), columns=["a", "b", "c"]
    )

spec = {
    "mark": {"type": "circle", "tooltip": True},
    "params": [
        {"name": "interval_selection", "select": "interval"},
        {"name": "point_selection", "select": "point"},
    ],
    "encoding": {
        "x": {"field": "a", "type": "quantitative"},
        "y": {"field": "b", "type": "quantitative"},
        "size": {"field": "c", "type": "quantitative"},
        "color": {"field": "c", "type": "quantitative"},
        "fillOpacity": {
            "condition": {"param": "point_selection", "value": 1},
            "value": 0.3,
        },
    },
}

event = st.vega_lite_chart(
    st.session_state.data, spec, key="vega_chart", on_select="rerun"
)

event
```

![스크린샷 2025-04-23 오후 5.12.53.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.12.53.png)

<br>

**예시 3**

Theming은 Altair 차트의 시각적 스타일을 일관되게 정의하는 방법으로, 색상, 폰트, 레이아웃 등을 통합적으로 관리합니다.

다음 예시는 Streamlit 테마와 기본 Altair 테마가 적용된 차트의 예를 살펴보겠습니다.

Altair Chart는 기본적으로 Streamlit 테마를 사용하여 표시됩니다. 이 테마는 세련되고 사용자 친화적이며 Streamlit의 색상 팔레트가 통합되어 있습니다. 차트가 앱의 나머지 디자인과 더 잘 통합된다는 추가적인 이점이 있습니다. Streamlit 테마는 Streamlit 1.16.0부터 theme="streamlit" 키워드 인수를 통해 사용할 수 있습니다. 이 테마를 비활성화하고 Altair의 기본 테마를 사용하려면 theme=None을 대신 사용하셔야 합니다.

```python
import streamlit as st
import altair as alt
from vega_datasets import data

source = data.cars()

chart = alt.Chart(source).mark_circle().encode(
    x='Horsepower',
    y='Miles_per_Gallon',
    color='Origin',
).interactive()
```

아래 코드를 실행시켜 보시면 Streamlit 테마가 활성화 및 비활성화된 차트를 확인할 수 있습니다. 먼저, Streamlit 테마가 활성화된 코드를 살펴보면 기본적으로 Streamlit 테마가 활성화되어 있지만 차트 구성을 변경할 수 있으며, 사용자 지정 색상이나 글꼴로 덮어쓸 수 있습니다. 예를 들어 차트 선이 기본 빨간색 대신 녹색으로 표시할 수 있습니다.

```python
# chart 생성 코드
...

# Use the Streamlit theme.
# This is the default. So you can also omit the theme argument.
st.altair_chart(chart, theme="streamlit", use_container_width=True)
```

![스크린샷 2025-05-08 오후 5.16.31.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.16.31.png)

테마가 비활성화된 경우(theme=None)에는 Altair의 기본 테마가 사용됩니다. 이 모드에서는 Streamlit의 시각적 스타일이 적용되지 않고, 대신 Altair의 기본 스타일링이 적용됩니다. 이는 특별한 시각적 요구사항이 있거나 Altair의 기본 디자인 언어를 선호할 때 유용합니다. 아래 코드에서 보듯이 `theme=None` 매개변수를 설정하여 쉽게 이 모드로 전환할 수 있습니다.

```python
# chart 생성 코드
...

# Use the native Altair theme.
st.altair_chart(chart, theme=None, use_container_width=True)
```

![스크린샷 2025-05-08 오후 5.17.44.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.17.44.png)

Streamlit 테마가 활성화되어 있어도 사용자 지정 색상이 차트에 계속 반영되는 것을 확인할 수 있습니다.

```python
import altair as alt
import streamlit as st
from vega_datasets import data

source = data.seattle_weather()

scale = alt.Scale(
    domain=["sun", "fog", "drizzle", "rain", "snow"],
    range=["#e7ba52", "#a7a7a7", "#aec7e8", "#1f77b4", "#9467bd"],
)
color = alt.Color("weather:N", scale=scale)

# We create two selections:
# - a brush that is active on the top panel
# - a multi-click that is active on the bottom panel
brush = alt.selection_interval(encodings=["x"])
click = alt.selection_multi(encodings=["color"])

# Top panel is scatter plot of temperature vs time
points = (
    alt.Chart()
    .mark_point()
    .encode(
        alt.X("monthdate(date):T", title="Date"),
        alt.Y(
            "temp_max:Q",
            title="Maximum Daily Temperature (C)",
            scale=alt.Scale(domain=[-5, 40]),
        ),
        color=alt.condition(brush, color, alt.value("lightgray")),
        size=alt.Size("precipitation:Q", scale=alt.Scale(range=[5, 200])),
    )
    .properties(width=550, height=300)
    .add_selection(brush)
    .transform_filter(click)
)

# Bottom panel is a bar chart of weather type
bars = (
    alt.Chart()
    .mark_bar()
    .encode(
        x="count()",
        y="weather:N",
        color=alt.condition(click, color, alt.value("lightgray")),
    )
    .transform_filter(brush)
    .properties(
        width=550,
    )
    .add_selection(click)
)

chart = alt.vconcat(points, bars, data=source, title="Seattle Weather: 2012-2015")

st.markdown("### Streamlit 테마 활성화")
st.altair_chart(chart, theme="streamlit", use_container_width=True)

st.markdown("### Streamlit 테마 비활성화")
st.altair_chart(chart, theme=None, use_container_width=True)
```

![스크린샷 2025-05-08 오후 5.24.22.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.24.22.png)

![스크린샷 2025-05-08 오후 5.23.58.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.23.58.png)

<br>

## **st.vega_lite_chart**

`st.vega_lite_chart`는 대화형 그래픽을 정의하기 위한 고급 문법으로 [Vega-Lite](https://vega.github.io/vega-lite/) 라이브러리를 사용하여 차트를 표시합니다.

```python
st.vega_lite_chart(data=None, spec=None, *, use_container_width=None, theme="streamlit", key=None, on_select="ignore", selection_mode=None, **kwargs)
```

<br>

**매개변수**

- `data`(Anything supported by st.dataframe) : 플로팅할 데이터 또는 데이터가 포함된 Vega-Lite 사양(Vega-Lite API를 더 가깝게 따르는 사양) 중 하나입니다.
- `spec`(dict, None) : 차트의 Vega-Lite 사양입니다. None(기본값)인 경우 데이터에 전달된 사양을 사용합니다. 데이터와 사양 모두에 사양을 전달할 수 없습니다. 자세한 내용은 [https://vega.github.io/vega-lite/docs/](https://vega.github.io/vega-lite/docs/) 을 참조하세요.
- `use_container_width`(bool, None, Keyword only) : 차트의 기본 너비를 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - None : 호환되지 않는 것으로 알려진 차트(altair.Facet, altair.HConcatChart 및 altair.RepeatChart)를 제외한 모든 차트에 부모 컨테이너의 너비를 사용합니다.
  - True : 차트의 기본 너비를 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False(기본값) : 차트 너비를 plotting 라이브러리에 따라 설정하되, 그림 너비가 너무 크면 부모(상위) 컨테이너 너비까지 콘텐츠에 맞게 설정합니다.
- `theme`("streamlit", None, Keyword only) : 차트의 테마를 설정합니다.
  - "streamlit"(기본값) : Streamlit의 기본 디자인을 사용합니다.
  - None : Vega-Lite의 기본 디자인을 사용합니다.
- `key`(str, Keyword only) : 차트의 고유 키로 사용할 문자열로 요소에 ID를 부여하는데 사용합니다. 두 위젯의 키가 같을 수는 없기 때문에 None(기본값)인 경우 요소의 ID는 다른 파라미터의 값 또는 차트의 콘텐츠에 따라 차트의 키가 생성됩니다.
  또한, `selection_mode`가 설정되어 선택 기능이 활성화되고 `key`가 제공되면, Streamlit은 세션 상태에 해당 `key`를 등록하여 사용자의 선택 상태를 저장합니다. 이때, 선택 상태는 읽기 전용으로, 코드에서 직접 수정할 수 없고 사용자의 상호작용으로만 변경됩니다.
- `on_select`("ignore", "rerun", callable, Keyword only) : 그림이 사용자 선택 이벤트에 응답하는 방식입니다. 그림이 입력 위젯처럼 작동할지 여부를 제어합니다. 선택 이벤트를 사용하려면 데이터 또는 사양에 정의된 Vega-Lite 사양에 차트 라이브러리의 선택 매개변수가 포함되어 있어야 합니다. Vega-Lite에서 상호 작용을 정의하는 방법에 대한 자세한 내용은 Vega-Lite 문서에서 [매개변수를 사용한 동적 동작](https://vega.github.io/vega-lite/docs/parameter.html)을 참조하세요.
  - "ignore"(기본값) : 차트의 선택 이벤트에 반응하지 않습니다. 그림이 입력 위젯처럼 동작하지 않습니다.
  - "rerun" : 차트에서 데이터를 선택하면 앱을 다시 실행합니다. 이 경우 `st.vega_lite_chart`는 선택된 데이터를 딕셔너리로 반환합니다.
  - callable : 앱을 다시 실행하고 callable을 앱의 나머지 부분보다 먼저 콜백 함수로 실행합니다. 이 경우 `st.vega_lite_chart`은 선택된 데이터를 딕셔너리로 반환합니다.
- `selection_mode`(str, Iterable of str, Keyword only) : 차트의 select 모드입니다. 선택 매개변수로 이름 속성으로 식별됩니다.
  - None(기본값) : 차트의 Vega-Lite 사양에 정의된 모든 선택 매개변수를 사용합니다.
  - 선택 매개변수 사용 : 해당 매개변수에서 선택하면 재실행이 트리거되고 선택 상태에 포함됩니다.
  - 선택 매개변수 사용하지 않는 경우 : 해당 매개변수의 선택은 재실행을 트리거하지 않으며 선택 상태에 포함되지 않습니다.
- `kwargs`(any, Keyword only) : Vega-Lite 사양을 키워드로 차트에 표시합니다. `spec` 대신 사용할 수 있습니다.

<br>

**반환값**

- on_select="ignore"(기본값) 일 때, .add_rows() 메서드와 함께 사용할 수 있는 차트 요소에 대한 내부 자리 표시자(placeholder)를 반환합니다.
  :::div{.callout}

  내부 자리 표시자는 UI 요소가 화면에 배치될 위치를 지정하고, 이후에 해당 요소를 조작할 수 있게 하는 참조 객체입니다.

  :::

- 그 밖의 경우 딕셔너리와 유사한 객체(element, dict)를 반환합니다. 이 객체는 다음 두 가지 방법으로 접근할 수 있으며, 객체의 속성들은 VegaLiteState 딕셔너리 스키마에 정의되어 있습니다.
  - 키 표기법 : result["속성이름"]
  - 속성 표기법 : result.속성이름

<br>

**예시 1**

다음 예시는 데이터프레임을 생성하고 `st.vega_lite_chart`을 사용하여 차트를 시각화합니다. `spec`에 mark 타입을 circle로 사용해서 원형 마커를 생성합니다. encoding 부분에서는 x축에 'a' 열, y축에 'b' 열을 매핑하고, 점의 크기와 색상 모두 'c' 열의 값에 따라 변화하도록 설정했습니다. 이렇게 하면 3개 변수 간의 관계를 단일 차트에서 효과적으로 표현할 수 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

chart_data = pd.DataFrame(np.random.randn(200, 3), columns=["a", "b", "c"])

st.vega_lite_chart(
   chart_data,
   {
       "mark": {"type": "circle", "tooltip": True},
       "encoding": {
           "x": {"field": "a", "type": "quantitative"},
           "y": {"field": "b", "type": "quantitative"},
           "size": {"field": "c", "type": "quantitative"},
           "color": {"field": "c", "type": "quantitative"},
       },
   },

```

![스크린샷 2025-04-23 오후 5.07.04.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.07.04.png)

<br>

**예제 2**

다음 예시는 Chart selections-VegaLiteState를 사용하여 차트를 시각화하는 방법을 보여줍니다. Chart selections-VegaLiteState는 Vega-Lite 이벤트 상태의 스키마로 이벤트 상태는 키 및 속성 표기법을 모두 지원하는 딕셔너리와 같은 객체에 저장됩니다. 이벤트 상태는 세션 상태를 통해 프로그래밍 방식으로 변경하거나 설정할 수 없으며, 현재 선택 이벤트만 지원됩니다.

<br>

**매개변수**

- `selection`(dict) : `on_select` 이벤트의 상태입니다. `selection`은 키 및 속성 표기법을 모두 지원하는 딕셔너리형 객체를 반환합니다. 각 Vega-Lite 선택 매개변수의 이름은 선택 딕셔너리의 속성이 됩니다. 각 속성 내 데이터의 형식은 Vega-Lite 내의 선택 매개변수 정의에 따라 결정됩니다.

다음 두 예시는 동일한 결과값을 반환합니다. 각각 차트 정의에 포인트 및 간격 선택 매개변수가 포함되어 있습니다. 포인트를 클릭하면 point_selection 속성 아래에 선택 항목이 표시되고 간격을 선택하면 interval_selection 속성 아래에 선택 항목이 표시됩니다. 원하는 경우 선택 매개변수에 다른 이름을 지정할 수 있습니다. 점을 선택하는 동안 Shift 키를 누르고 있으면 기존 점 선택이 유지됩니다. 추가 선택을 할 때는 간격 선택이 유지되지 않습니다.

- point_selection : 포인트 선택 매개변수
- interval_selection : 간격 또는 상자 선택 매개변수

첫번째 예시에서는 `st.altair_chart`를 사용합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np
import altair as alt

if "data" not in st.session_state:
    st.session_state.data = pd.DataFrame(
        np.random.randn(20, 3), columns=["a", "b", "c"]
    )
df = st.session_state.data

point_selector = alt.selection_point("point_selection")
interval_selector = alt.selection_interval("interval_selection")
chart = (
    alt.Chart(df)
    .mark_circle()
    .encode(
        x="a",
        y="b",
        size="c",
        color="c",
        tooltip=["a", "b", "c"],
        fillOpacity=alt.condition(point_selector, alt.value(1), alt.value(0.3)),
    )
    .add_params(point_selector, interval_selector)
)

event = st.altair_chart(chart, key="alt_chart", on_select="rerun")

event
```

![스크린샷 2025-04-23 오후 5.12.11.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.12.11.png)

다음 예제에서는 `st.vega_lite_chart`를 사용합니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

if "data" not in st.session_state:
    st.session_state.data = pd.DataFrame(
        np.random.randn(20, 3), columns=["a", "b", "c"]
    )

spec = {
    "mark": {"type": "circle", "tooltip": True},
    "params": [
        {"name": "interval_selection", "select": "interval"},
        {"name": "point_selection", "select": "point"},
    ],
    "encoding": {
        "x": {"field": "a", "type": "quantitative"},
        "y": {"field": "b", "type": "quantitative"},
        "size": {"field": "c", "type": "quantitative"},
        "color": {"field": "c", "type": "quantitative"},
        "fillOpacity": {
            "condition": {"param": "point_selection", "value": 1},
            "value": 0.3,
        },
    },
}

event = st.vega_lite_chart(
    st.session_state.data, spec, key="vega_chart", on_select="rerun"
)

event
```

![스크린샷 2025-04-23 오후 5.12.53.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.12.53.png)

<br>

**예시 3**

다음 예시는 `element.add_rows`를 사용하여 현재 차트에 새로운 데이터를 추가하는 방법을 보여줍니다. `add_rows` 메서드를 사용하면 데이터프레임, 배열, 딕셔너리 등 다양한 형식의 데이터를 기존 테이블이나 플롯 하단에 연결할 수 있습니다. 이를 통해 기존 데이터를 확장하거나 그래프에 새로운 데이터를 추가할 수 있습니다.

```python
element.add_rows(data=None, **kwargs)
```

<br>

**매개변수**

- `data`(pandas.DataFrame, pandas.Styler, pyarrow.Table, numpy.ndarray, pyspark.sql.DataFrame, snowflake.snowpark.dataframe.DataFrame, Iterable, dict, None) : 연결할 테이터입니다.
- `**kwargs`(pandas.DataFrame, numpy.ndarray, Iterable, dict, None, Keyword only) : 연결할 데이터 집합입니다. 데이터 매개변수에 있는 데이터 집합을 포함하여 하나의 데이터 집합만 전달할 수 있습니다.

다음 예시는 df1과 df2라는 두 개의 데이터프레임을 생성하고, df2 데이터를 차트에 추가하여 보여줍니다. 딕셔너리에 이름을 지정하고 `add_rows` 메서드에서 사용할 수 있습니다. `vega_lite_chart`에서 딕셔너리의 이름을 지정하여 추가해보도록 하겠습니다. 또한, 딕셔너리의 이름이 지정된 플롯의 경우 키가 이름인 키워드 인수를 사용하여 데이터를 전달할 수 있습니다.

```python
import streamlit as st
import pandas as pd
import numpy as np

df1 = pd.DataFrame(
    np.random.randn(50, 20), columns=("col %d" % i for i in range(20))
)

df2 = pd.DataFrame(
    np.random.randn(50, 20), columns=("col %d" % i for i in range(20))
)

# 이름이 지정된 데이터 집합을 사용하여 차트 생성
my_chart = st.vega_lite_chart(
    {
        "mark": "line",
        "encoding": {
            "x": {"field": "col 1", "type": "quantitative"},
            "y": {"field": "col 2", "type": "quantitative"}
        },
        "datasets": {
            "some_fancy_name": df1,  # <-- 데이터 집합에 이름 지정
        },
        "data": {"name": "some_fancy_name"},
    }
)

# 데이터 집합 이름을 키워드로 사용하여 df2를 추가
my_chart.add_rows(some_fancy_name=df2)  # <-- 이름을 키워드로 사용하여 데이터 추가
```

<br>

**예시 4**

Theming은 Vega-Lite 차트의 시각적 스타일을 일관되게 정의하는 방법으로, 색상, 폰트, 레이아웃 등을 통합적으로 관리합니다.

다음 예시는 Streamlit 테마와 기본 Vega-Lite 테마가 적용된 차트의 예를 살펴보겠습니다.

Vega-Lite Chart는 기본적으로 Streamlit 테마를 사용하여 표시됩니다. 이 테마는 세련되고 사용자 친화적이며 Streamlit의 색상 팔레트가 통합되어 있습니다. 차트가 앱의 나머지 디자인과 더 잘 통합된다는 추가적인 이점이 있습니다. Streamlit 테마는 Streamlit 1.16.0부터 theme="streamlit" 키워드 인수를 통해 사용할 수 있습니다. 이 테마를 비활성화하고 Vega-Lite의 기본 테마를 사용하려면 theme=None을 대신 사용하셔야 합니다.

```python
import streamlit as st
from vega_datasets import data

source = data.cars()

chart = {
    "mark": "point",
    "encoding": {
        "x": {
            "field": "Horsepower",
            "type": "quantitative",
        },
        "y": {
            "field": "Miles_per_Gallon",
            "type": "quantitative",
        },
        "color": {"field": "Origin", "type": "nominal"},
        "shape": {"field": "Origin", "type": "nominal"},
    },
}
```

아래 코드를 실행시켜 보시면 Streamlit 테마가 활성화 및 비활성화된 차트를 확인할 수 있습니다. 먼저, Streamlit 테마가 활성화된 코드를 살펴보면 기본적으로 Streamlit 테마가 활성화되어 있지만 차트 구성을 변경할 수 있으며, 사용자 지정 색상이나 글꼴로 덮어쓸 수 있습니다. 예를 들어 차트 선이 기본 빨간색 대신 녹색으로 표시할 수 있습니다.

```python
# chart 생성 코드
...

# Use the Streamlit theme.
# This is the default. So you can also omit the theme argument.
st.vega_lite_chart(
    source, chart, theme="streamlit", use_container_width=True
)
```

![스크린샷 2025-05-07 오전 11.21.43.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-07_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.21.43.png)

테마가 비활성화된 경우(theme=None)에는 Vega-Lite의 기본 테마가 사용됩니다. 이 모드에서는 Streamlit의 시각적 스타일이 적용되지 않고, 대신 Vega-Lite의 기본 스타일링이 적용됩니다. 이는 특별한 시각적 요구사항이 있거나 Vega-Lite의 기본 디자인 언어를 선호할 때 유용합니다. 아래 코드에서 보듯이 `theme=None` 매개변수를 설정하여 쉽게 이 모드로 전환할 수 있습니다.

```python
# chart 생성 코드
...

st.vega_lite_chart(
    source, chart, theme=None, use_container_width=True
)
```

![스크린샷 2025-05-07 오전 11.22.19.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-05-07_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.22.19.png)

<br>

## **st.bokeh_chart**

`st.bokeh_chart`는 Python 차트 라이브러리 Bokeh의 show 함수의 인수를 거의 그대로 따르며, 대화형 Bokeh 차트를 표시합니다. Streamlit에서 Bokeh 차트를 시각화하려면 Bokeh의 show 함수를 호출할 때마다 `st.bokeh_chart`를 사용하시면 됩니다. `st.bokeh_chart`를 사용하려면 bokeh==2.4.3 및 numpy<2를 설치하셔야 합니다. 최신 버전의 bokeh가 필요한 경우, 대신 [streamlit-bokeh](https://github.com/streamlit/streamlit-bokeh) 사용자 정의 컴포넌트를 사용하시길 바랍니다.

```bash
pip install bokeh==2.4.3
```

```bash
pip install numpy==1.24.4
```

<br>

**매개변수**

- `figure`(bokeh.plotting.figure.Figure) : 플롯할 Bokeh 그림 객체입니다.
- `use_container_width`(bool) : 그림의 기본 너비를 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 그림의 기본 너비를 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False(기본값) : 그림 너비를 plotting 라이브러리에 따라 설정하되, 그림 너비가 너무 크면 부모(상위) 컨테이너 너비까지 콘텐츠에 맞게 설정합니다.

<br>

**예시 1**

다음 예시는 `st.bokeh_chart`를 사용해 간단한 선형 차트를 그리는 코드입니다.

```python
import streamlit as st
from bokeh.plotting import figure

x = [1, 2, 3, 4, 5]
y = [6, 7, 2, 4, 5]

p = figure(title="simple line example", x_axis_label="x", y_axis_label="y")
p.line(x, y, legend_label="Trend", line_width=2)

st.bokeh_chart(p)
```

![스크린샷 2025-04-17 오후 5.53.57.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.53.57.png)

<br>

## **st.pydeck_chart**

`st.pydeck_chart`는 PyDeck 라이브러리를 사용하여 3D 시각화 및 인터랙티브한 차트를 표시합니다. PyDeck는 지리 정보 시각화를 위한 다양한 기능과 스타일링 옵션을 제공하므로, 사용자는 고성능의 인터랙티브한 차트를 생성하여 지리적 데이터를 시각화하고 탐색할 수 있습니다. `st.pydeck_chart`를 사용하려면 pydeck을 설치하셔야 합니다.

```bash
pip install pydeck
```

```python
import streamlit as st
import pydeck as pdk

st.pydeck_chart(pydeck_obj=None, *, use_container_width=True, width=None, height=None, selection_mode="single-object", on_select="ignore", key=None)
```

<br>

**매개변수**

- `pydeck_obj`(pydeck.Deck, None) : PyDeck 라이브러리로 생성된 차트 객체입니다.
- `use_container_width`(bool, Keyword only) : 그림의 기본 너비를 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 그림의 기본 너비를 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False(기본값) : 그림 너비를 plotting 라이브러리에 따라 설정하되, 그림 너비가 너무 크면 부모(상위) 컨테이너 너비까지 콘텐츠에 맞게 설정합니다.
- `width`(int, None, Keyword only) : 차트의 가로 너비를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 차트 너비를 상위 컨테이너 너비까지 plotting 라이브러리에 따라 콘텐츠에 맞게 설정합니다. 너비가 부모 컨테이너 너비보다 크면 차트 너비를 부모 컨테이너 너비와 일치하도록 설정합니다. 너비를 사용하려면 use_container_width=False로 설정해야 합니다.
- `height`(int, None, Keyword only) : 차트의 세로 너비(높이)를 픽셀 단위로 조절할 때 사용됩니다. None(기본값)인 경우 plotting 라이브러리에 따라 콘텐츠에 맞게 차트의 높이를 설정합니다.
- `on_select`("ignore", "rerun", callable, Keyword only) : 차트가 사용자 선택 이벤트에 응답하는 방식입니다. 차트가 입력 위젯처럼 작동할지 여부를 제어합니다. `on_select`가 "ignore"가 아닌 경우, 모든 레이어에 선언된 ID가 있어야 재실행 시 차트를 상태 저장소로 유지할 수 있습니다.
  - "ignore"(기본값) : 차트의 선택 이벤트에 반응하지 않습니다. 그림이 입력 위젯처럼 동작하지 않습니다.
  - "rerun" : 차트에서 데이터를 선택하면 앱을 다시 실행합니다. 이 경우 `st.pydeck_chart`는 선택된 데이터를 딕셔너리로 반환합니다.
  - callable : 앱을 다시 실행하고 callable을 앱의 나머지 부분보다 먼저 콜백 함수로 실행합니다. 이 경우 `st.pydeck_chart`은 선택된 데이터를 딕셔너리로 반환합니다.
- `selection_mode`("single-object", "multi-object", Keyword only) : 차트의 select 모드입니다.
  - single-object(기본값) : 한 번에 하나의 개체만 선택할 수 있습니다.
  - multi-object : 한 번에 여러 개체를 선택할 수 있습니다.
- `key`(str, Keyword only) : 차트의 고유 키로 사용할 문자열로 요소에 ID를 부여하는데 사용합니다. 두 위젯의 키가 같을 수는 없기 때문에 None(기본값)인 경우 요소의 ID는 다른 파라미터의 값 또는 차트의 콘텐츠에 따라 차트의 키가 생성됩니다.
  또한, `selection_mode`가 설정되어 선택 기능이 활성화되고 `key`가 제공되면, Streamlit은 세션 상태에 해당 `key`를 등록하여 사용자의 선택 상태를 저장합니다. 이때, 선택 상태는 읽기 전용으로, 코드에서 직접 수정할 수 없고 사용자의 상호작용으로만 변경됩니다.

<br>

**반환값**

- on_select="ignore"(기본값) 일 때, 차트 요소에 대한 내부 자리 표시자(placeholder)를 반환합니다.
  :::div{.callout}

  내부 자리 표시자는 UI 요소가 화면에 배치될 위치를 지정하고, 이후에 해당 요소를 조작할 수 있게 하는 참조 객체입니다.

  :::

- 그 밖의 경우 딕셔너리와 유사한 객체(element, dict)를 반환합니다. 이 객체는 다음 두 가지 방법으로 접근할 수 있으며, 객체의 속성들은 PydeckState 딕셔너리 스키마에 정의되어 있습니다.
  - 키 표기법 : result["속성이름"]
  - 속성 표기법 : result.속성이름

<br>

**예시 1**

다음 예시는 HexagonLayer와 ScatterplotLayer를 사용한 차트입니다. 차트는 현재 활성화된 기본 테마에 따라 밝은 맵 스타일 또는 어두운 맵 스타일을 사용합니다.

:::div{.callout}

PyDeck 차트의 스타일을 기본 테마와 일관되게 만들려면 pydeck.Deck 객체에서 map_style=None을 설정하면 됩니다.

:::

```python
import streamlit as st
import pandas as pd
import numpy as np
import pydeck as pdk

chart_data = pd.DataFrame(
    np.random.randn(1000, 2) / [50, 50] + [37.76, -122.4],
    columns=["lat", "lon"],
)

st.pydeck_chart(
    pdk.Deck(
        map_style=None,
        initial_view_state=pdk.ViewState(
            latitude=37.76,
            longitude=-122.4,
            zoom=11,
            pitch=50,
        ),
        layers=[
            pdk.Layer(
                "HexagonLayer",
                data=chart_data,
                get_position="[lon, lat]",
                radius=200,
                elevation_scale=4,
                elevation_range=[0, 1000],
                pickable=True,
                extruded=True,
            ),
            pdk.Layer(
                "ScatterplotLayer",
                data=chart_data,
                get_position="[lon, lat]",
                get_color="[200, 30, 0, 160]",
                get_radius=200,
            ),
        ],
    )
)
```

![스크린샷 2025-04-09 오후 4.19.23.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.19.23.png)

<br>

**예시 2**

다음 예시는 PyDeck 차트에서 이벤트 상태가 어떻게 작동하는지 보여줍니다. Chart selections-PydeckState는 PyDeck 이벤트 상태의 스키마로 이벤트 상태는 키와 어트리뷰트 표기법을 모두 지원하는 딕셔너리 같은 객체에 저장됩니다. 이벤트 상태는 세션 상태를 통해 프로그래밍 방식으로 변경하거나 설정할 수 없습니다. 현재 선택 이벤트만 지원됩니다.

<br>

**매개변수**

- `selection`(dict) : `on_select` 이벤트의 상태입니다. 속성은 키 및 속성 표기법을 모두 지원하는 딕셔너리형 객체를 반환합니다.
  속성은 PydeckSelectionState 딕셔너리 스키마에 의해 설명됩니다.
  - `indices`(dict[str, list[int]]) : 레이어별로 선택한 객체의 딕셔너리입니다. 딕셔너리의 각 키는 레이어 ID이고 각 값은 해당 레이어 내의 객체 인덱스 리스트입니다.
  - `objects`(dict[str, list[dict[str, Any]]]) : 레이어별 오브젝트 속성 딕셔너리입니다. 딕셔너리의 각 키는 레이어 ID이고 각 값은 해당 레이어에서 선택한 개체에 대한 메타 데이터 딕셔너리 리스트입니다.

다음 예시는 `st.pydeck_chart()`와 선택 이벤트 기능을 활용해 미국 주의 위치를 시각화하고, 사용자가 차트에서 도시를 선택할 수 있도록 합니다. 미국 주 데이터가 담긴 CSV 파일을 불러오고 인구 수에 따라 점 크기를 조정합니다. ScatterplotLayer를 이용해 각 도시를 시각화하며, `pickable`와 `auto_highlight`를 True로 설정하여 마우스 선택 및 하이라이트 기능을 활성화합니다.

또, `st.pydeck_chart()` 함수에서 `on_select`를 "rerun"으로 설정하고 `selection_mode`를 "multi-object" 옵션을 설정하여, 사용자가 차트에서 여러 개의 도시를 선택할 수 있도록 합니다. 선택된 정보는 `event.selection`을 통해 접근할 수 있으며, 이후 선택 결과를 활용해 다른 동작이나 시각화를 추가로 구현할 수 있습니다.

```python
import streamlit as st
import pydeck
import pandas as pd

capitals = pd.read_csv(
    "https://raw.githubusercontent.com/streamlit/docs/main/python/api-examples-source/data/capitals.csv",
    header=0,
    names=[
        "Capital",
        "State",
        "Abbreviation",
        "Latitude",
        "Longitude",
        "Population",
    ],
)
capitals["size"] = capitals.Population / 10

point_layer = pydeck.Layer(
    "ScatterplotLayer",
    data=capitals,
    id="capital-cities",
    get_position=["Longitude", "Latitude"],
    get_color="[255, 75, 75]",
    pickable=True,
    auto_highlight=True,
    get_radius="size",
)

view_state = pydeck.ViewState(
    latitude=40, longitude=-117, controller=True, zoom=2.4, pitch=30
)

chart = pydeck.Deck(
    point_layer,
    initial_view_state=view_state,
    tooltip={"text": "{Capital}, {Abbreviation}\nPopulation: {Population}"},
)

event = st.pydeck_chart(chart, on_select="rerun", selection_mode="multi-object")

event.selection
```

![스크린샷 2025-04-17 오후 5.09.47.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.09.47.png)

ID가 "captial-cities"인 레이어에서 단일 개체를 선택할 때의 선택 상태입니다.

```python
{
  "indices":{
    "capital-cities":[
      2
    ]
  },
  "objects":{
    "capital-cities":[
      {
        "Abbreviation":" AZ"
        "Capital":"Phoenix"
        "Latitude":33.448457
        "Longitude":-112.073844
        "Population":1650070
        "State":" Arizona"
        "size":165007.0
      }
    ]
  }
}
```

<br>

**예시 3**

다음 예시는 PyDeck 라이브러리를 사용하여 서울시 좌표 중심으로 생성된 랜덤 데이터를 ScatterplotLayer 타입으로 시각화하는 예시입니다. 데이터는 위도와 경도를 나타내며, `get_radius`와 `get_color`를 사용하여 표시된 원의 크기와 색상을 설정합니다. 또한, `map_style`은 “light”로 설정되어 밝은 배경의 지도 스타일을 적용하며, 초기 뷰 상태는 서울시 좌표를 중심으로 하는 설정으로 지정됩니다.

```python
import pandas as pd
import streamlit as st
import numpy as np
import pydeck as pdk

# 서울시 좌표 중심으로 랜덤 데이터 생성
np.random.seed(100)
df = pd.DataFrame(np.random.randn(1000, 2) / [20, 20] + [37.57, 126.98],
                  columns=["lat", "lon"])

# ScatterplotLayer로 시각화
layer = pdk.Layer("ScatterplotLayer",
                  data=df,
                  get_position=["lon", "lat"],
                  get_radius=200,
                  get_color=[255, 0, 0])

# Deck 객체 생성
deck = pdk.Deck(map_style="light",
                layers=[layer],
                initial_view_state=pdk.ViewState(latitude=37.57,
                                                 longitude=126.98,
                                                 zoom=10,
                                                 pitch=50))

# PyDeck 차트 출력
st.pydeck_chart(deck)
```

![스크린샷 2023-06-13 오후 8.23.14.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-06-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_8.23.14.png)

<br>

**예시 4**

다음 예시는 PyDeck 라이브러리를 사용하여 서울시 좌표 중심으로 생성된 랜덤 데이터를 HexagonLayer 타입으로 시각화하는 예시입니다. HexagonLayer는 데이터의 밀도를 육각형 그리드로 표현하는 레이어 타입입니다. 설정된 `radius`, `elevation_scale`, `elevation_range` 등의 속성을 사용하여 시각화 효과를 조정할 수 있습니다. 또한, `map_style`은 “light”로 설정되어 밝은 배경의 지도 스타일을 적용하며, 초기 뷰 상태는 서울시 좌표를 중심으로 하는 설정으로 지정됩니다.

```python
import pandas as pd
import streamlit as st
import numpy as np
import pydeck as pdk

# 서울시 좌표 중심으로 랜덤 데이터 생성
np.random.seed(100)
df = pd.DataFrame(np.random.randn(1000, 2) / [20, 20] + [37.57, 126.98],
                  columns=["lat", "lon"])
# HexagonLayer로 시각화
layer = pdk.Layer("HexagonLayer",
                  data=df,
                  get_position=["lon", "lat"],
                  radius=200,
                  elevation_scale=4,
                  elevation_range=[100, 1000],
                  pickable=False,
                  extruded=True)
# Deck 객체 생성
deck = pdk.Deck(map_style="light",
                layers=[layer],
                initial_view_state=pdk.ViewState(latitude=37.57,
                                                 longitude=126.98,
                                                 zoom=10,
                                                 pitch=50))
# PyDeck 차트 출력
st.pydeck_chart(deck)
```

![스크린샷 2023-06-13 오후 8.23.35.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-06-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_8.23.35.png)

<br>

**예시 5**

다음 예시는 PyDeck 라이브러리를 사용하여 서울시 좌표 중심으로 생성된 랜덤 데이터를 HeatmapLayer 타입으로 시각화하는 예시입니다. HeatmapLayer는 데이터의 밀도를 표현하는 레이어 타입으로, 좌표 위치에 따라 색상이 변화하여 데이터의 밀도를 시각화합니다. `get_position`을 사용하여 데이터의 경도와 위도를 지정합니다. 또한, `map_style`은 “light”로 설정되어 밝은 배경의 지도 스타일을 적용하며, 초기 뷰 상태는 서울시 좌표를 중심으로 하는 설정으로 지정됩니다.

```python
import pandas as pd
import streamlit as st
import numpy as np
import pydeck as pdk

# 서울시 좌표 중심으로 랜덤 데이터 생성
df = pd.DataFrame(np.random.randn(1000, 2) / [20, 20] + [37.57, 126.98],
                  columns=["lat", "lon"])

# HexagonLayer로 시각화
layer = pdk.Layer("HeatmapLayer",
                  data=df,
                  get_position=["lon", "lat"],)

# Deck 객체 생성
deck = pdk.Deck(map_style="light",
                layers=[layer],
                initial_view_state=pdk.ViewState(latitude=37.57,
                                                 longitude=126.98,
                                                 zoom=10,
                                                 pitch=50))

# PyDeck 차트 출력
st.pydeck_chart(deck)
```

![스크린샷 2023-06-13 오후 8.23.58.png](/images/streamlit/chapter02/part03/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-06-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_8.23.58.png)

<br>

## **st.graphviz_chart**

`st.graphviz_chart`는 Python 차트 라이브러리 dagre-d3를 사용하여 차트를 표시합니다. `st.graphviz_chart`를 사용하려면 graphviz를 설치하셔야 합니다.

```bash
pip install graphviz
```

```python
import streamlit as st
import graphviz

st.graphviz_chart(figure_or_dot, use_container_width=False)_select
```

<br>

**매개변수**

- `figure_or_dot`(graphviz.dot.Graph, graphviz.dot.Digraph, graphviz.sources.Source, str) : 렌더링할 Graphlib 그래프 객체 또는 점 문자열입니다.
- `use_container_width`(bool) : 그림의 기본 너비를 부모(상위) 컨테이너의 너비로 설정할지 여부를 지정합니다.
  - True : 그림의 기본 너비를 부모(상위) 컨테이너의 너비와 일치하도록 설정합니다.
  - False(기본값) : 그림 너비를 plotting 라이브러리에 따라 설정하되, 그림 너비가 너무 크면 부모(상위) 컨테이너 너비까지 콘텐츠에 맞게 설정합니다.

<br>

**예제 1**

다음 예시는 그래프 객체를 생성하고 `st.graphviz_chart`로 시각화하는 예시입니다. 이때, GraphViz의 도트 언어를 사용하여 그래프에서 차트를 그릴 수 있습니다.

```python
import streamlit as st
import graphviz

# 그래프 객체 생성
graph = graphviz.Digraph()
graph.edge("run", "intr")
graph.edge("intr", "runbl")
graph.edge("runbl", "run")
graph.edge("run", "kernel")
graph.edge("kernel", "zombie")
graph.edge("kernel", "sleep")
graph.edge("kernel", "runmem")
graph.edge("sleep", "swap")
graph.edge("swap", "runswap")
graph.edge("runswap", "new")
graph.edge("runswap", "runmem")
graph.edge("new", "runmem")
graph.edge("sleep", "runmem")

st.graphviz_chart(graph)
```

```python
import streamlit as st
import graphviz

st.graphviz_chart('''
    digraph {
        run -> intr
        intr -> runbl
        runbl -> run
        run -> kernel
        kernel -> zombie
        kernel -> sleep
        kernel -> runmem
        sleep -> swap
        swap -> runswap
        runswap -> new
        runswap -> runmem
        new -> runmem
        sleep -> runmem
    }
''')
```

![스크린샷 2025-04-09 오후 3.44.16.png](/images/streamlit/chapter02/part03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.44.16.png)

<br>

# Third-party components

- https://github.com/andfanilo/streamlit-echarts
- https://github.com/randyzwitch/streamlit-folium
- https://github.com/explosion/spacy-streamlit
- https://github.com/ChrisDelClea/streamlit-agraph
- https://github.com/andfanilo/streamlit-lottie
- http://github.com/null-jones/streamlit-plotly-events
- https://extras.streamlit.app/
- https://github.com/tvst/plost
- https://github.com/facebookresearch/hiplot
