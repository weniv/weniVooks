---
chapter: React Router
title: createBrowserRouter, RouterProvider
date: 2024-07-16
---

`createBrowserRouter`와 `RouterProvider`는 React Router v6.4.0에서 도입된 새로운 API입니다. React Router 공식 문서에서는 기존 BrowserRouter 방식보다 이 새로운 방식을 사용하는 것을 권장하고 있습니다. 현재 기존의 BrowserRouter와 새로운 createBrowserRouter, RouterProvider 방식 모두 지원하고 있습니다. 기존 프로젝트에서는 BrowserRouter를 더 자주 보실 수 있겠지만, 이 교재에서는 공식 문서에서 권장하는 새로운 API 중 createBrowserRouter, RouterProvider 대해서도 학습해보도록 하겠습니다.

먼저 Create React App(CRA)를 사용하여 프로젝트를 생성해줍니다.
```bash
npx create-react-app my-router

cd my-router # my-router 프로젝트로 이동
npm start # 프로젝트 실행
```

# 1. RouterProvider

`RouterProvider`는 라우터 객체를 props로 전달받아 라우팅 설정을 적용하고, 현재 URL에 해당하는 컴포넌트를 렌더링합니다.

```jsx
<RouterProvider router={router} />
```

여기서 router 객체는 React Router에서 제공하는 라우터 객체를 생성하는 함수를 통해 생성한 라우터 객체를 의미합니다. 대표적으로 `createBrowserRouter`, `createMemoryRouter`, `createHashRouter` 등이 있습니다.

RouterProvider는 주로 Create React App (CRA)로 생성한 React 프로젝트에서 index.js 파일에서 애플리케이션 전체를 감싸는 데 사용됩니다. RouterProvider는 전체 애플리케이션을 감싸고 있어, 앱 전체에 라우팅 기능을 제공합니다.

`index.js`
```jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import App from './App';
import { createBrowserRouter, RouterProvider } from "react-router-dom";

const router = createBrowserRouter([
    {
      path: "/",
      element: <App />,
    },
]);

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
    <React.StrictMode>
      <RouterProvider router={router} />
    </React.StrictMode>
);
```

# 2. createBrowserRouter

## 2.1 라우터 객체

`createBrowserRouter`는 라우터 객체를 생성합니다. 

```jsx
const router = createBrowserRouter([
    {
        path: "/",
        element: <div>Hello world!</div>,
    },
    {
        path: "/weniVooks",
        element: <div>Welcome to weniVooks!</div>
    },
]);
```

`path`는 URL 경로를 의미하며, `element`는 해당 경로와 매칭될 때 렌더링할 React 컴포넌트를 지정합니다. `/` 경로로 이동하면 "Hello world!"라는 문구가 화면에 표시되고, `/weniVooks` 경로로 이동하면 "Welcome to weniVooks!"라는 문구가 표시됩니다.

프로젝트를 실행하여 확인해보겠습니다.

`src/index.css`
```css
body {
  margin: 0;
  padding: 10px;
  font-family: sans-serif;
}
```

`src/index.jsx`
```jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import { createBrowserRouter, RouterProvider } from "react-router-dom";

const router = createBrowserRouter([
    {
        path: "/",
        element: <div>Hello World!</div>,
    },
    {
        path: "/weniVooks",
        element: <div>Welcome to weniVooks!</div>
    },
]);

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <React.StrictMode>
      <RouterProvider router={router} />
  </React.StrictMode>
);
```

RouterProvider 컴포넌트는 최상위 컴포넌트로 전체 애플리케이션을 감싸고 있어, 앱 전체에 라우팅 기능을 제공합니다. 브라우저의 URL이 변경되면, RouterProvider는 현재 URL을 createBrowserRouter로 정의한 라우트 설정과 비교합니다. 일치하는 경로를 찾으면, 해당 경로에 정의된 element(컴포넌트)를 렌더링합니다. 위 예시에서는 `localhost:3000/` 와 `localhost:3000/weniBooks` 로 접속하면 각각 "Hello World!"와 "Welcome to weniBooks!"라는 문구가 보일 것입니다.

## 2.2 errorElement

라우팅 과정에서 에러가 발생하면 이를 처리하는 새로운 API가 있습니다. 바로 **errorElement**입니다. 라우트 과정에서 렌더링을 하거나 데이터를 가져오지 못하는 등의 에러가 발생하면 기존 element에 지정된 컴포넌트 대신 errorElement에 지정된 컴포넌트가 렌더링됩니다. 전역적인 범위의 errorElement를 설정할 수 있고, 특정 라우터에 대해서도 설정할 수 있습니다. 

라우팅을 위한 routes 폴더를 만들고 error-page.jsx 파일을 생성합니다.

`src/routes/error-page.jsx`

```jsx
export default function ErrorPage() {
    return (
        <div id="error-page">
            <h1>에러 발생!</h1>
        </div>
    );
}
```

`src/index.jsx`

```jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import { createBrowserRouter, RouterProvider } from "react-router-dom";
import ErrorPage from "./routes/error-page.jsx";

const router = createBrowserRouter([
    {
        path: "/",
        element: <div>Hello World!</div>,
        errorElement: <ErrorPage />,
    },
    {
        path: "/weniVooks",
        element: <div>Welcome to weniVooks!</div>
    },
]);

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <React.StrictMode>
      <RouterProvider router={router} />
  </React.StrictMode>
);
```

`localhost:3000/없는경로` 경로로 접속하면, ErrorPage 컴포넌트가 렌더링됩니다. 존재하지 않는 경로로 접속한 경우에 errorElement에 지정된 컴포넌트가 렌더링됩니다. 라우트 과정에서 발생한 에러의 상세 정보를 얻으려면 `useRouteError` 훅을 사용할 수 있습니다. useRouteError 훅은 errorElement 내에서 발생한 에러 객체를 반환하여 에러의 세부 정보를 확인할 수 있게 해줍니다.

 `src/routes/error-page.jsx`

```jsx
import { useRouteError } from "react-router-dom";

export default function ErrorPage() {
    const error = useRouteError();
    console.error(error);

    return (
        <div id="error-page">
		    <h1>에러 발생!</h1>
            <p>
                <i>{error.statusText || error.message}</i>
            </p>
        </div>
    );
}
```

화면과 콘솔창에서 어떤 에러가 발생했는지 확인해봅시다. 

:::div{.beforeAfter}
| 화면 | 콘솔창 |
| ------------------------------------------ | ------------------------------------------ |
| ![화면 속 에러 메세지](/images/basecamp-react/chapter03-5/chapter03-5-1.png) | ![에러 객체 확인](/images/basecamp-react/chapter03-5/chapter03-5-2.png) |
:::

존재하지 않는 경로로 접속했기 때문에 `HTTP 404 에러`가 발생한 것을 알 수 있습니다.(HTTP 404 에러는 서버가 요청받은 리소스를 찾을 수 없다는 것을 의미합니다.) `localhost:3000/react` 경로로 접속했기 때문에 에러 객체의 data 필드를 보면 "/react" URL에 대한 라우트가 없다는 것을 확인할 수 있습니다.

## 2.3 중첩라우팅
중첩된 라우팅은 공통 레이아웃을 유지하면서 특정 부분만 동적으로 변경할 수 있게 해줍니다. 중첩 라우팅을 설정할 때는 children 속성을 사용합니다.

```jsx
const router = createBrowserRouter([
    {
        path: "/wenivooks",
        element: <WeniVooks />,
        children: [
            {
                path: "basecamp-javascript",
                element: <BasecampJavascript />,
            },
            {
                path: "rightnow-react",
                element: <RightNowReact />,
            },
        ],
    },
]);
```

중첩된 라우팅이므로 `localhost:3000/wenivooks/basecamp-javascript` 경로에 접속하면 WeniVooks 컴포넌트와 BasecampJavascript 컴포넌트가 함께 렌더링됩니다. 마찬가지로 `localhost:3000/wenivooks/rightnow-react` 경로에 접속하면 WeniVooks 컴포넌트와 RightNowReact 컴포넌트가 함께 렌더링됩니다. 이때 자식 컴포넌트(BasecampJavascript 또는 RightNowReact)가 WeniVooks 컴포넌트의 어느 위치에 렌더링될지 지정해야 합니다. 이를 위해 `Outlet` 컴포넌트를 사용합니다.

중첩 라우팅의 예시를 살펴보겠습니다.

`src/routes/wenivooks.jsx`

```jsx
import { Outlet } from "react-router-dom";

export default function WeniVooks() {
	return (
		<div>
			<h1>Welcome to WeniVooks!</h1>
			<hr/>
			<Outlet />
		</div>
	)
}
```

`src/routes/basecamp-javascript.jsx`

```jsx
export default function BasecampJavascript() {
	return (
		<div>
			<h2>JavaScript 베이스캠프 ⛺️</h2>
			<ol>
				<li>JavaScript의 기초</li>
				<li>원시타입에 관하여</li>
				<li>함수</li>
				<li>객체 타입에 관하여</li>
			</ol>
		</div>
	)
}
```

`src/routes/rightnow-react.jsx`

```jsx
export default function RightNOwReact() {
	return (
		<div>
			<h2>React 라잇나우 💻️</h2>
			<ol>
				<li>React 소개</li>
				<li>React 기초</li>
				<li>React Router</li>
				<li>Hooks</li>
			</ol>
		</div>
	)
}
```

`src/index.jsx`

```jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import { createBrowserRouter, RouterProvider } from "react-router-dom";
import ErrorPage from "./routes/error-page.jsx";
import WeniVooks from "./routes/wenivooks";
import BasecampJavascript from "./routes/basecamp-javascript";
import RightNowReact from "./routes/rightnow-react";

const router = createBrowserRouter([
    {
        path: "/",
        element: <div>Hello World!</div>,
        errorElement: <ErrorPage/>,
    },
    {
        path: "/weniVooks",
        element: <WeniVooks />,
        children: [
            {
                path: "basecamp-javascript",
                element: <BasecampJavascript />,
            },
            {
                path: "rightnow-react",
                element: <RightNowReact />,
            },
        ],
    },
]);

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
    <React.StrictMode>
        <RouterProvider router={router} />
    </React.StrictMode>
);
```

`localhost:3000/wenivooks` 경로에 접속하면 WeniVooks 컴포넌트만 렌더링됩니다. `localhost:3000/wenivooks/basecamp-javascript`에 접속하면 WeniVooks 컴포넌트 내의 `<Outlet />` 위치에 BasecampJavascript 컴포넌트가 렌더링되고, `localhost:3000/wenivooks/rightnow-react`에 접속하면 마찬가지로 `<Outlet />` 위치에 RightNowReact 컴포넌트가 렌더링됩니다.


:::div{.beforeAfter}
| 경로 | 화면 |
| ------------------------------------------ | ------------------------------------------ |
| localhost:3000/wenivooks | ![/wenivooks 경로 화면](/images/basecamp-react/chapter03-5/chapter03-5-3.png) |
| localhost:3000/wenivooks/basecamp-javascript | ![/wenivooks/basecamp-javascript 경로 화면](/images/basecamp-react/chapter03-5/chapter03-5-4.png) 
| localhost:3000/wenivooks/rightnow-react | ![/wenivooks/rightnow-react 경로 화면](/images/basecamp-react/chapter03-5/chapter03-5-5.png) |
:::

중첩 라우팅을 사용하면 웹사이트의 공통된 부분(예를 들어, 이 경우 WeniVooks)은 그대로 유지하면서 특정 부분(Outlet 컴포넌트 내용)만 필요에 따라 바꿀 수 있습니다. 이렇게 하면 코드를 재사용하기 쉽고 잘 정리할 수 있어 편리합니다.

## 2.4 동적 라우팅

이전에 배웠던 동적 라우터 파라미터(`/:id` 형식의 URL 패턴)을 사용하여 동적 라우팅을 구현합니다. `/:id` 부분에 해당하는 사용자의 아이디를 기반으로 사용자별 프로필 페이지를 보여주는 예시를 살펴보겠습니다.

`src/index.jsx`

```jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import { createBrowserRouter, Outlet, RouterProvider, useParams } from "react-router-dom";

function Root() {
    return (
        <div>
            <h1>React 스터디 페이지</h1>
            <hr/>
            <Outlet/>
        </div>
    )
}

function Home() {
    return <h2>홈</h2>
}

function UserProfile() {
    const { id } = useParams();   // 파라미터 추출
    return (
        <div>
            <h2>스터디원 ✨{id}✨의 페이지</h2>
        </div>
    )
}

const router = createBrowserRouter([
    {
        path: '/',
        element: <Root />,
        children: [
            { index: true, element: <Home /> },
            { path: 'user/:id', element: <UserProfile /> },
        ],
    },
]);

ReactDOM.createRoot(document.getElementById("root")).render(
    <React.StrictMode>
        <RouterProvider router={router} />
    </React.StrictMode>
);
```

루트 경로(`/`)에 접속하면 "React 스터디 페이지"라는 문구와 `<Outlet />` 위치에 "홈"이라는 문구가 표시됩니다. "홈"이라는 문구가 표시되는 것은 `index: true` 설정 때문입니다. `index: true`는 부모 라우트의 경로와 정확히 일치할 때 렌더링될 컴포넌트를 지정합니다. 즉, 다른 자식 라우트가 매치되지 않고 현재 URL이 부모 라우트의 경로와 정확히 일치할 때 이 인덱스 라우트가 렌더링됩니다. `<Home />` 컴포넌트는 Root 컴포넌트 내 `<Outlet />` 위치에 렌더링됩니다.

`localhost:3000/user/:id`에 접속하면 Root 컴포넌트 내의 `<Outlet />` 위치에 UserProfile 컴포넌트가 렌더링됩니다. `useParams` 훅을 사용해 파라미터를 추출하고 파라미터 값을 페이지에 표시합니다. 따라서 `localhost:3000/user/user1`, `localhost:3000/user/user2` 등의 URL로 접속하면 해당 id 값을 포함한 페이지가 표시됩니다.

:::div{.beforeAfter}
| 경로 | 화면 |
| ------------------------------------------ | ------------------------------------------ |
| localhost:3000/ | ![react 스터디 홈페이지](/images/basecamp-react/chapter03-5/chapter03-5-6.png) |
| localhost:3000/user/user1 | ![react 스터디 사용자 프로필 페이지](/images/basecamp-react/chapter03-5/chapter03-5-7.png) |
:::

:::div{.callout}

이외에도 추가된 다양한 API가 있습니다. 더 알고 싶다면 아래에 공식 문서 링크를 남겼으니 참고해주세요.

::a[React Router Data Api]{class='btn-link' href="https://reactrouter.com/en/main/routers/picking-a-router" target="\_blank"}

:::