---
chapter: 3. SQL 7원칙
title: 2. SQL 1원칙 - 업무 지시를 SQL로 이해하기 위해서
date: 2024-05-10
---

본격적으로 SQL을 배우기 위해 먼저 필요한 것은 정확한 업무를 파악하는 것입니다. 사실 분석관련 학과나 업무를 해보지 않으신 분들은 어떻게 접근해야하는지 잘 모를때가 많습니다. 더군다나 일상의 언어를 SQL 구문대로 이해하려면 머릿속으로 그려지기가 쉽지 않습니다. 거의 외국어나 다름이 없을거라 생각합니다. 그래서 SQL을 실제적으로 나의 업무에 적용한다고 생각하고 SQL 구문을 짠다면 좀더 명확해질거라 생각합니다. 여기에서 살펴봐야할 것은 다음과 같습니다.

# 1. 일단 요청자가 무엇을 요청하는지 정확히 듣습니다.

SQL로 업무를 수행하는 내용 중에 대부분은 필요한 자료를 추출하는 것이 대부분입니다. 그렇기 때문에 어떠한 업무인지를 잘 파악해야합니다.

1) 데이터가 담긴 테이블이 있는지?
2) 조건이 무엇인지?
3) 어떤 그룹으로 그룹화할지?
4) 그룹화한 후 조건은 무엇인지?
5) 어떤 컬럼을 출력할지?

# 2.요청된 내용에서 단서를 찾아봅니다.

아래 3가지 예시에서 단서를 찾는 방법을 연습해봅시다.

:::div{.callout}
김대리, 현재 2023년에 구매한 사람들의 주문금액 합을 구하고, 10만원이하인 고객은 제외하고, 가장 많이 주문한 고객을 찾아줘
:::

한번 이 글을 여러분들께서 보시고, 어떤 것을 수행해야할지 짐작해보세요. 일단 문장단위로 나눕니다. 나눠보면 다음과 같습니다.

1) 2023년 

2) 구매한 사람

3) 주문금액의 합

4) 10만원 이하고객 제외

5) 가장 많이 주문한 고객

:::div{.callout}
이과장, 내일까지 서울시 자료만 추출해서 구별로 우리 고객이 얼마나 분포되어있는지 집계하고, 우리 고객 비율이 낮은 구는 추가마케팅 하자고, 보고자료 부탁해
:::


1) 내일까지 (중요)

2) 서울시자료만 (그러나 다른시도 중요할수도)

3) 구별로

4) 우리고객이 얼마나 분포되어있는지 집계

5) 비율이 낮은 구 필요

:::div{.callout}
박차장, 우리 서비스 중 앱서비스의 20대 고객 비중이 좀 늘은거 같은데, 얼마나 늘었는지 한번 자료좀 추출해주고, 성별로 나눠서 데이터 좀 부탁해
:::

1) 우리서비스

2) 앱서비스 20대 고객 비중 (그외 비중도)

3) 얼마나 늘었는지

4) 성별로 나눠서

# 3. 만약 나누어진 조건 중에 이해가 가지 않는 부분이 있으면 정확하게 파악한다.

SQL로 일을 하는 것은 결국 정확한 조건을 컴퓨터에 넣어서 원하는 값을 뽑아내고 요약하는 일입니다. 그렇기 때문에 조건을 최대한 명확하게 받아서 작업을 해야합니다.

:::div{.callout}
김대리, 현재 2023년에 구매한 사람들의 주문금액 합을 구하고, 10만원이하인 고객은 제외하고, 가장 많이 주문한 고객을 찾아줘
:::

한번 이 글을 여러분들께서 보시고, 어떤 것을 수행해야할지 짐작해보세요. 일단 문장단위로 나눕니다. 나눠보면 다음과 같습니다.

1) 2023년 
→ 2023년 말고 비교할수 있는 자료도 필요한지?

2) 구매한 사람 
→ 구매한 사람에 대해 정의 필요

3) 주문금액의 합 
→ 구매한 사람의 합을 어떻게 구하면 좋을지?

4) 10만원 이하고객 제외
→ 단일 가격 10만원인지, 모든 가격의 합계 10만원 인지

5) 가장 많이 주문한 고객
→ 가장 많다라는 기준을 어떻게 둘것인지?

:::div{.callout}
이과장, 내일까지 서울시 자료만 추출해서 구별로 우리 고객이 얼마나 분포되어있는지 집계하고, 우리 고객 비율이 낮은 구는 추가마케팅 하자고, 보고자료 부탁해
:::


1) 내일까지
→ 우리 자료는 날짜형식이 어떻게 저장되어있는지?

2) 서울시자료만
→ 서울시라는 것을 정의하기 위해 우리 자료는 서울시라는 정보가 어떻게 적재되어있는지?

3) 구별로
→ 2)번과 동일

4) 우리고객이 얼마나 분포되어있는지 집계
→ 우리고객을 어떻게 정의할 것인가? 실제 사용한 고객? 방문한 고객? 등

5) 비율이 낮은 구 필요
→ 비율을 어떻게 구할 것인가? 분모는 어떻게 분자는 어떻게?

:::div{.callout}
박차장, 우리 서비스 중 앱서비스의 20대 고객 비중이 좀 늘은거 같은데, 얼마나 늘었는지 한번 자료좀 추출해주고, 성별로 나눠서 데이터 좀 부탁해
:::


1) 우리서비스
→ 우리서비스에 대한 정의를 어떻게 할 것인가? 

2) 앱서비스 20대 고객 비중 (그외 비중도)
→ 우리 자료중에 앱과 웹을 나누는 기준이 있는가? 20대는 어디까지 나눌것인가?

3) 얼마나 늘었는지
→ 늘었다는 기준을 어느 기준으로 둘것인가?

4) 성별로 나눠서
→ 성별은 어떤 형식으로 자료가 들어있는가?

이처럼 당연하게 생각하는 업무지시도 풀다보면 궁금한 것들이 생기게 됩니다. 이러한 것들을 명확하게 하지 않으면 SQL은 결국 입력한 대로 출력하는 구조이다보니 잘못된 결과를 출력할 수도 있겠죠?

# 4. 조건이 명확해 졌다면 이제 예상되는 결론을 그려봐야합니다.


:::div{.callout}
김대리, 현재 2023년에 구매한 사람들의 주문금액 합을 구하고, 10만원이하인 고객은 제외하고, 가장 많이 주문한 고객을 찾아줘
:::


- 조건 : 주문 금액 합계 10만원이하 고객은 제외

|  | 주문 건수 | 주문 금액 합계 |
| --- | --- | --- |
| 고객A | 3건 | 15만원 |
| 고객B | 4건 | 10만원 |
| 고객C | 2건 | 40만원 |

→ 가장 많은 주문금액인 고객은 고객 C

:::div{.callout}
이과장, 내일까지 서울시 자료만 추출해서 구별로 우리 고객이 얼마나 분포되어있는지 집계하고, 우리 고객 비율이 낮은 구는 추가마케팅 하자고, 보고자료 부탁해
:::


- 조건 : 서울시 고객만 추출 - ‘서울시, ‘서울특별시’로 된 자료 포함

|  | 인구수 | 우리 서비스 이용 고객 | 비율 |
| --- | --- | --- | --- |
| 금천구 | 30만명 | 10만명 | 33.3% |
| 양천구 | 20만명 | 10만명 | 50% |
| 강남구 | 10만명 | 8만명 | 80% |

→ 마케팅이 시급한 구는 금천구로 추가 마케팅을 하기 위한 계획 수립 필요

:::div{.callout}
박차장, 우리 서비스 중 앱서비스의 20대 고객 비중이 좀 늘은거 같은데, 얼마나 늘었는지 한번 자료좀 추출해주고, 성별로 나눠서 데이터 좀 부탁해
:::

- 우리 서비스 3개 서비스 전체 고객수 집계(중복은 제외)
- 서비스 집계는 2024년 집계 3월 기준 집계
- 비교는 2023년 3월 대비 얼마나 늘었는지 파악

[1. 2024년 고객 집계]

|  | 1번 서비스 | 2번 서비스 | 3번 서비스 | 집계(중복 제거) |
| --- | --- | --- | --- | --- |
| 남자 고객 | 100 | 150 | 200 | 250 |
| 여자 고객 | 50 | 150 | 400 | 300 |

[2. 2023년 대비 2024년 증감율 확인]

|  | 2024년 고객 | 2023년 고객 | 증가율 |
| --- | --- | --- | --- |
| 남자 고객 | 250 | 100 | 250% |
| 여자 고객 | 300 | 200 | 150% |
- 우리서비스는 고객은 여자 고객이 더 많으나 최근 1년간 남자고객의 증가율이 두드러짐 
이유는 ***와 같음
- 현재 여자고객의 경우 1번 서비스가 저조한 상황 어떻게 추가적으로 마케팅을 해야할지 전략 필요

다음과 같이 예상되는 결과를 미리 적으면 분석할 때 정리가 더 빨리자고, 목표가 정해졌기 때문에 SQL쿼리로 구현이 더 쉬워집니다. 이러한 4가지 방법을 통해 업무를 정해놓고, 앞으로 배울 SQL구문들을 추출하신다면 더 쉽고 효율적으로 배우실거라 확신합니다.

이러한 분석은 SQL 코딩테스트에서도 동일하게 이뤄지는데요. SQL원칙을 모두 배운다음에 적용해보겠습니다. 다음시간에 배울 From부터는 위의 내용을 통해 업무를 파악하고, 분석을 어떻게 진행할지 배워보도록 하겠습니다.

# Tip) SQL을 진행하기 전에 체크해봐야 할 것은?

무조건 업무를 수행하기전에 다음과 같은 내용을 확인해서 요청한 내용이 SQL로 추출 가능한지 파악해야합니다.

1) 테이블이 있는지? 
분석을 하고 싶어도 테이블이 없으면 SQL로 분석할수가 없습니다.

2) 자료가 있는지?
테이블이 있어도 그 안에 내가 원하는 자료가 없으면 분석을 할수 없습니다.

3) 시간은 충분한지? 
강의에서는 시간을 충분히 드리지만 현실에서는 시간이 제한적입니다.

4) 나의 실력으로 뽑을수 있는지? 
내가 추출할 수 있는지 없는지를 파악해야합니다. 실력은 점점 느실거에요

5) 도와줄 팀원은 없는지? 
아직 업무가 미숙할때 도와줄 팀원이 있는지를 파악해야합니다. 만약 혼자 업무를 하신다면 열심히 강의를 들어봅시다.

이상으로 업무 지시를 분석하는 방법을 배웠습니다. 지금은 초급자에 해당하는 수준으로 업무를 파악하는 방법을 알려드렸는데요. 앞으로 업무 지시를 받았다고 가정하고, 그러한 내용들을 SQL 실습때 녹여보려고 합니다. 본격적으로 SQL의 세계로 들어가봐요!