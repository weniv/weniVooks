---
chapter: 데이터 분석
title: 간단한 Pandas
date: 2024-09-24
---

# 1. Pandas

Pandas는 데이터 분석을 위한 라이브러리로, Numpy와 함께 데이터 분석에 있어서 가장 기본이 되는 라이브러리입니다. Pandas는 데이터를 효과적으로 처리할 수 있는 다양한 기능을 제공합니다. 이번 챕터에서는 Pandas의 기본적인 사용법을 알아보겠습니다.

## 1.1 Pandas의 데이터 구조

Pandas는 크게 Series와 DataFrame 두 가지 데이터 구조를 제공합니다. Series는 1차원 배열이고, DataFrame은 2차원 배열입니다. Series와 DataFrame은 Numpy 배열과 유사하지만, 인덱스를 가지고 있어 데이터를 더 효율적으로 처리할 수 있습니다.

::img{src="/images/essentials-numpy-pandas/chapter04/pandas_data_structure.png"}

## 1.2 Pandas Series

Pandas Series는 1차원 배열입니다. Series는 인덱스를 가지고 있어 데이터를 더 효율적으로 처리할 수 있습니다. 이 인덱스는 데이터의 레이블 역할을 하며, 데이터를 빠르게 검색할 수 있습니다.

```python-exec
import pandas as pd

data = [1, 2, 3, 4, 5]
s = pd.Series(data)
print(s)
print(s[0])
print(s[1:4])
```

아래는 Series의 인덱스를 지정하는 예제입니다.

```python-exec
import pandas as pd

data = [1, 2, 3, 4, 5]
index = ['a', 'b', 'c', 'd', 'e']
s = pd.Series(data, index=index)
print(s)
print(s['a'])
print(s['b':'d'])
# print(s[0]) # 이 방식도 가능합니다.
```

인덱스를 지정하지 않으면 0부터 시작하는 정수 인덱스가 자동으로 생성됩니다. 지정을 하면 해당 인덱스로 데이터를 조회할 수 있습니다. 이렇게 지정되지 않았을 때 0부터 시작하는 정수 인덱스를 **묵시적 인덱스**라고 합니다. 또한 인덱스를 지정하여 데이터를 조회할 때에는 **명시적 인덱스**라고 합니다.

## 1.3 Pandas DataFrame

Pandas DataFrame은 2차원 배열입니다. DataFrame은 행과 열로 구성되어 있으며, 각 열은 서로 다른 데이터 타입을 가질 수 있습니다. DataFrame은 여러 개의 Series로 구성되어 있습니다.

```python-exec
import pandas as pd

data = {
    'name': ['John', 'Anna', 'Peter', 'Linda'],
    'age': [25, 36, 29, 24],
    'city': ['New York', 'Paris', 'Berlin', 'London']
}
df = pd.DataFrame(data)
df
```

DataFrame은 딕셔너리 형태로 데이터를 입력할 수 있습니다. 딕셔너리의 키는 열 이름이 되고, 값은 해당 열의 데이터가 됩니다. DataFrame은 열 이름을 통해 데이터를 조회할 수 있습니다.

## 1.4 데이터 불러오기

Pandas는 다양한 데이터 포맷을 지원합니다. CSV, Excel, SQL, JSON 등 다양한 데이터를 불러올 수 있습니다. 앞서 타이타닉 예제는 CSV 파일을 불러온 것이고, 이번에는 HTML을 불러오도록 하겠습니다. 불러올 페이지는 아래와 같습니다.

::a[크롤링 연습 페이지]{class='btn-link' href="https://paullab.co.kr/stock.html" target="_blank"}

```python-exec
import pandas as pd
from pyodide.http import open_url

data = open_url('https://paullab.co.kr/stock.html')
df = pd.read_html(data)
df[0] # 0, 1, 2 등을 차례로 넣어보세요.
```

## 1.5 데이터 저장하기

Pandas는 데이터를 다양한 형식으로 저장할 수 있습니다. CSV, Excel, SQL, JSON 등 다양한 형식으로 저장할 수 있습니다. 아래는 DataFrame을 CSV 파일로 저장하는 예제입니다. 위니북스에서는 파일 저장 기능이 제한되어 있습니다.

```python
import pandas as pd

data = {
    'name': ['John', 'Anna', 'Peter', 'Linda'],
    'age': [25, 36, 29, 24],
    'city': ['New York', 'Paris', 'Berlin', 'London']
}
df = pd.DataFrame(data)
df.to_csv('data.csv', index=False)
```

위 코드를 실행하면, 현재 디렉토리에 `data.csv` 파일이 생성됩니다. `index=False`는 인덱스를 저장하지 않도록 하는 옵션입니다.

## 1.6 인덱싱과 슬라이싱

Pandas는 Numpy와 유사하게 인덱싱과 슬라이싱을 지원합니다. 인덱싱은 열 이름을 사용하거나, `loc`, `iloc`을 사용하여 데이터를 조회할 수 있습니다.

```python-exec
import pandas as pd

data = {
    'name': ['John', 'Anna', 'Peter', 'Linda'],
    'age': [25, 36, 29, 24],
    'city': ['New York', 'Paris', 'Berlin', 'London']
}
df = pd.DataFrame(data)
df
```

하나씩 주석을 풀어가며 실행해보세요.

```python-exec
print(df['name'])
# print(df.loc[0])
# print(df.iloc[0])
# print(df.iloc[0:2])
```

## 1.7 데이터 조작

Pandas는 데이터를 조작하고 변환하는 다양한 기능을 제공합니다. 결측값 처리, 데이터 정렬, 데이터 형 변환, 문자열 데이터 조작 등의 기능을 제공합니다.

* 데이터 조작
```python-exec
import pandas as pd

data = {
    'name': ['John', 'Anna', 'Peter', 'Linda'],
    'age': [25, 36, 29, 24],
    'city': ['New York', 'Paris', 'Berlin', 'London']
}

df = pd.DataFrame(data)
df['age'] = df['age'] + 1
df
```

* 데이터 컬럼 추가
```python-exec
df['ageAdd'] = df['age'] + 10
df
```

* 데이터 컬럼 삭제
```python-exec
df.drop('ageAdd', axis=1, inplace=True)
df
```

* 데이터 정렬
```python-exec
df.sort_values(by='age', ascending=False)
```

* 결측값 확인 및 제거
```python-exec
data = {
    'name': ['John', 'Anna', 'Peter', 'Linda', None],
    'age': [25, 36, 29, 24, None],
    'city': ['New York', 'Paris', 'Berlin', 'London', None]
}

df = pd.DataFrame(data)
df
```

* 결측값 확인
```python-exec
df.isnull().sum()
```

* 결측값 제거
```python-exec
df.dropna()
# df # 원본은 변하지 않습니다.
```

* 결측값 채우기
```python-exec
df.fillna('Unknown')
```

## 1.8 집계 함수
Pandas는 NumPy보다 다양한 집계 함수를 제공합니다. `sum()`, `mean()`, `max()`, `min()` 등의 함수를 사용하여 데이터를 집계할 수 있습니다.

* count : 데이터 개수 구하는 함수
* min : 최소값 구하는 함수
* max  : 최대값 구하는 함수
* mean : 평균 구하는 함수
* median : 중앙값 구하는 함수
* std : 표준편차 구하는 함수
* var : 분산 구하는 함수
* mad : 절대 표준편차 구하는 함수
* describe : 기초 통계를 한 번에 볼 수 있는 함수

```python-exec
import pandas as pd

data = {
    'name': ['John', 'Anna', 'Peter', 'Linda'],
    'age': [25, 36, 29, 24],
    'city': ['New York', 'Paris', 'Berlin', 'London']
}

df = pd.DataFrame(data)
df['age'].sum()
```

## 1.9 데이터 사전 분석

Pandas는 데이터를 사전 분석하는 다양한 기능을 제공합니다. `head()`, `tail()`, `info()`, `describe()` 등의 함수를 사용하여 데이터를 미리 살펴볼 수 있습니다.

* head : 데이터의 처음 5개 행을 보여주는 함수
* tail : 데이터의 마지막 5개 행을 보여주는 함수
* info : 데이터의 정보를 보여주는 함수
* describe : 기초 통계를 한 번에 볼 수 있는 함수

```python-exec
import pandas as pd

# 조금 큰 데이터 생성
data = {
    'name': ['John', 'Anna', 'Peter', 'Linda', 'Tom', 'Jerry', 'Mike', 'Jane', 'Alice', 'Bob'],
    'age': [25, 36, 29, 24, 30, 35, 28, 27, 26, 31],
    'city': ['New York', 'Paris', 'Berlin', 'London', 'Tokyo', 'Seoul', 'Beijing', 'Moscow', 'Sydney', 'Toronto']
}

df = pd.DataFrame(data)
df.head()
```
