---
chapter: Pandas :네 번째 걸음
title: Pandas DataFrame
date: 2024-07-17
---

# 1. 데이터프레임이란?

DataFrame은 파이썬의 판다스 라이브러리에서 제공하는 2차원 데이터 구조입니다. 행과 열로 구성되어 있으며, 다양한 유형의 데이터를 효율적으로 저장하고 처리할 수 있습니다. 엑셀 스프레드시트와 유사한 형태를 가지고 있지만, 더 강력한 데이터 조작 및 분석 기능을 제공합니다.

DataFrame의 주요 특징은 다음과 같습니다

1. 각 열은 서로 다른 데이터 타입을 가질 수 있어 유연한 데이터 처리가 가능합니다.
2. 행과 열에 대한 레이블(인덱스)을 사용하여 데이터에 쉽게 접근하고 조작할 수 있습니다.
3. 결측치 처리, 그룹화, 병합 등 다양한 데이터 처리 기능을 내장하고 있습니다.
4. 대용량 데이터를 효율적으로 처리할 수 있도록 최적화되어 있습니다.

```python-exec
import pandas as pd

# 세계 커피 소비 데이터프레임 생성하기
df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본', '프랑스'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3, 5.4],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피', '카페오레'],
    '카페_수': [25000, 32000, 18000, 12000, 22000, 15000],
    '평균_가격': [2.5, 3.8, 1.5, 4.2, 3.5, 2.8]
})

# 데이터프레임 출력
print(df)

```

:::div{.callout}

**Tip !**

DataFrame은 엑셀 시트와 비슷해요. 열 이름은 맨 위에, 데이터는 그 아래에 있어요.
:::


# 2. DataFrame의 Index(인덱스)

DataFrame의 인덱스는 각 행을 고유하게 식별하는 레이블입니다. 인덱스는 데이터의 위치를 나타내며, 이를 통해 데이터를 빠르고 쉽게 검색, 정렬, 그리고 조작할 수 있습니다. DataFrame에는 명시적 인덱스와 묵시적 인덱스 총 두 가지 유형의 인덱스가 있습니다.

## 2.1 명시적 인덱스

명시적 인덱스는 사용자가 직접 지정한 인덱스입니다. 이는 데이터에 의미 있는 레이블을 부여하여 데이터의 해석과 관리를 용이하게 합니다. 예를 들어, 시계열 데이터의 경우 날짜를 인덱스로 사용하거나, 고유한 ID를 인덱스로 사용할 수 있습니다.

```python-exec
import pandas as pd

# 명시적 인덱스를 가진 데이터프레임 생성
df_explicit = pd.DataFrame({
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3, 5.4]
}, index=['브라질', '미국', '이탈리아', '한국', '일본', '프랑스'])

print("명시적 인덱스를 가진 데이터프레임:")
print(df_explicit)

# 기존 열을 인덱스로 설정
df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본', '프랑스'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3, 5.4]
})
df.set_index('국가', inplace=True)
print("\\n'국가' 열을 인덱스로 설정한 데이터프레임:")
print(df)

```


:::div{.callout}

**Tip !**

명시적 인덱스는 우리가 직접 정하는 거예요. 의미 있는 이름을 붙여주세요.
:::


## 2.2 묵시적 인덱스

묵시적 인덱스는 DataFrame 생성 시 사용자가 별도로 인덱스를 지정하지 않았을 때 자동으로 생성되는 인덱스입니다. 이때 생성되는 인덱스의 기본 타입은 RangeIndex로, 0부터 시작하는 정수 인덱스입니다.

```python-exec
import pandas as pd

# 묵시적 인덱스를 가진 데이터프레임 생성
df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본', '프랑스'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3, 5.4]
})

print("데이터프레임:")
print(df)

print("\\n인덱스 정보:")
print(df.index)

print("\\nRangeIndex 상세 정보:")
print(f"시작값(start): {df.index.start}")
print(f"종료값(stop): {df.index.stop}")
print(f"간격(step): {df.index.step}")

print("\\n인덱스 타입:")
print(type(df.index))

```




:::div{.callout}


**Tip !**

묵시적 인덕스는 자동으로 0부터 시작해요. 따로 설정 안 해도 돼요.
:::
## 2.3 데이터 프레임 변형 (pivot)

pivot 함수는 데이터프레임의 구조를 변경하여 특정 열의 고유한 값들을 새로운 열로 변환합니다. 이는 데이터를 더 넓은 형태로 재구성하는 데 유용합니다.

```python-exec
import pandas as pd

# 세계 커피 소비 데이터프레임 생성
df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본', '프랑스'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3, 5.4],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피', '카페오레'],
    '카페_수': [25000, 32000, 18000, 12000, 22000, 15000],
    '평균_가격': [2.5, 3.8, 1.5, 4.2, 3.5, 2.8]
})

# pivot을 사용하여 국가별 선호 종류에 따른 연간 소비량 표시
pivot_df = df.pivot(index='국가', columns='선호_종류', values='연간_소비량')
print("Pivot 결과:")
print(pivot_df)
```
:::div{.callout}

**Tip !**

pivot은 데이터를 접시에 담긴 음식처럼 펼쳐서, 행과 열을 바꾸어 새로운 모양으로 보여주는 마법 같은 기능이에요.
:::

## 2.4 데이터 프레임 변형 (melt)

melt 함수는 pivot의 반대 개념으로, "넓은" 형태의 데이터를 "긴" 형태로 변환합니다. 이는 여러 열을 두 개의 열(변수명과 값)로 재구성하는 데 사용됩니다.

```python-exec
import pandas as pd

# 세계 커피 소비 데이터프레임 생성
df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본', '프랑스'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3, 5.4],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피', '카페오레'],
    '카페_수': [25000, 32000, 18000, 12000, 22000, 15000],
    '평균_가격': [2.5, 3.8, 1.5, 4.2, 3.5, 2.8]
})

# melt를 사용하여 '연간_소비량'과 '카페_수'를 하나의 열로 변환
melted_df = pd.melt(df, id_vars=['국가', '선호_종류'], value_vars=['연간_소비량', '카페_수'], 
                    var_name='지표', value_name='값')
print("Melt 결과:")
print(melted_df)
```

:::div{.callout}

**Tip !**

melt는 넓은 데이터를 길게 늘어뜨려요. 마치 아이스크림이 녹아 길게 흐르는 것처럼, 데이터를 세로로 늘어뜨립니다..
:::

# 3. DataFrame 행, 열

DataFrame의 Column(열)은 세로로 늘어선 데이터의 집합으로, 각 열은 특정 속성이나 변수를 나타냅니다. 각 열은 고유한 이름(라벨)을 가지며, 동일한 데이터 타입을 갖는 것이 일반적입니다. Row(행)는 가로로 늘어선 데이터의 집합으로, 각 행은 하나의 관측치 또는 레코드를 나타냅니다.

## 3.1 DataFrame 행과 열 조회

DataFrame에서 데이터를 조회할 때는 행과 열 모두에 접근할 수 있습니다. 열 조회는 주로 열 이름을 사용하며, 행 조회는 인덱스나 위치를 사용합니다. 특정 조건에 맞는 데이터를 선택적으로 조회할 수도 있습니다.

```python-exec
import pandas as pd

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피']
})

# 특정 행 조회
print("두 번째 행:")
print(df.iloc[1])
```

```python-exec
# 특정 열 조회
print("\\n'연간_소비량' 열:")
print(df['연간_소비량'])
```

```python-exec
# 여러 열 조회
print("\\n'국가'와 '선호_종류' 열:")
print(df[['국가', '선호_종류']])
```

```python-exec
# 특정 행과 열 조회
print("\\n처음 3개 행의 '국가'와 '연간_소비량':")
print(df.loc[0:2, ['국가', '연간_소비량']])
```

```python-exec
# 조건부 조회
print("\\n연간 소비량이 4 이상인 국가:")
print(df[df['연간_소비량'] >= 4])
```


:::div{.callout}

**Tip !**

 열은 세로줄, 행은 가로줄이에요. 열은 변수, 행은 관측치라고 생각하세요.
:::


## 3.2 DataFrame 행과 열 추가

DataFrame에 새로운 데이터를 추가할 수 있습니다. 열 추가는 새로운 열 이름을 지정하고 데이터를 할당하는 방식으로 수행됩니다. 행 추가는 기존 DataFrame에 새로운 행 데이터를 연결하는 방식으로 이루어집니다.

```python-exec
import pandas as pd

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아'],
    '연간_소비량': [5.1, 4.2, 5.9]
})

# 새 행 추가
new_row = pd.DataFrame({'국가': ['한국'], '연간_소비량': [2.8]})
df = pd.concat([df, new_row], ignore_index=True)

print("행 추가 후:")
print(df)

# 새 열 추가
df['선호_종류'] = ['에스프레소', '아메리카노', '카푸치노', '카페라떼']

print("\\n열 추가 후:")
print(df)

# 계산된 값으로 새 열 추가
df['일일_소비량'] = df['연간_소비량'] / 365

print("\\n계산된 열 추가 후:")
print(df)
```

:::div{.callout}

**Tip !**

열 추가는 새 이름을 만들고 데이터를 넣어주면 돼요. 반면, 행 추가는 기존 DataFrame에 새 데이터를 이어붙이는 거예요.
:::


## 3.3 DataFrame 행과 열 삭제

DataFrame에서 불필요한 데이터를 제거할 수 있습니다. 열 삭제는 열 이름을 지정하여 수행하며, 행 삭제는 인덱스나 조건을 사용하여 수행합니다. 단일 또는 여러 행/열을 동시에 삭제할 수 있으며, 조건에 따른 삭제도 가능합니다.

```python-exec
import pandas as pd

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피']
})

# 특정 행 삭제
df_drop_row = df.drop(1)  # 인덱스 1인 행 삭제
print("인덱스 1 행 삭제 후:")
print(df_drop_row)

# 특정 열 삭제
df_drop_col = df.drop('선호_종류', axis=1)
print("\\n'선호_종류' 열 삭제 후:")
print(df_drop_col)

# 조건에 따른 행 삭제
df_filtered = df[df['연간_소비량'] > 3]
print("\\n연간_소비량이 3 초과인 행만 남김:")
print(df_filtered)

# 여러 열 삭제
df_multi_drop = df.drop(['연간_소비량', '선호_종류'], axis=1)
print("\\n'연간_소비량'과 '선호_종류' 열 삭제 후:")
print(df_multi_drop)

```


:::div{.callout}

**Tip !**

행이나 열을 지울 때는 drop() 함수를 사용해요. axis로 행(0)인지 열(1)인지 정해줘요.

:::

# 4. DataFrame의 데이터 접근

DataFrame의 데이터 조회란 DataFrame 내의 특정 데이터를 선택하고 접근하는 과정을 말합니다. 이는 원하는 행, 열, 또는 특정 조건을 만족하는 데이터를 추출하거나 볼 수 있게 해주는 작업입니다. 데이터 조회는 데이터 분석의 기초가 되며, 효율적인 데이터 처리를 위해 필수적인 기술입니다.
## 4.1  loc(Label-based indexing)

1. 인덱스 라벨을 사용합니다. 즉, 행과 열의 이름을 직접 지정하여 데이터에 접근할 수 있습니다.
2. 문자열 인덱스로 접근할 때 유용합니다. 특히 DataFrame의 열 이름이 문자열일 때 편리하게 사용할 수 있습니다.
3. 불리언 인덱싱을 지원합니다. 조건에 맞는 데이터를 쉽게 필터링할 수 있습니다.
4. 인덱스 라벨의 범위를 지정할 때, 시작점과 끝점을 모두 포함합니다.
5. 다중 조건을 사용한 복잡한 인덱싱도 가능합니다.

```python-exec
import pandas as pd

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피']
})

# loc 사용 예제
print("loc를 사용한 데이터 접근:")
print(df.loc[0:2, ['국가', '연간_소비량']])

# iloc 사용 예제
print("\\niloc를 사용한 데이터 접근:")


print(df.iloc[0:2, 0:2])

# 불리언 인덱싱 예제
print("\\n불리언 인덱싱을 사용한 데이터 접근 (연간 소비량 > 4):")
print(df.loc[df['연간_소비량'] > 4, ['국가', '연간_소비량']])
```

:::div{.callout}

**Tip !**

loc은 이름으로 데이터를 찾아요. 라벨이나 조건으로 데이터를 선택해야 할 때 사용해요.
:::
## 4.2 iloc (Integer-based indexing)
iloc는 정수 위치 기반 인덱싱을 사용하여 데이터에 접근하는 방법입니다.

정수 인덱스를 사용합니다. 즉, 행과 열의 번호로 데이터에 접근합니다.
0부터 시작하는 인덱스를 사용합니다.
파이썬의 일반적인 슬라이싱 규칙을 따릅니다 (끝 인덱스는 포함되지 않습니다).
위치 기반으로 데이터를 빠르게 선택할 수 있습니다.
특정 범위의 행과 열을 쉽게 선택할 수 있습니다
```python-exec
import pandas as pd

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피']
})

# iloc 사용 예제
print("iloc를 사용한 데이터 접근:")
print(df.iloc[0:2, 0:2])
```

:::div{.callout}

**Tip !**

iloc은 번호로 데이터를 찾아요. 위치 기반으로 데이터를 선택하거나, 숫자 인덱스를 사용해야 할 때 사용해요.
:::




## 4.3 at를 사용한 데이터 접근

at는 loc의 스칼라 버전으로, 단일 값에 접근할 때 사용됩니다. loc와 마찬가지로 라벨 기반 인덱싱을 사용하지만, 단일 요소에 대해 더 빠른 성능을 제공합니다. 특정 행과 열의 교차점에 있는 하나의 값을 빠르게 가져오거나 설정할 때 유용합니다.

```python-exec
import pandas as pd

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피']
})

# at를 사용한 단일 값 접근
print("at를 사용한 단일 값 접근:")
print(df.at[1, '국가'])  # 출력: 미국

# at를 사용한 값 수정
df.at[1, '국가'] = '캐나다'
print("수정 후 값:", df.at[1, '국가'])  # 출력: 캐나다

```
:::div{.callout}

**Tip !**

at는 이름(라벨)으로 특정 칸의 데이터를 빠르게 가져올 때 사용해요.
:::

## 4.4 iat를 사용한 데이터 접근

iat는 iloc의 스칼라 버전으로, 정수 인덱스를 사용하여 단일 값에 접근합니다. iloc와 마찬가지로 위치 기반 인덱싱을 사용하며, 단일 요소에 대해 가장 빠른 접근 성능을 제공합니다. 특정 행 번호와 열 번호의 교차점에 있는 하나의 값을 매우 빠르게 가져오거나 설정할 수 있습니다.

```python-exec
import pandas as pd

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피']
})

# iat를 사용한 단일 값 접근
print("iat를 사용한 단일 값 접근:")
print(df.iat[1, 0])  # 출력: 미국 (1행, 0열의 값)

# iat를 사용한 값 수정
df.iat[1, 0] = '캐나다'
print("수정 후 값:", df.iat[1, 0])  # 출력: 캐나다

```


:::div{.callout}

**Tip !**

iat는 번호(정수 인덱스)로 특정 칸의 데이터를 빠르게 가져올 때 사용해요.
:::


## 4.5 다중 조건 인덱싱

다중 조건 인덱싱은 여러 조건을 동시에 적용하여 DataFrame에서 특정 데이터를 선택하는 방법입니다. 이 방법은 복잡한 조건을 사용하여 데이터를 필터링할 때 매우 유용합니다. 주로 loc와 함께 사용되며, 불리언 연산자를 활용하여 여러 조건을 결합합니다.

다중 조건을 사용할 때는 각 조건을 괄호로 묶고, 논리 연산자(&: 그리고, |: 또는)를 사용하여 조건들을 연결합니다. 이를 통해 매우 구체적인 데이터 서브셋을 추출할 수 있습니다.

예시 코드:

```python-exec
import pandas as pd

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3],
    '선호_종류': ['에스프레소', '아메리카노', '카푸치노', '카페라떼', '드립커피']
})

# 다중 조건 인덱싱 예제
print("다중 조건 인덱싱 (연간 소비량 > 4 그리고 선호 종류가 '에스프레소'):")
result = df.loc[(df['연간_소비량'] > 4) & (df['선호_종류'] == '에스프레소')]
print(result)

# 다른 다중 조건 인덱싱 예제
print("\\n다중 조건 인덱싱 (연간 소비량 > 3 또는 국가가 '한국'):")
result = df.loc[(df['연간_소비량'] > 3) | (df['국가'] == '한국')]
print(result)

```


:::div{.callout}

**Tip !**

여러 조건으로 데이터를 고를 때는 괄호와 &(그리고), |(또는)를 잘 써주세요.
:::


# 5. DataFrame의 통계 및 연산

DataFrame의 통계 및 연산 기능은 데이터 분석에서 핵심적인 역할을 합니다. 이를 통해 데이터의 특성을 파악하고, 유용한 인사이트를 얻을 수 있습니다.

## 5.1 describe()

`describe()` 메서드는 데이터의 요약 통계 정보를 제공합니다. 수치형 데이터에 대해 개수, 평균, 표준편차, 최소값, 25% 백분위수, 50% 백분위수(중앙값), 75% 백분위수, 최대값을 계산합니다.

```python-exec
import pandas as pd
import numpy as np

df = pd.DataFrame({
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3, 5.4],
    '카페_수': [25000, 32000, 18000, 12000, 22000, 15000],
    '평균_가격': [2.5, 3.8, 1.5, 4.2, 3.5, 2.8]
})

print("기본 통계 요약:")
print(df.describe())

# 특정 백분위수 추가
print("\\n특정 백분위수를 포함한 통계 요약:")
print(df.describe(percentiles=[.05, .25, .75, .95]))

```


:::div{.callout}

**Tip !**

describe()는 데이터의 간단한 통계 정보를 한눈에 보여줘요.
:::


## 5.2 개별 통계 함수

각 열에 대한 특정 통계량을 계산하는 함수들도 제공됩니다.

```python-exec
print("연간 소비량의 합계:", df['연간_소비량'].sum())
print("연간 소비량의 평균:", df['연간_소비량'].mean())
print("연간 소비량의 중앙값:", df['연간_소비량'].median())
print("연간 소비량의 표준편차:", df['연간_소비량'].std())
print("연간 소비량의 최소값:", df['연간_소비량'].min())
print("연간 소비량의 최대값:", df['연간_소비량'].max())

# 상관계수 계산
print("\\n변수 간 상관계수:")
print(df.corr())

```


:::div{.callout}

**Tip !**

sum(), mean(), median() 같은 함수 등으로 원하는 통계값을 쉽게 구할 수 있어요.
:::


## 5.2 그룹별 연산

`groupby()` 메서드를 사용하면 데이터를 그룹화하고 각 그룹에 대해 연산을 수행할 수 있습니다.

```python-exec
df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본', '프랑스'],
    '대륙': ['남미', '북미', '유럽', '아시아', '아시아', '유럽'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3, 5.4],
    '카페_수': [25000, 32000, 18000, 12000, 22000, 15000],
})

# 대륙별 평균 연간 소비량
print("대륙별 평균 연간 소비량:")
print(df.groupby('대륙')['연간_소비량'].mean())

# 대륙별 카페 수 합계
print("\\n대륙별 카페 수 합계:")
print(df.groupby('대륙')['카페_수'].sum())

# 여러 열에 대한 다양한 연산
print("\\n대륙별 다양한 통계:")
print(df.groupby('대륙').agg({
    '연간_소비량': ['mean', 'max'],
    '카페_수': ['sum', 'median']
}))

```


:::div{.callout}

**Tip !**

 groupby()로 비슷한 데이터끼리 모아서 계산할 수 있어요.
 :::



pandas의 DataFrame 핵심 개념과 주요 기능을 살펴보았습니다. DataFrame의 기본 구조와 생성 방법, 인덱싱과 데이터 접근 기법, 데이터 조작 및 변환 방법, 기본적인 통계 분석과 그룹 연산에 대해 학습하였습니다.
이러한 기능들은 실제 데이터 분석 과정에서 필수적으로 활용되는 도구입니다. pandas DataFrame은 데이터 과학과 분석 분야에서 광범위하게 사용되는 강력한 도구이며, 이를 숙달함으로써 효과적인 데이터 처리와 인사이트 도출이 가능해집니다.