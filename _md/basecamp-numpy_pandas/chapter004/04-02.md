---
chapter: Pandas :네 번째 걸음
title: Pandas Series
date: 2024-07-12
---
# 1. Series 객체

Pandas의 Series는 `1차원 레이블된 배열 구조`입니다. 이는 데이터 분석에서 `단일 열 또는 단일 행의 데이터`를 다룰 때 주로 사용됩니다. Series는 `동일한 데이터 타입`을 가진 요소들의 순서가 있는 집합으로, 각 요소에는 `고유한 레이블(인덱스)`이 부여됩니다. Series의 주요 특징으로는 `크기 변경이 불가능`하다는 점과 `인덱스를 통해 데이터에 빠르게 접근`할 수 있다는 점이 있습니다. 또한, `NumPy 배열과 유사`하지만 인덱스 레이블을 가진다는 점에서 차이가 있습니다.

# 2. Series 생성

```python

import pandas as pd
import numpy as np

# 리스트로부터 Series 생성
s1 = pd.Series([1, 3, 5, 7, 9])
print("리스트로 생성한 Series:")
print(s1)

# NumPy 배열로부터 Series 생성
s2 = pd.Series(np.array([2, 4, 6, 8, 10]))
print("\\nNumPy 배열로 생성한 Series:")
print(s2)

# 사용자 정의 인덱스로 Series 생성
s3 = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])
print("\\n사용자 정의 인덱스를 가진 Series:")
print(s3)

# 딕셔너리로부터 Series 생성
d = {'a': 1, 'b': 3, 'c': 5, 'd': 7, 'e': 9}
s4 = pd.Series(d)
print("\\n딕셔너리로 생성한 Series:")
print(s4)

```

이 코드에서는 네 가지 방법으로 Series를 생성합니다:

1. **리스트를 사용하여 Series 생성**: 기본 인덱스(0부터 시작하는 정수)를 가진 Series를 생성합니다.
    - `s1 = pd.Series([1, 3, 5, 7, 9])` 는 리스트 `[1, 3, 5, 7, 9]`를 Series로 변환합니다.
2. **NumPy 배열을 사용하여 Series 생성**: NumPy 배열로부터 Series를 생성하며, 기본 인덱스를 사용합니다.
    - `s2 = pd.Series(np.array([2, 4, 6, 8, 10]))` 는 NumPy 배열 `[2, 4, 6, 8, 10]`를 Series로 변환합니다.
3. **사용자 정의 인덱스로 Series 생성**: 리스트와 함께 사용자 정의 인덱스를 지정하여 Series를 생성합니다.
    - `s3 = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])` 는 리스트 `[1, 3, 5, 7, 9]`를 인덱스 `['a', 'b', 'c', 'd', 'e']`와 함께 Series로 변환합니다.
4. **딕셔너리를 사용하여 Series 생성**: 딕셔너리를 사용하여 Series를 생성하며, 이 경우 딕셔너리의 키가 인덱스가 됩니다.
    - `s4 = pd.Series({'a': 1, 'b': 3, 'c': 5, 'd': 7, 'e': 9})` 는 딕셔너리 `{'a': 1, 'b': 3, 'c': 5, 'd': 7, 'e': 9}`를 Series로 변환합니다.


**`Tip !`:** 리스트나 딕셔너리를 Series로 변환할 때, Pandas는 자동으로 인덱스를 생성합니다. 사용자 정의 인덱스를 사용하면 데이터를 더 쉽게 식별하고 다룰 수 있습니다.

# 3. 인덱스와 값 접근

## 3.1 인덱스와 값 반환

- `s.index`: Series의 인덱스를 반환합니다.
- `s.values`: Series의 값들을 NumPy 배열로 반환합니다.

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])
print("인덱스:", s.index)
print("값:", s.values)

```



**`tip !`:** `s.index`는 Series의 각 요소를 식별하는 레이블을, `s.values`는 실제 데이터를 반환합니다.

## 3.2 요소 접근

- `s.iloc[]`: 정수 위치 기반 인덱싱. 예를 들어, `s.iloc[1]`은 Series의 두 번째 요소를 반환합니다.
- `s.loc[]`: 라벨 기반 인덱싱. 예를 들어, `s.loc['c']`는 인덱스가 'c'인 요소를 반환합니다.

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])
print("두 번째 요소 (iloc):", s.iloc[1])
print("인덱스 'c'의 값 (loc):", s.loc['c'])

```



**`tip !` :** `iloc`는 숫자 위치를 사용하여 요소를 선택하고, `loc`는 인덱스 레이블을 사용하여 요소를 선택합니다.

## 3.3 Slicing

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])
print("슬라이싱 (a부터 c까지):\\n", s['a':'c'])

```



**`tip !` :** 슬라이싱을 사용하면 특정 범위의 데이터를 추출할 수 있습니다. 끝 인덱스를 포함한다는 점을 기억하세요.

## 3.4 Boolean Indexing

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])
print("5보다 큰 값:\\n", s[s > 5])

```


**`tip !` :** Boolean 인덱싱은 조건에 맞는 데이터만 선택할 때 유용합니다. 조건식을 사용하여 원하는 데이터를 쉽게 필터링할 수 있습니다.

## 3.5 Fancy Indexing (at, iat)

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])
print("at을 사용한 값 접근:", s.at['c'])
print("iat을 사용한 값 접근:", s.iat[2])

```


**`tip !` :** `at`과 `iat`는 각각 라벨과 정수 위치 기반의 단일 요소 접근에 최적화되어 있습니다.

## 3.5 Fancy Indexing (get)

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])
print("get을 사용한 값 접근:", s.get('c'))

```


**`tip !`:** `get` 메서드는 존재하지 않는 키를 요청할 때 기본 값을 반환할 수 있어 안전하게 값을 접근할 수 있습니다.

# 4. Series 정보 및 속성

## 4.1 데이터타입

- `s.dtype`: Series의 데이터 타입을 반환합니다.
- `s.shape`: Series의 형태(길이)를 반환합니다.
- `s.size`: Series의 요소 개수를 반환합니다.

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])

print("데이터 타입:", s.dtype)
print("Series 형태:", s.shape)
print("요소 개수:", s.size)

```


**`tip !` :** `dtype`는 데이터 타입, `shape`는 데이터의 모양 (길이), `size`는 총 요소 수를 알려줍니다.

## 4.2 Keys

- `s.keys()`: Series의 인덱스를 반환합니다.

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])
print("Series의 인덱스 (keys):", s.keys())

```


**`tip !` :** `keys()` 메서드는 인덱스를 반환합니다. `s.keys()`는 `s.index`와 동일합니다.

## 4.3 Items

`s.items()`: Series의 인덱스와 값 쌍을 반환합니다.

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', '

d', 'e'])
for index, value in s.items():
    print(f"인덱스: {index}, 값: {value}")

```


**`tip !` :** `items()` 메서드는 인덱스와 값을 튜플 형태로 반환합니다. 루프를 통해 각 요소에 쉽게 접근할 수 있습니다.

# 5. Series 연산 및 통계

## 5.1 기본 통계

- `s.mean()`: Series의 평균을 계산합니다.
- `s.median()`: Series의 중앙값을 계산합니다.
- `s.min()`: Series의 최소값을 반환합니다.
- `s.max()`: Series의 최대값을 반환합니다.

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])

print("평균:", s.mean())
print("중앙값:", s.median())
print("최소값:", s.min())
print("최대값:", s.max())

```


## 5.2 집계 함수

```python
import pandas as pd

s = pd.Series([1, 2, 3, 4, 5])
print("합계:", s.sum())
print("중앙값:", s.median())
print("표준편차:", s.std())

```

## 5.3 연산 함수

```python
import pandas as pd
import numpy as np

s = pd.Series([1, 2, np.nan, 4, 5])
print("결측치가 있는 Series의 평균:", s.mean())
print("결측치를 제외한 평균:", s.mean(skipna=True))
```


**`tip !` :** `mean()` 함수는 기본적으로 결측치를 제외하고 계산합니다. `skipna=False`로 설정하면 결측치가 있을 경우 결과도 NaN이 됩니다.

## 5.4 Series 간 산술 연산

```python
import pandas as pd

s1 = pd.Series([1, 2, 3], index=['a', 'b', 'c'])
s2 = pd.Series([4, 5, 6], index=['a', 'b', 'c'])

print("Series 덧셈:\\n", s1 + s2)
print("Series 뺄셈:\\n", s1 - s2)
print("Series 곱셈:\\n", s1 * s2)
print("Series 나눗셈:\\n", s1 / s2)

```


**`tip !` :** Series 간의 연산은 인덱스가 같은 요소끼리 수행됩니다. 인덱스가 다르면 NaN이 결과로 나타날 수 있습니다.

# 6. 결측치 처리

## 6.1 결측치 확인, 제거, 채우기

- `s.isnull()`: 각 요소가 결측치인지 확인합니다. 결측치인 경우 `True`, 아닌 경우 `False`를 반환합니다.
- `s.dropna()`: 결측치를 제거한 새로운 Series를 반환합니다.
- `s.fillna()`: 결측치를 지정된 값으로 채운 새로운 Series를 반환합니다.

```python
import pandas as pd
import numpy as np

s_with_na = pd.Series([1, 3, np.nan, 7, 9])
print("결측치 여부:\\n", s_with_na.isnull())
print("결측치 제거:\\n", s_with_na.dropna())
print("결측치 0으로 채우기:\\n", s_with_na.fillna(0))

```


**`tip !` :** 데이터 분석을 할 때 결측치를 처리하는 것은 매우 중요합니다. `isnull`로 결측치를 확인하고, `dropna`로 결측치를 제거하거나 `fillna`로 특정 값으로 대체할 수 있습니다.

## 6.2 NaN

NaN(Not a Number)은 데이터셋에서 결측치를 나타내는 대표적인 값이며, Python의 None 값도 Pandas에서는 결측치로 처리됩니다.\

```python
import pandas as pd
import numpy as np

s_with_nan = pd.Series([1, 2, np.nan, 4, 5])
print("NaN이 포함된 Series:")
print(s_with_nan)
print("isnull() 결과:")
print(s_with_nan.isnull())
```

`tip !`   주로 수치형 데이터에서 결측치를 나타내기 위해 사용됩니다. NumPy의 `np.nan`으로 생성할 수 있습니다.

## 6.3 None

Python의 None 값도 Pandas에서는 결측치로 처리됩니다. 이는 NaN(Not a Number)과 함께 데이터 분석에서 중요한 개념입니다.

```python
import pandas as pd

s = pd.Series([1, 2, None, 4, 5])
print("None이 포함된 Series:")
print(s)
print("isnull() 결과:")
print(s.isnull())

```


**`tip !` :** Python의 내장 값으로, 주로 객체형 데이터에서 결측치를 나타내기 위해 사용됩니다. Pandas는 None을 자동으로 NaN으로 변환하여 처리합니다.

# 7. 데이터 변환 및 조작

## 7.1 Series 정렬

- `s.sort_values()`: 값을 기준으로 정렬한 새로운 Series를 반환합니다.
- `s.sort_index()`: 인덱스를 기준으로 정렬한 새로운 Series를 반환합니다.

```python
import pandas as pd
import numpy as np

s_random = pd.Series(np.random.randn(5), index=['b', 'a', 'c', 'e', 'd'])
print("값 기준 정렬:\\n", s_random.sort_values())
print("인덱스 기준 정렬:\\n", s_random.sort_index())

```


**`tip !` :** `sort_values`는 값을 기준으로, `sort_index`는 인덱스를 기준으로 Series를 정렬합니다. 데이터의 순서를 재배열할 때 유용합니다.

## 7.2 함수 적용

Series의 각 요소에 함수를 적용하거나 값을 매핑하는 방법을 설명합니다.

- `s.apply()`: 각 요소에 함수를 적용한 새로운 Series를 반환합니다.
- `s.map()`: 각 요소를 다른 값으로 매핑한 새로운 Series를 반환합니다.

```python
import pandas as pd

s = pd.Series([1, 3, 5, 7, 9], index=['a', 'b', 'c', 'd', 'e'])

print("제곱 적용:\\n", s.apply(lambda x: x**2))
mapping = {'a': 'A', 'b': 'B', 'c': 'C', 'd': 'D', 'e': 'E'}
print("값 매핑:\\n", s.map(mapping))

```

**`tip !` :** `apply`를 사용하면 함수로 각 요소를 변환할 수 있고, `map`을 사용하면 각 요소를 다른 값으로 바꿀 수 있습니다. 데이터 변환과 매핑 작업에 유용합니다.

# 8. 고급 기능

## 8.1 MultiIndex 

다중 인덱스(MultiIndex)는 계층적 데이터를 표현하는 강력한 도구입니다.

```python
import pandas as pd

multi_index = pd.MultiIndex.from_tuples([('A', 1), ('A', 2), ('B', 1), ('B', 2)], names=['letter', 'number'])
s = pd.Series([1, 2, 3, 4], index=multi_index)
print("다중 인덱스 Series:")
print(s)

```


**`tip !` :** `MultiIndex.from_tuples`는 튜플 리스트로부터 다중 인덱스를 생성합니다. 'names' 매개변수는 각 레벨의 이름을 지정합니다.

## 8.2 데이터 결합 


```python
import pandas as pd

s1 = pd.Series([1, 2, 3], index=['a', 'b', 'c'])
s2 = pd.Series([4, 5, 6], index=['d', 'e', 'f'])
s_combined = pd.concat([s1, s2])
print("결합된 Series:")
print(s_combined)

s3 = pd.Series([7, 8, 9], index=['a', 'c', 'e'])
s_merged = pd.concat([s1, s3], axis=1)
print("\\n열 방향으로 결합된 Series:")
print(s_merged)

```


**`tip !` :** `pd.concat()`은 Series나 DataFrame을 결합하는 강력한 함수입니다. `axis=0`(기본값)은 행 방향, `axis=1`은 열 방향 결합을 수행합니다.

이번 장에서는 Pandas의 Series 객체에 대해 학습했습니다. Series의 기본 개념, 생성 방법, 데이터 접근 및 조작, 기본 통계 계산, 결측치 처리, 정렬, 그리고 데이터 변환 등 주요 기능을 살펴보았습니다. 이러한 Series의 다양한 기능들은 데이터 분석 작업을 효율적으로 수행하는 데 큰 도움이 됩니다.