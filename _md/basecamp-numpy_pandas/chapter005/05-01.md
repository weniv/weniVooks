---
chapter: Pandas :다섯 번째 걸음
title:  데이터 분석 기법
date: 2024-07-17
---
# 1. 데이터 분석 기법
## 1.1. 기본 통계량 계산
pandas는 데이터프레임의 기본 통계량을 쉽게 계산할 수 있는 메서드를 제공합니다.

```python-exec
import pandas as pd
import numpy as np

df = pd.DataFrame({
    '국가': ['브라질', '미국', '이탈리아', '한국', '일본'],
    '연간_소비량': [5.1, 4.2, 5.9, 2.8, 3.3],
    '카페_수': [25000, 32000, 18000, 12000, 22000]
})

# describe() 메서드를 사용한 종합적인 통계량 계산
print("기본 통계량:")
print(df.describe())

# 개별 통계량 계산
print("\n개별 통계량:")
print("평균 연간 소비량:", df['연간_소비량'].mean())
print("연간 소비량 중앙값:", df['연간_소비량'].median())
print("연간 소비량 표준편차:", df['연간_소비량'].std())
print("카페 수 최대값:", df['카페_수'].max())
print("카페 수 최소값:", df['카페_수'].min())

# 특정 백분위수 계산
print("\n75번째 백분위수:")
print(df.quantile(0.75))

# 상관관계 계산
print("\n상관관계:")
print(df.corr())
```

## 1.2. 그룹화 연산 (groupby)

groupby 연산은 데이터를 특정 기준에 따라 그룹화하고, 각 그룹에 대해 집계 연산을 수행할 수 있게 해줍니다.

```python-exec
import pandas as pd

df = pd.DataFrame({
    '대륙': ['아시아', '유럽', '아시아', '북미', '유럽', '아시아', '북미', '유럽'],
    '국가': ['한국', '이탈리아', '일본', '미국', '프랑스', '중국', '캐나다', '독일'],
    '연간_소비량': [2.8, 5.9, 3.3, 4.2, 5.4, 3.0, 4.5, 5.8],
    '카페_수': [12000, 18000, 22000, 32000, 15000, 25000, 20000, 16000]
})

# 단일 열 기준 그룹화
print("대륙별 평균 연간 소비량:")
print(df.groupby('대륙')['연간_소비량'].mean())

# 다중 열 기준 그룹화
print("대륙별, 국가별 평균 연간 소비량:")
print(df.groupby(['대륙', '국가'])['연간_소비량'].mean())

# 여러 열에 대한 다양한 집계 함수 적용
print("대륙별 다양한 통계량:")
print(df.groupby('대륙').agg({
    '연간_소비량': ['mean', 'max'],
    '카페_수': ['sum', 'min']
}))

# 그룹 내 순위 계산
df['소비량_순위'] = df.groupby('대륙')['연간_소비량'].rank(ascending=False)
print("\n대륙 내 연간 소비량 순위:")
print(df)
```

## 1.3. 데이터 집계 및 변환 (aggregate, transform)

aggregate 함수는 그룹화된 데이터에 대해 다양한 집계 연산을 수행할 수 있게 해줍니다. 여러 열에 대해 서로 다른 집계 함수를 동시에 적용할 수 있어 유연성이 높습니다.

```python-exec
import pandas as pd
import numpy as np

df = pd.DataFrame({
    '대륙': ['아시아', '유럽', '아시아', '북미', '유럽', '아시아', '북미', '유럽'],
    '국가': ['한국', '이탈리아', '일본', '미국', '프랑스', '중국', '캐나다', '독일'],
    '연간_소비량': [2.8, 5.9, 3.3, 4.2, 5.4, 3.0, 4.5, 5.8],
    '카페_수': [12000, 18000, 22000, 32000, 15000, 25000, 20000, 16000]
})

# 기본 aggregate 사용
print("대륙별 평균 연간 소비량:")
print(df.groupby('대륙')['연간_소비량'].agg('mean'))

# 여러 함수를 동시에 적용
print("대륙별 연간 소비량 통계:")
print(df.groupby('대륙')['연간_소비량'].agg(['mean', 'median', 'std']))

# 여러 열에 대해 서로 다른 함수 적용
print("대륙별 다양한 통계:")
print(df.groupby('대륙').agg({
    '연간_소비량': ['mean', 'max'],
    '카페_수': ['sum', 'min']
}))

# 사용자 정의 함수 사용
def range_diff(x):
    return x.max() - x.min()

print("대륙별 연간 소비량 범위:")
print(df.groupby('대륙')['연간_소비량'].agg(range_diff))
```

transform추가 해야돼. 정의 더 넣고 